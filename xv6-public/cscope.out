cscope 15 $HOME/os2020/2020_ELE3021_2016024811/xv6-public               0000285988
	@asm.h

5 
	#SEG_NULLASM
 \

6 .
w‹d
 0, 0; \

7 .
byã
 0, 0, 0, 0

	)

11 
	#SEG_ASM
(
ty≥
,
ba£
,
lim
) \

12 .
	`w‹d
 (((
lim
Ë>> 12Ë& 0xffff), ((
ba£
) & 0xffff); \

13 .
	`byã
 (((
ba£
Ë>> 16Ë& 0xff), (0x90 | (
ty≥
)), \

14 (0xC0 | (((
lim
Ë>> 28Ë& 0xf)), (((
ba£
Ë>> 24Ë& 0xff)

	)

16 
	#STA_X
 0x8

17 
	#STA_W
 0x2

18 
	#STA_R
 0x2

	@bio.c

21 
	~"ty≥s.h
"

22 
	~"defs.h
"

23 
	~"∑øm.h
"

24 
	~"•ölock.h
"

25 
	~"¶ì∂ock.h
"

26 
	~"fs.h
"

27 
	~"buf.h
"

30 
•ölock
 
	mlock
;

31 
buf
 
	mbuf
[
NBUF
];

35 
buf
 
	mhód
;

36 } 
	gbˇche
;

39 
	$böô
()

41 
buf
 *
b
;

43 
	`öôlock
(&
bˇche
.
lock
, "bcache");

47 
bˇche
.
hód
.
¥ev
 = &bcache.head;

48 
bˇche
.
hód
.
√xt
 = &bcache.head;

49 
b
 = 
bˇche
.
buf
; b < bˇche.buf+
NBUF
; b++){

50 
b
->
√xt
 = 
bˇche
.
hód
.next;

51 
b
->
¥ev
 = &
bˇche
.
hód
;

52 
	`öô¶ì∂ock
(&
b
->
lock
, "buffer");

53 
bˇche
.
hód
.
√xt
->
¥ev
 = 
b
;

54 
bˇche
.
hód
.
√xt
 = 
b
;

56 
	}
}

61 
buf
*

62 
	$bgë
(
uöt
 
dev
, uöà
blockno
)

64 
buf
 *
b
;

66 
	`acquúe
(&
bˇche
.
lock
);

69 
b
 = 
bˇche
.
hód
.
√xt
; b != &bcache.head; b = b->next){

70 if(
b
->
dev
 =dev && b->
blockno
 == blockno){

71 
b
->
ªf˙t
++;

72 
	`ªÀa£
(&
bˇche
.
lock
);

73 
	`acquúe¶ìp
(&
b
->
lock
);

74  
b
;

81 
b
 = 
bˇche
.
hód
.
¥ev
; b != &bcache.head; b = b->prev){

82 if(
b
->
ªf˙t
 =0 && (b->
Êags
 & 
B_DIRTY
) == 0) {

83 
b
->
dev
 = dev;

84 
b
->
blockno
 = blockno;

85 
b
->
Êags
 = 0;

86 
b
->
ªf˙t
 = 1;

87 
	`ªÀa£
(&
bˇche
.
lock
);

88 
	`acquúe¶ìp
(&
b
->
lock
);

89  
b
;

92 
	`∑nic
("bget:Ço buffers");

93 
	}
}

96 
buf
*

97 
	$bªad
(
uöt
 
dev
, uöà
blockno
)

99 
buf
 *
b
;

101 
b
 = 
	`bgë
(
dev
, 
blockno
);

102 if((
b
->
Êags
 & 
B_VALID
) == 0) {

103 
	`idîw
(
b
);

105  
b
;

106 
	}
}

110 
	$bwrôe
(
buf
 *
b
)

112 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

113 
	`∑nic
("bwrite");

114 
b
->
Êags
 |
B_DIRTY
;

115 
	`idîw
(
b
);

116 
	}
}

121 
	$bªl£
(
buf
 *
b
)

123 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

124 
	`∑nic
("brelse");

126 
	`ªÀa£¶ìp
(&
b
->
lock
);

128 
	`acquúe
(&
bˇche
.
lock
);

129 
b
->
ªf˙t
--;

130 i‡(
b
->
ªf˙t
 == 0) {

132 
b
->
√xt
->
¥ev
 = b->prev;

133 
b
->
¥ev
->
√xt
 = b->next;

134 
b
->
√xt
 = 
bˇche
.
hód
.next;

135 
b
->
¥ev
 = &
bˇche
.
hód
;

136 
bˇche
.
hód
.
√xt
->
¥ev
 = 
b
;

137 
bˇche
.
hód
.
√xt
 = 
b
;

140 
	`ªÀa£
(&
bˇche
.
lock
);

141 
	}
}

	@bootasm.S

1 
	~"asm.h
"

2 
	~"memœyout.h
"

3 
	~"mmu.h
"

5 #Sèπ 
the
 
fú°
 
CPU
: 
to
 32-
bô
 
¥Ÿe˘ed
 
mode
, 
jump
 
öto
 
C
.

6 #Thê
BIOS
 
lﬂds
 
this
 
code
 
‰om
 
the
 
fú°
 
£˘‹
 
of
Åhê
h¨d
 
disk
 
öto


7 #mem‹y 
©
 
physiˇl
 
addªss
 0x7c00 
™d
 
°¨ts
 
executög
 
ö
 
ªÆ
 
mode


8 #wôh %
cs
=0 %
ù
=7c00.

10 .
	gcode16
 #As£mbÀ 16-
bô
 
	gmode


11 .
globl
 
°¨t


12 
	g°¨t
:

13 
˛i
 #BIOS 
íabÀd
 
öãºu±s
; 
	gdißbÀ


15 #Zîÿ
d©a
 
£gmít
 
ªgi°îs
 
DS
, 
ES
, 
™d
 
SS
.

16 
	gx‹w
 %
	gax
,%ax #Së %
ax
 
to
 
zîo


17 
	gmovw
 %
	gax
,%
	gds
 #-> 
D©a
 
Segmít


18 
	gmovw
 %
	gax
,%
	ges
 #-> 
Exåa
 
Segmít


19 
	gmovw
 %
	gax
,%
	gss
 #-> 
Sèck
 
	gSegmít


21 #Physiˇ»
addªss
 
löe
 
A20
 
is
 
tõd
 
to
 
zîo
 
so
 
th©
 
the
 
fú°
 
PCs


22 #wôh 2 
MB
 
would
 
run
 
so·w¨e
 
th©
 
assumed
 1 MB. 
Undo
Åhat.

23 
	g£è20
.1:

24 
öb
 
$0x64
,%
	gÆ
 #Waô 
nŸ
 
busy


25 
ã°b
 
	g$0x2
,%
Æ


26 
jnz
 
	g£è20
.1

28 
movb
 
	g$0xd1
,%
	gÆ
 #0
	gxd1
 -> 
	gp‹t
 0x64

29 
	goutb
 %
	gÆ
,
$0x64


31 
	g£è20
.2:

32 
öb
 
$0x64
,%
	gÆ
 #Waô 
nŸ
 
busy


33 
ã°b
 
	g$0x2
,%
Æ


34 
jnz
 
	g£è20
.2

36 
movb
 
	g$0xdf
,%
	gÆ
 #0
	gxdf
 -> 
	gp‹t
 0x60

37 
	goutb
 %
	gÆ
,
	g$0x60


39 #Swôch 
‰om
 
ªÆ
 
to
 
¥Ÿe˘ed
 
mode
. 
U£
 
a
 
boŸ°øp
 
GDT
 
th©
 
makes


40 #vútuÆ 
addªs£s
 
m≠
 
dúe˘ly
 
to
 
physiˇl
áddªs£†
so
 
th©
 
the


41 #ef„˘ivê
mem‹y
 
m≠
 
d€¢
't change duringÅheÅransition.

42 
lgdt
 
gdtdesc


43 
	gmovl
 %
	g¸0
, %
óx


44 
‹l
 
	g$CR0_PE
, %
óx


45 
	gmovl
 %
	góx
, %
	g¸0


48 #Com∂ëê
the
 
å™sôi⁄
 
to
 32-
bô
 
¥Ÿe˘ed
 
mode
 
by
 
usög
 
a
 
jmp


49 #tÿ
ªlﬂd
 %
cs
 
™d
 %
eù
. 
The
 
£gmít
 
des¸ùt‹s
 
¨e
 
£t
 
up
 
wôh
 
no


50 #å™¶©i⁄, 
so
 
th©
 
the
 
m≠pög
 
is
 
°ûl
Åhê
idítôy
 mapping.

51 
ljmp
 
$
(
SEG_KCODE
<<3), 
	g$°¨t32


53 .
	gcode32
 #Tñ»
as£mbÀr
 
to
 
	ggíî©e
 32-
bô
 
code
 
	gnow
.

54 
	g°¨t32
:

55 #Së 
up
 
the
 
¥Ÿe˘ed
-
mode
 
d©a
 
£gmít
 
ªgi°îs


56 
movw
 
$
(
SEG_KDATA
<<3), %
	gax
 #Ou∏
d©a
 
£gmít
 
£À˘‹


57 
	gmovw
 %
	gax
, %
	gds
 #-> 
	gDS
: 
D©a
 
Segmít


58 
movw
 %
ax
, %
	ges
 #-> 
	gES
: 
Exåa
 
Segmít


59 
movw
 %
ax
, %
	gss
 #-> 
	gSS
: 
Sèck
 
Segmít


60 
movw
 
$0
, %
	gax
 #Zîÿ
£gmíts
 
nŸ
 
ªady
 
u£


61 
	gmovw
 %
	gax
, %
	gfs
 #-> 
FS


62 
	gmovw
 %
	gax
, %
	ggs
 #-> 
	gGS


64 #Së 
up
 
the
 
°ack
 
poöãr
 
™d
 
ˇŒ
 
öto
 
C
.

65 
movl
 
	g$°¨t
, %
e•


66 
ˇŒ
 
	gboŸmaö


68 #I‡
boŸmaö
 
ªtu∫s
 (
ô
 
shouldn
't),Åriggerá Bochs

69 #bªakpoöà
ru¬ög
 
undî
 
Bochs
, 
thí
 
lo›
.

70 
movw
 
$0x8a00
, %
ax
 #0
x8a00
 -> 
p‹t
 0x8a00

71 
movw
 %
ax
, %
dx


72 
outw
 %
ax
, %
dx


73 
movw
 
$0x8´0
, %
ax
 #0
x8´0
 -> 
p‹t
 0x8a00

74 
outw
 %
ax
, %
dx


75 
•ö
:

76 
jmp
 
•ö


78 #BoŸ°ø∞
GDT


79 .
p2Æign
 2 #f‹˚ 4 
byã
 
Æignmít


80 
gdt
:

81 
SEG_NULLASM
 #nuŒ 
£g


82 
SEG_ASM
(
STA_X
|
STA_R
, 0x0, 0xffffffffË#codê
£g


83 
	$SEG_ASM
(
STA_W
, 0x0, 0xffffffffË#d©®
£g


85 
gdtdesc
:

86 .
	`w‹d
 (
gdtdesc
 - 
gdt
 - 1) #sizeof(gdt) - 1

87 .
gdt
 #address gdt

	@bootmain.c

8 
	~"ty≥s.h
"

9 
	~"ñf.h
"

10 
	~"x86.h
"

11 
	~"memœyout.h
"

13 
	#SECTSIZE
 512

	)

15 
ªad£g
(
uch¨
*, 
uöt
, uint);

18 
	$boŸmaö
()

20 
ñfhdr
 *
ñf
;

21 
¥oghdr
 *
ph
, *
ïh
;

22 (*
íåy
)();

23 
uch¨
* 
∑
;

25 
ñf
 = (
ñfhdr
*)0x10000;

28 
	`ªad£g
((
uch¨
*)
ñf
, 4096, 0);

31 if(
ñf
->
magic
 !
ELF_MAGIC
)

36 
ph
 = (
¥oghdr
*)((
uch¨
*)
ñf
 +Élf->
phoff
);

39 
ïh
 = 
ph
 + 
ñf
->
phnum
;

49 ; 
ph
 < 
ïh
;Öh++){

52 
∑
 = (
uch¨
*)
ph
->
∑ddr
;

53 
	`ªad£g
(
∑
, 
ph
->
fûesz
,Öh->
off
);

54 if(
ph
->
memsz
 >Öh->
fûesz
)

57 
	`°osb
(
∑
 + 
ph
->
fûesz
, 0,Öh->
memsz
 -Öh->filesz);

63 
íåy
 = ((*)())(
ñf
->entry);

66 
	`íåy
();

67 
	}
}

70 
	$waôdisk
()

73 (
	`öb
(0x1F7) & 0xC0) != 0x40)

75 
	}
}

79 
	$ªad£˘
(*
d°
, 
uöt
 
off£t
)

87 
	`waôdisk
();

95 
	`outb
(0x1F2, 1);

98 
	`outb
(0x1F3, 
off£t
);

99 
	`outb
(0x1F4, 
off£t
 >> 8);

100 
	`outb
(0x1F5, 
off£t
 >> 16);

101 
	`outb
(0x1F6, (
off£t
 >> 24) | 0xE0);

104 
	`outb
(0x1F7, 0x20);

108 
	`waôdisk
();

113 
	`ö¶
(0x1F0, 
d°
, 
SECTSIZE
/4);

114 
	}
}

120 
	$ªad£g
(
uch¨
* 
∑
, 
uöt
 
cou¡
, uöà
off£t
)

123 
uch¨
* 
ïa
;

125 
ïa
 = 
∑
 + 
cou¡
;

128 
∑
 -
off£t
 % 
SECTSIZE
;

131 
off£t
 = (off£à/ 
SECTSIZE
) + 1;

136 ; 
∑
 < 
ïa
;Ö®+
SECTSIZE
, 
off£t
++)

137 
	`ªad£˘
(
∑
, 
off£t
);

138 
	}
}

	@buf.h

1 
	sbuf
 {

2 
	mÊags
;

3 
uöt
 
	mdev
;

4 
uöt
 
	mblockno
;

5 
¶ì∂ock
 
	mlock
;

6 
uöt
 
	mªf˙t
;

7 
buf
 *
	m¥ev
;

8 
buf
 *
	m√xt
;

9 
buf
 *
	mq√xt
;

10 
uch¨
 
	md©a
[
BSIZE
];

12 
	#B_VALID
 0x2

13 
	#B_DIRTY
 0x4

14 

	)

	@cat.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

5 
	gbuf
[512];

8 
	$ˇt
(
fd
)

10 
n
;

12 (
n
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0) {

13 i‡(
	`wrôe
(1, 
buf
, 
n
) !=Ç) {

14 
	`¥ötf
(1, "cat: writeÉrror\n");

15 
	`exô
();

18 if(
n
 < 0){

19 
	`¥ötf
(1, "cat:ÑeadÉrror\n");

20 
	`exô
();

22 
	}
}

25 
	$maö
(
¨gc
, *
¨gv
[])

27 
fd
, 
i
;

29 if(
¨gc
 <= 1){

30 
	`ˇt
(0);

31 
	`exô
();

34 
i
 = 1; i < 
¨gc
; i++){

35 if((
fd
 = 
	`›í
(
¨gv
[
i
], 0)) < 0){

36 
	`¥ötf
(1, "ˇt: c™nŸ o≥¿%s\n", 
¨gv
[
i
]);

37 
	`exô
();

39 
	`ˇt
(
fd
);

40 
	`˛o£
(
fd
);

42 
	`exô
();

43 
	}
}

	@console.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"å≠s.h
"

9 
	~"•ölock.h
"

10 
	~"¶ì∂ock.h
"

11 
	~"fs.h
"

12 
	~"fûe.h
"

13 
	~"memœyout.h
"

14 
	~"mmu.h
"

15 
	~"¥oc.h
"

16 
	~"x86.h
"

18 
c⁄•utc
();

20 
	g∑nicked
 = 0;

23 
•ölock
 
	mlock
;

24 
	mlockög
;

25 } 
	gc⁄s
;

28 
	$¥ötöt
(
xx
, 
ba£
, 
sign
)

30 
digôs
[] = "0123456789abcdef";

31 
buf
[16];

32 
i
;

33 
uöt
 
x
;

35 if(
sign
 && (sig¿
xx
 < 0))

36 
x
 = -
xx
;

38 
x
 = 
xx
;

40 
i
 = 0;

42 
buf
[
i
++] = 
digôs
[
x
 % 
ba£
];

43 }(
x
 /
ba£
) != 0);

45 if(
sign
)

46 
buf
[
i
++] = '-';

48 --
i
 >= 0)

49 
	`c⁄•utc
(
buf
[
i
]);

50 
	}
}

55 
	$˝rötf
(*
fmt
, ...)

57 
i
, 
c
, 
lockög
;

58 
uöt
 *
¨gp
;

59 *
s
;

61 
lockög
 = 
c⁄s
.locking;

62 if(
lockög
)

63 
	`acquúe
(&
c⁄s
.
lock
);

65 i‡(
fmt
 == 0)

66 
	`∑nic
("null fmt");

68 
¨gp
 = (
uöt
*)(*)(&
fmt
 + 1);

69 
i
 = 0; (
c
 = 
fmt
[i] & 0xff) != 0; i++){

70 if(
c
 != '%'){

71 
	`c⁄•utc
(
c
);

74 
c
 = 
fmt
[++
i
] & 0xff;

75 if(
c
 == 0)

77 
c
){

79 
	`¥ötöt
(*
¨gp
++, 10, 1);

83 
	`¥ötöt
(*
¨gp
++, 16, 0);

86 if((
s
 = (*)*
¨gp
++) == 0)

87 
s
 = "(null)";

88 ; *
s
; s++)

89 
	`c⁄•utc
(*
s
);

92 
	`c⁄•utc
('%');

96 
	`c⁄•utc
('%');

97 
	`c⁄•utc
(
c
);

102 if(
lockög
)

103 
	`ªÀa£
(&
c⁄s
.
lock
);

104 
	}
}

107 
	$∑nic
(*
s
)

109 
i
;

110 
uöt
 
pcs
[10];

112 
	`˛i
();

113 
c⁄s
.
lockög
 = 0;

115 
	`˝rötf
("œpicid %d:Ö™ic: ", 
	`œpicid
());

116 
	`˝rötf
(
s
);

117 
	`˝rötf
("\n");

118 
	`gëˇŒîpcs
(&
s
, 
pcs
);

119 
i
=0; i<10; i++)

120 
	`˝rötf
(" %p", 
pcs
[
i
]);

121 
∑nicked
 = 1;

124 
	}
}

127 
	#BACKSPACE
 0x100

	)

128 
	#CRTPORT
 0x3d4

	)

129 
ush‹t
 *
	g¸t
 = (ush‹t*)
P2V
(0xb8000);

132 
	$cg≠utc
(
c
)

134 
pos
;

137 
	`outb
(
CRTPORT
, 14);

138 
pos
 = 
	`öb
(
CRTPORT
+1) << 8;

139 
	`outb
(
CRTPORT
, 15);

140 
pos
 |
	`öb
(
CRTPORT
+1);

142 if(
c
 == '\n')

143 
pos
 += 80 -Öos%80;

144 if(
c
 =
BACKSPACE
){

145 if(
pos
 > 0) --pos;

147 
¸t
[
pos
++] = (
c
&0xff) | 0x0700;

149 if(
pos
 < 0 ||Öos > 25*80)

150 
	`∑nic
("pos under/overflow");

152 if((
pos
/80) >= 24){

153 
	`memmove
(
¸t
, crt+80, (crt[0])*23*80);

154 
pos
 -= 80;

155 
	`mem£t
(
¸t
+
pos
, 0, (crt[0])*(24*80 -Öos));

158 
	`outb
(
CRTPORT
, 14);

159 
	`outb
(
CRTPORT
+1, 
pos
>>8);

160 
	`outb
(
CRTPORT
, 15);

161 
	`outb
(
CRTPORT
+1, 
pos
);

162 
¸t
[
pos
] = ' ' | 0x0700;

163 
	}
}

166 
	$c⁄•utc
(
c
)

168 if(
∑nicked
){

169 
	`˛i
();

174 if(
c
 =
BACKSPACE
){

175 
	`u¨çutc
('\b'); uartputc(' '); uartputc('\b');

177 
	`u¨çutc
(
c
);

178 
	`cg≠utc
(
c
);

179 
	}
}

181 
	#INPUT_BUF
 128

	)

183 
	mbuf
[
INPUT_BUF
];

184 
uöt
 
	mr
;

185 
uöt
 
	mw
;

186 
uöt
 
	me
;

187 } 
	göput
;

189 
	#C
(
x
) ((x)-'@')

190 

	)

192 
	$c⁄sﬁeöå
((*
gëc
)())

194 
c
, 
d›rocdump
 = 0;

196 
	`acquúe
(&
c⁄s
.
lock
);

197 (
c
 = 
	`gëc
()) >= 0){

198 
c
){

199 
	`C
('P'):

201 
d›rocdump
 = 1;

203 
	`C
('U'):

204 
öput
.
e
 !öput.
w
 &&

205 
öput
.
buf
[(öput.
e
-1Ë% 
INPUT_BUF
] != '\n'){

206 
öput
.
e
--;

207 
	`c⁄•utc
(
BACKSPACE
);

210 
	`C
('H'): '\x7f':

211 if(
öput
.
e
 !öput.
w
){

212 
öput
.
e
--;

213 
	`c⁄•utc
(
BACKSPACE
);

217 if(
c
 !0 && 
öput
.
e
-öput.
r
 < 
INPUT_BUF
){

218 
c
 = (c == '\r') ? '\n' : c;

219 
öput
.
buf
[öput.
e
++ % 
INPUT_BUF
] = 
c
;

220 
	`c⁄•utc
(
c
);

221 if(
c
 ='\n' || c =
	`C
('D'Ë|| 
öput
.
e
 =öput.
r
+
INPUT_BUF
){

222 
öput
.
w
 = i≈ut.
e
;

223 
	`wakeup
(&
öput
.
r
);

229 
	`ªÀa£
(&
c⁄s
.
lock
);

230 if(
d›rocdump
) {

231 
	`¥ocdump
();

233 
	}
}

236 
	$c⁄sﬁîód
(
öode
 *
ù
, *
d°
, 
n
)

238 
uöt
 
èrgë
;

239 
c
;

241 
	`iu∆ock
(
ù
);

242 
èrgë
 = 
n
;

243 
	`acquúe
(&
c⁄s
.
lock
);

244 
n
 > 0){

245 
öput
.
r
 =öput.
w
){

246 if(
	`my¥oc
()->
kûÀd
){

247 
	`ªÀa£
(&
c⁄s
.
lock
);

248 
	`ûock
(
ù
);

251 
	`¶ìp
(&
öput
.
r
, &
c⁄s
.
lock
);

253 
c
 = 
öput
.
buf
[öput.
r
++ % 
INPUT_BUF
];

254 if(
c
 =
	`C
('D')){

255 if(
n
 < 
èrgë
){

258 
öput
.
r
--;

262 *
d°
++ = 
c
;

263 --
n
;

264 if(
c
 == '\n')

267 
	`ªÀa£
(&
c⁄s
.
lock
);

268 
	`ûock
(
ù
);

270  
èrgë
 - 
n
;

271 
	}
}

274 
	$c⁄sﬁewrôe
(
öode
 *
ù
, *
buf
, 
n
)

276 
i
;

278 
	`iu∆ock
(
ù
);

279 
	`acquúe
(&
c⁄s
.
lock
);

280 
i
 = 0; i < 
n
; i++)

281 
	`c⁄•utc
(
buf
[
i
] & 0xff);

282 
	`ªÀa£
(&
c⁄s
.
lock
);

283 
	`ûock
(
ù
);

285  
n
;

286 
	}
}

289 
	$c⁄sﬁeöô
()

291 
	`öôlock
(&
c⁄s
.
lock
, "console");

293 
devsw
[
CONSOLE
].
wrôe
 = 
c⁄sﬁewrôe
;

294 
devsw
[
CONSOLE
].
ªad
 = 
c⁄sﬁîód
;

295 
c⁄s
.
lockög
 = 1;

297 
	`iﬂpi˚«bÀ
(
IRQ_KBD
, 0);

298 
	}
}

	@date.h

1 
	sπcd©e
 {

2 
uöt
 
	m£c⁄d
;

3 
uöt
 
	mmöuã
;

4 
uöt
 
	mhour
;

5 
uöt
 
	mday
;

6 
uöt
 
	mm⁄th
;

7 
uöt
 
	myór
;

	@defs.h

1 
	gbuf
;

2 
	gc⁄ãxt
;

3 
	gfûe
;

4 
	göode
;

5 
	gpùe
;

6 
	g¥oc
;

7 
	gπcd©e
;

8 
	g•ölock
;

9 
	g¶ì∂ock
;

10 
	g°©
;

11 
	gsu≥rblock
;

14 
thªad_¸óã
(
thªad_t
 *
thªad
, * (*
°¨t_rou¡öe
)(*), *
¨g
);

15 
thªad_exô
(*
ªtvÆ
);

16 
thªad_joö
(
thªad_t
 
thªad
, **
ªtvÆ
);

26 
boo°
 ();

27 
queue_èbÀ_lookup
();

30 
böô
();

31 
buf
* 
bªad
(
uöt
, uint);

32 
bªl£
(
buf
*);

33 
bwrôe
(
buf
*);

36 
c⁄sﬁeöô
();

37 
˝rötf
(*, ...);

38 
c⁄sﬁeöå
((*)());

39 
	$∑nic
(*Ë
	`__©åibuã__
((
n‹ëu∫
));

42 
	`exec
(*, **);

45 
fûe
* 
	`fûóŒoc
();

46 
	`fûe˛o£
(
fûe
*);

47 
fûe
* 
	`fûedup
(file*);

48 
	`fûeöô
();

49 
	`fûîód
(
fûe
*, *, 
n
);

50 
	`fûe°©
(
fûe
*, 
°©
*);

51 
	`fûewrôe
(
fûe
*, *, 
n
);

54 
	`ªadsb
(
dev
, 
su≥rblock
 *
sb
);

55 
	`dúlök
(
öode
*, *, 
uöt
);

56 
öode
* 
	`dúlookup
(öode*, *, 
uöt
*);

57 
öode
* 
	`üŒoc
(
uöt
, );

58 
öode
* 
	`idup
(inode*);

59 
	`iöô
(
dev
);

60 
	`ûock
(
öode
*);

61 
	`ùut
(
öode
*);

62 
	`iu∆ock
(
öode
*);

63 
	`iu∆ockput
(
öode
*);

64 
	`iupd©e
(
öode
*);

65 
	`«mecmp
(const *, const *);

66 
öode
* 
	`«mei
(*);

67 
öode
* 
	`«meù¨ít
(*, *);

68 
	`ªadi
(
öode
*, *, 
uöt
, uint);

69 
	`°©i
(
öode
*, 
°©
*);

70 
	`wrôei
(
öode
*, *, 
uöt
, uint);

73 
	`ideöô
();

74 
	`ideöå
();

75 
	`idîw
(
buf
*);

78 
	`iﬂpi˚«bÀ
(
úq
, 
˝u
);

79 
uch¨
 
iﬂpicid
;

80 
	`iﬂpicöô
();

83 * 
	`kÆloc
();

84 
	`k‰ì
(*);

85 
	`köô1
(*, *);

86 
	`köô2
(*, *);

89 
	`kbdöå
();

92 
	`cmo°ime
(
πcd©e
 *
r
);

93 
	`œpicid
();

94 vﬁ©ûê
uöt
* 
œpic
;

95 
	`œpi˚oi
();

96 
	`œpicöô
();

97 
	`œpic°¨èp
(
uch¨
, 
uöt
);

98 
	`mi¸odñay
();

101 
	`öôlog
(
dev
);

102 
	`log_wrôe
(
buf
*);

103 
	`begö_›
();

104 
	`íd_›
();

107 
ismp
;

108 
	`mpöô
();

111 
	`pi˚«bÀ
();

112 
	`picöô
();

115 
	`pùóŒoc
(
fûe
**, file**);

116 
	`pùe˛o£
(
pùe
*, );

117 
	`pùîód
(
pùe
*, *, );

118 
	`pùewrôe
(
pùe
*, *, );

122 
	`˝uid
();

123 
	`exô
();

124 
	`f‹k
();

125 
	`grow¥oc
();

126 
	`kûl
();

127 
˝u
* 
	`my˝u
();

128 
¥oc
* 
	`my¥oc
();

129 
	`pöô
();

130 
	`¥ocdump
();

131 
	$scheduÀr
(Ë
	`__©åibuã__
((
n‹ëu∫
));

132 
	`sched
();

133 
	`£çroc
(
¥oc
*);

134 
	`¶ìp
(*, 
•ölock
*);

135 
	`u£röô
();

136 
	`waô
();

137 
	`wakeup
(*);

139 
	`yõld
();

140 
	`gëÀv
();

141 
	`£t_˝u_sh¨e
();

144 
	`swtch
(
c⁄ãxt
**, context*);

147 
	`acquúe
(
•ölock
*);

148 
	`gëˇŒîpcs
(*, 
uöt
*);

149 
	`hﬁdög
(
•ölock
*);

150 
	`öôlock
(
•ölock
*, *);

151 
	`ªÀa£
(
•ölock
*);

152 
	`push˛i
();

153 
	`p›˛i
();

156 
	`acquúe¶ìp
(
¶ì∂ock
*);

157 
	`ªÀa£¶ìp
(
¶ì∂ock
*);

158 
	`hﬁdög¶ìp
(
¶ì∂ock
*);

159 
	`öô¶ì∂ock
(
¶ì∂ock
*, *);

162 
	`memcmp
(c⁄° *, c⁄° *, 
uöt
);

163 * 
	`memmove
(*, c⁄° *, 
uöt
);

164 * 
	`mem£t
(*, , 
uöt
);

165 * 
	`ß„°r˝y
(*, const *, );

166 
	`°æí
(const *);

167 
	`°∫cmp
(c⁄° *, c⁄° *, 
uöt
);

168 * 
	`°∫˝y
(*, const *, );

171 
	`¨göt
(, *);

172 
	`¨g±r
(, **, );

173 
	`¨g°r
(, **);

174 
	`„tchöt
(
uöt
, *);

175 
	`„tch°r
(
uöt
, **);

176 
	`sysˇŒ
();

179 
	`timîöô
();

182 
	`idtöô
();

183 
	`tvöô
();

184 
•ölock
 
tick¶ock
;

187 
uöt
 
ticks
;

188 
uöt
 
MLFQ_ticks
;

189 
time_qu™tom
[10];

190 
time_ÆlŸmít
[10];

193 
	`u¨töô
();

194 
	`u¨töå
();

195 
	`u¨çutc
();

198 
	`£göô
();

199 
	`kvmÆloc
();

200 
pde_t
* 
	`£tupkvm
();

201 * 
	`uva2ka
(
pde_t
*, *);

202 
	`Ælocuvm
(
pde_t
*, 
uöt
, uint);

203 
	`dóŒocuvm
(
pde_t
*, 
uöt
, uint);

204 
	`‰ìvm
(
pde_t
*);

205 
	`öôuvm
(
pde_t
*, *, 
uöt
);

206 
	`lﬂduvm
(
pde_t
*, *, 
öode
*, 
uöt
, uint);

207 
pde_t
* 
	`c›yuvm
’de_t*, 
uöt
);

208 
	`swôchuvm
(
¥oc
*);

209 
	`swôchkvm
();

210 
	`c›yout
(
pde_t
*, 
uöt
, *, uint);

211 
	`˛óΩãu
(
pde_t
 *
pgdú
, *
uva
);

214 
	#NELEM
(
x
Ë((x)/((x)[0]))

	)

	@echo.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$maö
(
¨gc
, *
¨gv
[])

8 
i
;

10 
i
 = 1; i < 
¨gc
; i++)

11 
	`¥ötf
(1, "%s%s", 
¨gv
[
i
], i+1 < 
¨gc
 ? " " : "\n");

12 
	`exô
();

13 
	}
}

	@elf.h

3 
	#ELF_MAGIC
 0x464C457FU

4 

	)

6 
	sñfhdr
 {

7 
uöt
 
	mmagic
;

8 
uch¨
 
	mñf
[12];

9 
ush‹t
 
	mty≥
;

10 
ush‹t
 
	mmachöe
;

11 
uöt
 
	mvîsi⁄
;

12 
uöt
 
	míåy
;

13 
uöt
 
	mphoff
;

14 
uöt
 
	mshoff
;

15 
uöt
 
	mÊags
;

16 
ush‹t
 
	mehsize
;

17 
ush‹t
 
	mphítsize
;

18 
ush‹t
 
	mphnum
;

19 
ush‹t
 
	mshítsize
;

20 
ush‹t
 
	mshnum
;

21 
ush‹t
 
	msh°∫dx
;

25 
	s¥oghdr
 {

26 
uöt
 
	mty≥
;

27 
uöt
 
	moff
;

28 
uöt
 
	mvaddr
;

29 
uöt
 
	m∑ddr
;

30 
uöt
 
	mfûesz
;

31 
uöt
 
	mmemsz
;

32 
uöt
 
	mÊags
;

33 
uöt
 
	mÆign
;

37 
	#ELF_PROG_LOAD
 1

	)

40 
	#ELF_PROG_FLAG_EXEC
 1

	)

41 
	#ELF_PROG_FLAG_WRITE
 2

	)

42 
	#ELF_PROG_FLAG_READ
 4

	)

	@entry.S

1 #Thê
xv6
 
kî√l
 
°¨ts
 
executög
 
ö
 
this
 
fûe
. 
This
 fûê
is
 
löked
 
wôh


2 #thê
kî√l
 
C
 
code
, 
so
 
ô
 
ˇn
 
ª„r
 
to
 kî√»
symbﬁs
 
such
 
as
 
maö
().

3 #Thê
boŸ
 
block
 (
boŸasm
.
S
 
™d
 
boŸmaö
.
c
Ë
jumps
 
to
 
íåy
 
bñow
.

5 #Mu…iboŸ 
hódî
, 
mu…iboŸ
 
boŸ
 
lﬂdîs
 
like
 
GNU
 
Grub
.

7 #
#Usög 
GRUB
 2, 
you
 
ˇn
 
boŸ
 
xv6
 
‰om
 
a
 
fûe
 
°‹ed
 
ö
á

9 #Löux 
fûe
 
sy°em
 
by
 
c›yög
 
kî√l
 
‹
 
kî√lmemfs
 
to
 /
boŸ


10 #™d 
thí
 
addög
 
this
 
míu
 
íåy
:

13 #ösmod 
ext2


14 #£à
roŸ
='(hd0,msdos1)'

15 #£à
kî√l
='/boot/kernel'

17 #mu…iboŸ 
$
{
kî√l
} ${kernel}

21 
	~"asm.h
"

22 
	~"memœyout.h
"

23 
	~"mmu.h
"

24 
	~"∑øm.h
"

26 #Mu…iboŸ 
hódî
. 
D©a
 
to
 
dúe˘
 
mu…iboŸ
 
lﬂdî
.

27 .
	gp2Æign
 2

28 .
	gãxt


29 .
globl
 
mu…iboŸ_hódî


30 
	gmu…iboŸ_hódî
:

31 
	#magic
 0x1badb002

	)

32 
	#Êags
 0

	)

33 .
magic


34 .
Êags


35 .(-
magic
-
Êags
)

37 #By 
c⁄víti⁄
, 
the
 
_°¨t
 
symbﬁ
 
•ecifõs
Åhê
ELF
 
íåy
 
poöt
.

38 #Sö˚ 
we
 
haví
't set up virtual memory yet, ourÉntryÖoint is

39 #thê
physiˇl
 
addªss
 
of
 'entry'.

40 .
globl
 
_°¨t


41 
	g_°¨t
 = 
V2P_WO
(
íåy
)

43 #E¡îög 
xv6
 
⁄
 
boŸ
 
¥o˚ss‹
, 
wôh
 
∑gög
 
off
.

44 .
globl
 
íåy


45 
	gíåy
:

46 #Tu∫ 
⁄
 
∑ge
 
size
 
exãnsi⁄
 4
Mbyã
 
∑ges


47 
movl
 %
¸4
, %
óx


48 
‹l
 
$
(
CR4_PSE
), %
óx


49 
	gmovl
 %
	góx
, %
	g¸4


50 #Së 
∑ge
 
dúe˘‹y


51 
movl
 
$
(
V2P_WO
(
íåypgdú
)), %
óx


52 
	gmovl
 %
	góx
, %
	g¸3


53 #Tu∫ 
⁄
 
∑gög
.

54 
	gmovl
 %
	g¸0
, %
óx


55 
‹l
 
$
(
CR0_PG
|
CR0_WP
), %
óx


56 
	gmovl
 %
	góx
, %
	g¸0


58 #Së 
up
 
the
 
°ack
 
poöãr
.

59 
movl
 
$
(
°ack
 + 
KSTACKSIZE
), %
	ge•


61 #Jum∞
to
 
maö
(), 
™d
 tÿ
executög
 
©


62 #high 
addªs£s
. 
The
 
ödúe˘
 
ˇŒ
 
is
 
√eded
 
beˇu£


63 #thê
as£mbÀr
 
¥odu˚s
 
a
 
PC
-
ªœtive
 
ö°ru˘i⁄


64 #f‹ 
a
 
dúe˘
 
jump
.

65 
mov
 
	g$maö
, %
óx


66 
	gjmp
 *%
	góx


68 .
comm
 
	g°ack
, 
	gKSTACKSIZE


	@entryother.S

1 
	~"asm.h
"

2 
	~"memœyout.h
"

3 
	~"mmu.h
"

5 #Each 
n⁄
-
boŸ
 
CPU
 ("AP"Ë
is
 
°¨ãd
 
up
 
ö
 
ª•⁄£
 
to
 
a
 
STARTUP


6 #IPI 
‰om
 
the
 
boŸ
 
CPU
. 
Se˘i⁄
 
B
.4.2 
of
Åhê
Mu…i
-
Pro˚ss‹


7 #S≥cifiˇti⁄ 
ßys
 
th©
 
the
 
AP
 
wûl
 
°¨t
 
ö
 
ªÆ
 
mode
 
wôh
 
CS
:
IP


8 #£à
to
 
XY00
:0000, 
whîe
 
XY
 
is
 
™
 8-
bô
 
vÆue
 
£¡
 
wôh
 
the


9 #STARTUP. 
Thus
 
this
 
code
 
mu°
 
°¨t
 
©
 
a
 4096-
byã
 
bound¨y
.

10 #
#Beˇu£ 
this
 
code
 
£ts
 
DS
 
to
 
zîo
, 
ô
 
mu°
 
sô


12 #© 
™
 
addªss
 
ö
 
the
 
low
 2^16 
byãs
.

13 #
#SèπŸhî†(
ö
 
maö
.
c
Ë
£nds
 
the
 
STARTUPs
 
⁄e
 
©
 
a
 
time
.

15 #Ià
c›õs
 
this
 
code
 (
°¨t
Ë
©
 0x7000. 
It
 
puts
 
the
 
addªss
 
of


16 #®
√wly
 
Æloˇãd
 
≥r
-
c‹e
 
°ack
 
ö
 
°¨t
-4,
the
 
addªss
 
of
Åhe

17 #∂a˚ 
to
 
jump
Åÿ(
m≥¡î
Ë
ö
 
°¨t
-8, 
™d
 
the
 
physiˇl
 
addªss


18 #o‡
íåypgdú
 
ö
 
°¨t
-12.

19 #
#Thi†
code
 
comböes
 
ñemíts
 
of
 
boŸasm
.
S
 
™d
 
íåy
.S.

22 .
	gcode16


23 .
globl
 
°¨t


24 
	g°¨t
:

25 
˛i


27 #Zîÿ
d©a
 
£gmít
 
ªgi°îs
 
DS
, 
ES
, 
™d
 
SS
.

28 
	gx‹w
 %
	gax
,%
ax


29 
	gmovw
 %
	gax
,%
ds


30 
	gmovw
 %
	gax
,%
es


31 
	gmovw
 %
	gax
,%
	gss


33 #Swôch 
‰om
 
ªÆ
 
to
 
¥Ÿe˘ed
 
mode
. 
U£
 
a
 
boŸ°øp
 
GDT
 
th©
 
makes


34 #vútuÆ 
addªs£s
 
m≠
 
dúe˘ly
 
to
 
physiˇl
áddªs£†
so
 
th©
 
the


35 #ef„˘ivê
mem‹y
 
m≠
 
d€¢
't change duringÅheÅransition.

36 
lgdt
 
gdtdesc


37 
	gmovl
 %
	g¸0
, %
óx


38 
‹l
 
	g$CR0_PE
, %
óx


39 
	gmovl
 %
	góx
, %
	g¸0


41 #Com∂ëê
the
 
å™sôi⁄
 
to
 32-
bô
 
¥Ÿe˘ed
 
mode
 
by
 
usög
 
a
 
jmp


42 #tÿ
ªlﬂd
 %
cs
 
™d
 %
eù
. 
The
 
£gmít
 
des¸ùt‹s
 
¨e
 
£t
 
up
 
wôh
 
no


43 #å™¶©i⁄, 
so
 
th©
 
the
 
m≠pög
 
is
 
°ûl
Åhê
idítôy
 mapping.

44 
ljm∂
 
$
(
SEG_KCODE
<<3), $(
°¨t32
)

47 .
	gcode32
 #Tñ»
as£mbÀr
 
to
 
	ggíî©e
 32-
bô
 
code
 
	gnow
.

48 
	g°¨t32
:

49 #Së 
up
 
the
 
¥Ÿe˘ed
-
mode
 
d©a
 
£gmít
 
ªgi°îs


50 
movw
 
$
(
SEG_KDATA
<<3), %
	gax
 #Ou∏
d©a
 
£gmít
 
£À˘‹


51 
	gmovw
 %
	gax
, %
	gds
 #-> 
	gDS
: 
D©a
 
Segmít


52 
movw
 %
ax
, %
	ges
 #-> 
	gES
: 
Exåa
 
Segmít


53 
movw
 %
ax
, %
	gss
 #-> 
	gSS
: 
Sèck
 
Segmít


54 
movw
 
$0
, %
	gax
 #Zîÿ
£gmíts
 
nŸ
 
ªady
 
u£


55 
	gmovw
 %
	gax
, %
	gfs
 #-> 
FS


56 
	gmovw
 %
	gax
, %
	ggs
 #-> 
	gGS


58 #Tu∫ 
⁄
 
∑ge
 
size
 
exãnsi⁄
 4
Mbyã
 
∑ges


59 
	gmovl
 %
	g¸4
, %
óx


60 
‹l
 
$
(
CR4_PSE
), %
óx


61 
	gmovl
 %
	góx
, %
	g¸4


62 #U£ 
íåypgdú
 
as
 
our
 
öôül
 
∑ge
 
èbÀ


63 
movl
 (
°¨t
-12), %
óx


64 
	gmovl
 %
	góx
, %
	g¸3


65 #Tu∫ 
⁄
 
∑gög
.

66 
	gmovl
 %
	g¸0
, %
óx


67 
‹l
 
$
(
CR0_PE
|
CR0_PG
|
CR0_WP
), %
óx


68 
	gmovl
 %
	góx
, %
	g¸0


70 #Swôch 
to
 
the
 
°ack
 
Æloˇãd
 
by
 
°¨tŸhîs
()

71 
movl
 (
°¨t
-4), %
	ge•


72 #CÆ»
m≥¡î
()

73 
	gˇŒ
 *(
	g°¨t
-8)

75 
movw
 
	g$0x8a00
, %
ax


76 
	gmovw
 %
	gax
, %
dx


77 
	goutw
 %
	gax
, %
dx


78 
movw
 
	g$0x8´0
, %
ax


79 
	goutw
 %
	gax
, %
dx


80 
	g•ö
:

81 
jmp
 
•ö


83 .
p2Æign
 2

84 
gdt
:

85 
SEG_NULLASM


86 
SEG_ASM
(
STA_X
|
STA_R
, 0, 0xffffffff)

87 
	$SEG_ASM
(
STA_W
, 0, 0xffffffff)

90 
gdtdesc
:

91 .
	`w‹d
 (
gdtdesc
 - 
gdt
 - 1)

92 .
gdt


	@exec.c

1 
	~"ty≥s.h
"

2 
	~"∑øm.h
"

3 
	~"memœyout.h
"

4 
	~"mmu.h
"

5 
	~"¥oc.h
"

6 
	~"defs.h
"

7 
	~"x86.h
"

8 
	~"ñf.h
"

11 
	$exec
(*
∑th
, **
¨gv
)

13 *
s
, *
œ°
;

14 
i
, 
off
;

15 
uöt
 
¨gc
, 
sz
, 
•
, 
u°ack
[3+
MAXARG
+1];

16 
ñfhdr
 
ñf
;

17 
öode
 *
ù
;

18 
¥oghdr
 
ph
;

19 
pde_t
 *
pgdú
, *
ﬁdpgdú
;

20 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

22 
	`begö_›
();

24 if((
ù
 = 
	`«mei
(
∑th
)) == 0){

25 
	`íd_›
();

26 
	`˝rötf
("exec: fail\n");

29 
	`ûock
(
ù
);

30 
pgdú
 = 0;

33 if(
	`ªadi
(
ù
, (*)&
ñf
, 0, (elf)) != (elf))

34 
bad
;

35 if(
ñf
.
magic
 !
ELF_MAGIC
)

36 
bad
;

38 if((
pgdú
 = 
	`£tupkvm
()) == 0)

39 
bad
;

42 
sz
 = 0;

43 
i
=0, 
off
=
ñf
.
phoff
; i<ñf.
phnum
; i++, off+=(
ph
)){

44 if(
	`ªadi
(
ù
, (*)&
ph
, 
off
, (ph)) != (ph))

45 
bad
;

46 if(
ph
.
ty≥
 !
ELF_PROG_LOAD
)

48 if(
ph
.
memsz
 <Öh.
fûesz
)

49 
bad
;

50 if(
ph
.
vaddr
 +Öh.
memsz
 <Öh.vaddr)

51 
bad
;

52 if((
sz
 = 
	`Ælocuvm
(
pgdú
, sz, 
ph
.
vaddr
 +Öh.
memsz
)) == 0)

53 
bad
;

54 if(
ph
.
vaddr
 % 
PGSIZE
 != 0)

55 
bad
;

56 if(
	`lﬂduvm
(
pgdú
, (*)
ph
.
vaddr
, 
ù
,Öh.
off
,Öh.
fûesz
) < 0)

57 
bad
;

59 
	`iu∆ockput
(
ù
);

60 
	`íd_›
();

61 
ù
 = 0;

65 
sz
 = 
	`PGROUNDUP
(sz);

66 if((
sz
 = 
	`Ælocuvm
(
pgdú
, sz, sz + 2*
PGSIZE
)) == 0)

67 
bad
;

68 
	`˛óΩãu
(
pgdú
, (*)(
sz
 - 2*
PGSIZE
));

69 
•
 = 
sz
;

72 
¨gc
 = 0; 
¨gv
[argc];árgc++) {

73 if(
¨gc
 >
MAXARG
)

74 
bad
;

75 
•
 = (• - (
	`°æí
(
¨gv
[
¨gc
]) + 1)) & ~3;

76 if(
	`c›yout
(
pgdú
, 
•
, 
¨gv
[
¨gc
], 
	`°æí
(argv[argc]) + 1) < 0)

77 
bad
;

78 
u°ack
[3+
¨gc
] = 
•
;

80 
u°ack
[3+
¨gc
] = 0;

82 
u°ack
[0] = 0xffffffff;

83 
u°ack
[1] = 
¨gc
;

84 
u°ack
[2] = 
•
 - (
¨gc
+1)*4;

86 
•
 -(3+
¨gc
+1) * 4;

87 if(
	`c›yout
(
pgdú
, 
•
, 
u°ack
, (3+
¨gc
+1)*4) < 0)

88 
bad
;

91 
œ°
=
s
=
∑th
; *s; s++)

92 if(*
s
 == '/')

93 
œ°
 = 
s
+1;

94 
	`ß„°r˝y
(
cuΩroc
->
«me
, 
œ°
, (curproc->name));

97 
ﬁdpgdú
 = 
cuΩroc
->
pgdú
;

98 
cuΩroc
->
pgdú
 =Ögdir;

99 
cuΩroc
->
sz
 = sz;

100 
cuΩroc
->
tf
->
eù
 = 
ñf
.
íåy
;

101 
cuΩroc
->
tf
->
e•
 = 
•
;

102 
	`swôchuvm
(
cuΩroc
);

103 
	`‰ìvm
(
ﬁdpgdú
);

106 
bad
:

107 if(
pgdú
)

108 
	`‰ìvm
(
pgdú
);

109 if(
ù
){

110 
	`iu∆ockput
(
ù
);

111 
	`íd_›
();

114 
	}
}

	@fcntl.h

1 
	#O_RDONLY
 0x000

	)

2 
	#O_WRONLY
 0x001

	)

3 
	#O_RDWR
 0x002

	)

4 
	#O_CREATE
 0x200

	)

	@file.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"fs.h
"

9 
	~"•ölock.h
"

10 
	~"¶ì∂ock.h
"

11 
	~"fûe.h
"

13 
devsw
 
	gdevsw
[
NDEV
];

15 
•ölock
 
	mlock
;

16 
fûe
 
	mfûe
[
NFILE
];

17 } 
	g·abÀ
;

20 
	$fûeöô
()

22 
	`öôlock
(&
·abÀ
.
lock
, "ftable");

23 
	}
}

26 
fûe
*

27 
	$fûóŒoc
()

29 
fûe
 *
f
;

31 
	`acquúe
(&
·abÀ
.
lock
);

32 
f
 = 
·abÀ
.
fûe
; f < fèbÀ.fûê+ 
NFILE
; f++){

33 if(
f
->
ªf
 == 0){

34 
f
->
ªf
 = 1;

35 
	`ªÀa£
(&
·abÀ
.
lock
);

36  
f
;

39 
	`ªÀa£
(&
·abÀ
.
lock
);

41 
	}
}

44 
fûe
*

45 
	$fûedup
(
fûe
 *
f
)

47 
	`acquúe
(&
·abÀ
.
lock
);

48 if(
f
->
ªf
 < 1)

49 
	`∑nic
("filedup");

50 
f
->
ªf
++;

51 
	`ªÀa£
(&
·abÀ
.
lock
);

52  
f
;

53 
	}
}

57 
	$fûe˛o£
(
fûe
 *
f
)

59 
fûe
 
ff
;

61 
	`acquúe
(&
·abÀ
.
lock
);

62 if(
f
->
ªf
 < 1)

63 
	`∑nic
("fileclose");

64 if(--
f
->
ªf
 > 0){

65 
	`ªÀa£
(&
·abÀ
.
lock
);

68 
ff
 = *
f
;

69 
f
->
ªf
 = 0;

70 
f
->
ty≥
 = 
FD_NONE
;

71 
	`ªÀa£
(&
·abÀ
.
lock
);

73 if(
ff
.
ty≥
 =
FD_PIPE
)

74 
	`pùe˛o£
(
ff
.
pùe
, ff.
wrôabÀ
);

75 if(
ff
.
ty≥
 =
FD_INODE
){

76 
	`begö_›
();

77 
	`ùut
(
ff
.
ù
);

78 
	`íd_›
();

80 
	}
}

84 
	$fûe°©
(
fûe
 *
f
, 
°©
 *
°
)

86 if(
f
->
ty≥
 =
FD_INODE
){

87 
	`ûock
(
f
->
ù
);

88 
	`°©i
(
f
->
ù
, 
°
);

89 
	`iu∆ock
(
f
->
ù
);

93 
	}
}

97 
	$fûîód
(
fûe
 *
f
, *
addr
, 
n
)

99 
r
;

101 if(
f
->
ªadabÀ
 == 0)

103 if(
f
->
ty≥
 =
FD_PIPE
)

104  
	`pùîód
(
f
->
pùe
, 
addr
, 
n
);

105 if(
f
->
ty≥
 =
FD_INODE
){

106 
	`ûock
(
f
->
ù
);

107 if((
r
 = 
	`ªadi
(
f
->
ù
, 
addr
, f->
off
, 
n
)) > 0)

108 
f
->
off
 +
r
;

109 
	`iu∆ock
(
f
->
ù
);

110  
r
;

112 
	`∑nic
("fileread");

113 
	}
}

118 
	$fûewrôe
(
fûe
 *
f
, *
addr
, 
n
)

120 
r
;

122 if(
f
->
wrôabÀ
 == 0)

124 if(
f
->
ty≥
 =
FD_PIPE
)

125  
	`pùewrôe
(
f
->
pùe
, 
addr
, 
n
);

126 if(
f
->
ty≥
 =
FD_INODE
){

133 
max
 = ((
MAXOPBLOCKS
-1-1-2) / 2) * 512;

134 
i
 = 0;

135 
i
 < 
n
){

136 
n1
 = 
n
 - 
i
;

137 if(
n1
 > 
max
)

138 
n1
 = 
max
;

140 
	`begö_›
();

141 
	`ûock
(
f
->
ù
);

142 i‡((
r
 = 
	`wrôei
(
f
->
ù
, 
addr
 + 
i
, f->
off
, 
n1
)) > 0)

143 
f
->
off
 +
r
;

144 
	`iu∆ock
(
f
->
ù
);

145 
	`íd_›
();

147 if(
r
 < 0)

149 if(
r
 !
n1
)

150 
	`∑nic
("short filewrite");

151 
i
 +
r
;

153  
i
 =
n
 ?Ç : -1;

155 
	`∑nic
("filewrite");

156 
	}
}

	@file.h

1 
	sfûe
 {

2 íum { 
	mFD_NONE
, 
	mFD_PIPE
, 
	mFD_INODE
 } 
	mty≥
;

3 
	mªf
;

4 
	mªadabÀ
;

5 
	mwrôabÀ
;

6 
pùe
 *
	mpùe
;

7 
öode
 *
	mù
;

8 
uöt
 
	moff
;

13 
	söode
 {

14 
uöt
 
	mdev
;

15 
uöt
 
	möum
;

16 
	mªf
;

17 
¶ì∂ock
 
	mlock
;

18 
	mvÆid
;

20 
	mty≥
;

21 
	mmaj‹
;

22 
	mmö‹
;

23 
	m∆ök
;

24 
uöt
 
	msize
;

25 
uöt
 
	maddrs
[
NDIRECT
+1];

30 
	sdevsw
 {

31 (*
	mªad
)(
	möode
*, *, );

32 (*
	mwrôe
)(
	möode
*, *, );

35 
devsw
 devsw[];

37 
	#CONSOLE
 1

	)

	@forktest.c

4 
	~"ty≥s.h
"

5 
	~"°©.h
"

6 
	~"u£r.h
"

8 
	#N
 1000

	)

11 
	$¥ötf
(
fd
, c⁄° *
s
, ...)

13 
	`wrôe
(
fd
, 
s
, 
	`°æí
(s));

14 
	}
}

17 
	$f‹kã°
()

19 
n
, 
pid
;

21 
	`¥ötf
(1, "forkÅest\n");

23 
n
=0;Ç<
N
;Ç++){

24 
pid
 = 
	`f‹k
();

25 if(
pid
 < 0)

27 if(
pid
 == 0)

28 
	`exô
();

31 if(
n
 =
N
){

32 
	`¥ötf
(1, "f‹k cœimedÅÿw‹k NÅimes!\n", 
N
);

33 
	`exô
();

36 ; 
n
 > 0;Ç--){

37 if(
	`waô
() < 0){

38 
	`¥ötf
(1, "wait stoppedÉarly\n");

39 
	`exô
();

43 if(
	`waô
() != -1){

44 
	`¥ötf
(1, "wait gotÅoo many\n");

45 
	`exô
();

48 
	`¥ötf
(1, "forkÅest OK\n");

49 
	}
}

52 
	$maö
()

54 
	`f‹kã°
();

55 
	`exô
();

56 
	}
}

	@fs.c

12 
	~"ty≥s.h
"

13 
	~"defs.h
"

14 
	~"∑øm.h
"

15 
	~"°©.h
"

16 
	~"mmu.h
"

17 
	~"¥oc.h
"

18 
	~"•ölock.h
"

19 
	~"¶ì∂ock.h
"

20 
	~"fs.h
"

21 
	~"buf.h
"

22 
	~"fûe.h
"

24 
	#mö
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

25 
ôrunc
(
öode
*);

28 
su≥rblock
 
	gsb
;

32 
	$ªadsb
(
dev
, 
su≥rblock
 *
sb
)

34 
buf
 *
bp
;

36 
bp
 = 
	`bªad
(
dev
, 1);

37 
	`memmove
(
sb
, 
bp
->
d©a
, (*sb));

38 
	`bªl£
(
bp
);

39 
	}
}

43 
	$bzîo
(
dev
, 
bno
)

45 
buf
 *
bp
;

47 
bp
 = 
	`bªad
(
dev
, 
bno
);

48 
	`mem£t
(
bp
->
d©a
, 0, 
BSIZE
);

49 
	`log_wrôe
(
bp
);

50 
	`bªl£
(
bp
);

51 
	}
}

56 
uöt


57 
	$bÆloc
(
uöt
 
dev
)

59 
b
, 
bi
, 
m
;

60 
buf
 *
bp
;

62 
bp
 = 0;

63 
b
 = 0; b < 
sb
.
size
; b +
BPB
){

64 
bp
 = 
	`bªad
(
dev
, 
	`BBLOCK
(
b
, 
sb
));

65 
bi
 = 0; bò< 
BPB
 && 
b
 + bò< 
sb
.
size
; bi++){

66 
m
 = 1 << (
bi
 % 8);

67 if((
bp
->
d©a
[
bi
/8] & 
m
) == 0){

68 
bp
->
d©a
[
bi
/8] |
m
;

69 
	`log_wrôe
(
bp
);

70 
	`bªl£
(
bp
);

71 
	`bzîo
(
dev
, 
b
 + 
bi
);

72  
b
 + 
bi
;

75 
	`bªl£
(
bp
);

77 
	`∑nic
("balloc: out of blocks");

78 
	}
}

82 
	$b‰ì
(
dev
, 
uöt
 
b
)

84 
buf
 *
bp
;

85 
bi
, 
m
;

87 
bp
 = 
	`bªad
(
dev
, 
	`BBLOCK
(
b
, 
sb
));

88 
bi
 = 
b
 % 
BPB
;

89 
m
 = 1 << (
bi
 % 8);

90 if((
bp
->
d©a
[
bi
/8] & 
m
) == 0)

91 
	`∑nic
("freeing free block");

92 
bp
->
d©a
[
bi
/8] &~
m
;

93 
	`log_wrôe
(
bp
);

94 
	`bªl£
(
bp
);

95 
	}
}

167 
•ölock
 
	mlock
;

168 
öode
 
	möode
[
NINODE
];

169 } 
	giˇche
;

172 
	$iöô
(
dev
)

174 
i
 = 0;

176 
	`öôlock
(&
iˇche
.
lock
, "icache");

177 
i
 = 0; i < 
NINODE
; i++) {

178 
	`öô¶ì∂ock
(&
iˇche
.
öode
[
i
].
lock
, "inode");

181 
	`ªadsb
(
dev
, &
sb
);

182 
	`˝rötf
("sb: sizê%dÇblock†%dÇöode†%dÇlog %dÜog°¨à%d\
 %d bm≠ sèπ %d\n", 
sb
.
size
, sb.
nblocks
,

184 
sb
.
nöodes
, sb.
∆og
, sb.
log°¨t
, sb.
öode°¨t
,

185 
sb
.
bm≠°¨t
);

186 
	}
}

188 
öode
* 
igë
(
uöt
 
dev
, uöà
öum
);

194 
öode
*

195 
	$üŒoc
(
uöt
 
dev
, 
ty≥
)

197 
öum
;

198 
buf
 *
bp
;

199 
döode
 *
dù
;

201 
öum
 = 1; inum < 
sb
.
nöodes
; inum++){

202 
bp
 = 
	`bªad
(
dev
, 
	`IBLOCK
(
öum
, 
sb
));

203 
dù
 = (
döode
*)
bp
->
d©a
 + 
öum
%
IPB
;

204 if(
dù
->
ty≥
 == 0){

205 
	`mem£t
(
dù
, 0, (*dip));

206 
dù
->
ty≥
 =Åype;

207 
	`log_wrôe
(
bp
);

208 
	`bªl£
(
bp
);

209  
	`igë
(
dev
, 
öum
);

211 
	`bªl£
(
bp
);

213 
	`∑nic
("ialloc:Ço inodes");

214 
	}
}

221 
	$iupd©e
(
öode
 *
ù
)

223 
buf
 *
bp
;

224 
döode
 *
dù
;

226 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`IBLOCK
(ù->
öum
, 
sb
));

227 
dù
 = (
döode
*)
bp
->
d©a
 + 
ù
->
öum
%
IPB
;

228 
dù
->
ty≥
 = 
ù
->type;

229 
dù
->
maj‹
 = 
ù
->major;

230 
dù
->
mö‹
 = 
ù
->minor;

231 
dù
->
∆ök
 = 
ù
->nlink;

232 
dù
->
size
 = 
ù
->size;

233 
	`memmove
(
dù
->
addrs
, 
ù
->addrs, (ip->addrs));

234 
	`log_wrôe
(
bp
);

235 
	`bªl£
(
bp
);

236 
	}
}

241 
öode
*

242 
	$igë
(
uöt
 
dev
, uöà
öum
)

244 
öode
 *
ù
, *
em±y
;

246 
	`acquúe
(&
iˇche
.
lock
);

249 
em±y
 = 0;

250 
ù
 = &
iˇche
.
öode
[0]; i∞< &iˇche.öode[
NINODE
]; ip++){

251 if(
ù
->
ªf
 > 0 && ip->
dev
 =dev && ip->
öum
 == inum){

252 
ù
->
ªf
++;

253 
	`ªÀa£
(&
iˇche
.
lock
);

254  
ù
;

256 if(
em±y
 =0 && 
ù
->
ªf
 == 0)

257 
em±y
 = 
ù
;

261 if(
em±y
 == 0)

262 
	`∑nic
("iget:Ço inodes");

264 
ù
 = 
em±y
;

265 
ù
->
dev
 = dev;

266 
ù
->
öum
 = inum;

267 
ù
->
ªf
 = 1;

268 
ù
->
vÆid
 = 0;

269 
	`ªÀa£
(&
iˇche
.
lock
);

271  
ù
;

272 
	}
}

276 
öode
*

277 
	$idup
(
öode
 *
ù
)

279 
	`acquúe
(&
iˇche
.
lock
);

280 
ù
->
ªf
++;

281 
	`ªÀa£
(&
iˇche
.
lock
);

282  
ù
;

283 
	}
}

288 
	$ûock
(
öode
 *
ù
)

290 
buf
 *
bp
;

291 
döode
 *
dù
;

293 if(
ù
 =0 || ip->
ªf
 < 1)

294 
	`∑nic
("ilock");

296 
	`acquúe¶ìp
(&
ù
->
lock
);

298 if(
ù
->
vÆid
 == 0){

299 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`IBLOCK
(ù->
öum
, 
sb
));

300 
dù
 = (
döode
*)
bp
->
d©a
 + 
ù
->
öum
%
IPB
;

301 
ù
->
ty≥
 = 
dù
->type;

302 
ù
->
maj‹
 = 
dù
->major;

303 
ù
->
mö‹
 = 
dù
->minor;

304 
ù
->
∆ök
 = 
dù
->nlink;

305 
ù
->
size
 = 
dù
->size;

306 
	`memmove
(
ù
->
addrs
, 
dù
->addrs, (ip->addrs));

307 
	`bªl£
(
bp
);

308 
ù
->
vÆid
 = 1;

309 if(
ù
->
ty≥
 == 0)

310 
	`∑nic
("ilock:ÇoÅype");

312 
	}
}

316 
	$iu∆ock
(
öode
 *
ù
)

318 if(
ù
 =0 || !
	`hﬁdög¶ìp
(&ù->
lock
Ë|| ip->
ªf
 < 1)

319 
	`∑nic
("iunlock");

321 
	`ªÀa£¶ìp
(&
ù
->
lock
);

322 
	}
}

332 
	$ùut
(
öode
 *
ù
)

334 
	`acquúe¶ìp
(&
ù
->
lock
);

335 if(
ù
->
vÆid
 && ip->
∆ök
 == 0){

336 
	`acquúe
(&
iˇche
.
lock
);

337 
r
 = 
ù
->
ªf
;

338 
	`ªÀa£
(&
iˇche
.
lock
);

339 if(
r
 == 1){

341 
	`ôrunc
(
ù
);

342 
ù
->
ty≥
 = 0;

343 
	`iupd©e
(
ù
);

344 
ù
->
vÆid
 = 0;

347 
	`ªÀa£¶ìp
(&
ù
->
lock
);

349 
	`acquúe
(&
iˇche
.
lock
);

350 
ù
->
ªf
--;

351 
	`ªÀa£
(&
iˇche
.
lock
);

352 
	}
}

356 
	$iu∆ockput
(
öode
 *
ù
)

358 
	`iu∆ock
(
ù
);

359 
	`ùut
(
ù
);

360 
	}
}

372 
uöt


373 
	$bm≠
(
öode
 *
ù
, 
uöt
 
bn
)

375 
uöt
 
addr
, *
a
;

376 
buf
 *
bp
;

378 if(
bn
 < 
NDIRECT
){

379 if((
addr
 = 
ù
->
addrs
[
bn
]) == 0)

380 
ù
->
addrs
[
bn
] = 
addr
 = 
	`bÆloc
(ù->
dev
);

381  
addr
;

383 
bn
 -
NDIRECT
;

385 if(
bn
 < 
NINDIRECT
){

387 if((
addr
 = 
ù
->
addrs
[
NDIRECT
]) == 0)

388 
ù
->
addrs
[
NDIRECT
] = 
addr
 = 
	`bÆloc
(ù->
dev
);

389 
bp
 = 
	`bªad
(
ù
->
dev
, 
addr
);

390 
a
 = (
uöt
*)
bp
->
d©a
;

391 if((
addr
 = 
a
[
bn
]) == 0){

392 
a
[
bn
] = 
addr
 = 
	`bÆloc
(
ù
->
dev
);

393 
	`log_wrôe
(
bp
);

395 
	`bªl£
(
bp
);

396  
addr
;

399 
	`∑nic
("bmap: out ofÑange");

400 
	}
}

408 
	$ôrunc
(
öode
 *
ù
)

410 
i
, 
j
;

411 
buf
 *
bp
;

412 
uöt
 *
a
;

414 
i
 = 0; i < 
NDIRECT
; i++){

415 if(
ù
->
addrs
[
i
]){

416 
	`b‰ì
(
ù
->
dev
, ip->
addrs
[
i
]);

417 
ù
->
addrs
[
i
] = 0;

421 if(
ù
->
addrs
[
NDIRECT
]){

422 
bp
 = 
	`bªad
(
ù
->
dev
, ip->
addrs
[
NDIRECT
]);

423 
a
 = (
uöt
*)
bp
->
d©a
;

424 
j
 = 0; j < 
NINDIRECT
; j++){

425 if(
a
[
j
])

426 
	`b‰ì
(
ù
->
dev
, 
a
[
j
]);

428 
	`bªl£
(
bp
);

429 
	`b‰ì
(
ù
->
dev
, ip->
addrs
[
NDIRECT
]);

430 
ù
->
addrs
[
NDIRECT
] = 0;

433 
ù
->
size
 = 0;

434 
	`iupd©e
(
ù
);

435 
	}
}

440 
	$°©i
(
öode
 *
ù
, 
°©
 *
°
)

442 
°
->
dev
 = 
ù
->dev;

443 
°
->
öo
 = 
ù
->
öum
;

444 
°
->
ty≥
 = 
ù
->type;

445 
°
->
∆ök
 = 
ù
->nlink;

446 
°
->
size
 = 
ù
->size;

447 
	}
}

453 
	$ªadi
(
öode
 *
ù
, *
d°
, 
uöt
 
off
, uöà
n
)

455 
uöt
 
tŸ
, 
m
;

456 
buf
 *
bp
;

458 if(
ù
->
ty≥
 =
T_DEV
){

459 if(
ù
->
maj‹
 < 0 || ip->maj‹ >
NDEV
 || !
devsw
[ù->maj‹].
ªad
)

461  
devsw
[
ù
->
maj‹
].
	`ªad
(ù, 
d°
, 
n
);

464 if(
off
 > 
ù
->
size
 || of‡+ 
n
 < off)

466 if(
off
 + 
n
 > 
ù
->
size
)

467 
n
 = 
ù
->
size
 - 
off
;

469 
tŸ
=0;ÅŸ<
n
;ÅŸ+=
m
, 
off
+=m, 
d°
+=m){

470 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`bm≠
(ù, 
off
/
BSIZE
));

471 
m
 = 
	`mö
(
n
 - 
tŸ
, 
BSIZE
 - 
off
%BSIZE);

472 
	`memmove
(
d°
, 
bp
->
d©a
 + 
off
%
BSIZE
, 
m
);

473 
	`bªl£
(
bp
);

475  
n
;

476 
	}
}

482 
	$wrôei
(
öode
 *
ù
, *
§c
, 
uöt
 
off
, uöà
n
)

484 
uöt
 
tŸ
, 
m
;

485 
buf
 *
bp
;

487 if(
ù
->
ty≥
 =
T_DEV
){

488 if(
ù
->
maj‹
 < 0 || ip->maj‹ >
NDEV
 || !
devsw
[ù->maj‹].
wrôe
)

490  
devsw
[
ù
->
maj‹
].
	`wrôe
(ù, 
§c
, 
n
);

493 if(
off
 > 
ù
->
size
 || of‡+ 
n
 < off)

495 if(
off
 + 
n
 > 
MAXFILE
*
BSIZE
)

498 
tŸ
=0;ÅŸ<
n
;ÅŸ+=
m
, 
off
+=m, 
§c
+=m){

499 
bp
 = 
	`bªad
(
ù
->
dev
, 
	`bm≠
(ù, 
off
/
BSIZE
));

500 
m
 = 
	`mö
(
n
 - 
tŸ
, 
BSIZE
 - 
off
%BSIZE);

501 
	`memmove
(
bp
->
d©a
 + 
off
%
BSIZE
, 
§c
, 
m
);

502 
	`log_wrôe
(
bp
);

503 
	`bªl£
(
bp
);

506 if(
n
 > 0 && 
off
 > 
ù
->
size
){

507 
ù
->
size
 = 
off
;

508 
	`iupd©e
(
ù
);

510  
n
;

511 
	}
}

517 
	$«mecmp
(c⁄° *
s
, c⁄° *
t
)

519  
	`°∫cmp
(
s
, 
t
, 
DIRSIZ
);

520 
	}
}

524 
öode
*

525 
	$dúlookup
(
öode
 *
dp
, *
«me
, 
uöt
 *
poff
)

527 
uöt
 
off
, 
öum
;

528 
dúít
 
de
;

530 if(
dp
->
ty≥
 !
T_DIR
)

531 
	`∑nic
("dirlookupÇot DIR");

533 
off
 = 0; of‡< 
dp
->
size
; of‡+(
de
)){

534 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

535 
	`∑nic
("dirlookupÑead");

536 if(
de
.
öum
 == 0)

538 if(
	`«mecmp
(
«me
, 
de
.name) == 0){

540 if(
poff
)

541 *
poff
 = 
off
;

542 
öum
 = 
de
.inum;

543  
	`igë
(
dp
->
dev
, 
öum
);

548 
	}
}

552 
	$dúlök
(
öode
 *
dp
, *
«me
, 
uöt
 
öum
)

554 
off
;

555 
dúít
 
de
;

556 
öode
 *
ù
;

559 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, 0)) != 0){

560 
	`ùut
(
ù
);

565 
off
 = 0; of‡< 
dp
->
size
; of‡+(
de
)){

566 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

567 
	`∑nic
("dirlinkÑead");

568 if(
de
.
öum
 == 0)

572 
	`°∫˝y
(
de
.
«me
,Çame, 
DIRSIZ
);

573 
de
.
öum
 = inum;

574 if(
	`wrôei
(
dp
, (*)&
de
, 
off
, (de)) != (de))

575 
	`∑nic
("dirlink");

578 
	}
}

596 
	$skùñem
(*
∑th
, *
«me
)

598 *
s
;

599 
Àn
;

601 *
∑th
 == '/')

602 
∑th
++;

603 if(*
∑th
 == 0)

605 
s
 = 
∑th
;

606 *
∑th
 != '/' && *path != 0)

607 
∑th
++;

608 
Àn
 = 
∑th
 - 
s
;

609 if(
Àn
 >
DIRSIZ
)

610 
	`memmove
(
«me
, 
s
, 
DIRSIZ
);

612 
	`memmove
(
«me
, 
s
, 
Àn
);

613 
«me
[
Àn
] = 0;

615 *
∑th
 == '/')

616 
∑th
++;

617  
∑th
;

618 
	}
}

624 
öode
*

625 
	$«mex
(*
∑th
, 
«meù¨ít
, *
«me
)

627 
öode
 *
ù
, *
√xt
;

629 if(*
∑th
 == '/')

630 
ù
 = 
	`igë
(
ROOTDEV
, 
ROOTINO
);

632 
ù
 = 
	`idup
(
	`my¥oc
()->
cwd
);

634 (
∑th
 = 
	`skùñem
’©h, 
«me
)) != 0){

635 
	`ûock
(
ù
);

636 if(
ù
->
ty≥
 !
T_DIR
){

637 
	`iu∆ockput
(
ù
);

640 if(
«meù¨ít
 && *
∑th
 == '\0'){

642 
	`iu∆ock
(
ù
);

643  
ù
;

645 if((
√xt
 = 
	`dúlookup
(
ù
, 
«me
, 0)) == 0){

646 
	`iu∆ockput
(
ù
);

649 
	`iu∆ockput
(
ù
);

650 
ù
 = 
√xt
;

652 if(
«meù¨ít
){

653 
	`ùut
(
ù
);

656  
ù
;

657 
	}
}

659 
öode
*

660 
	$«mei
(*
∑th
)

662 
«me
[
DIRSIZ
];

663  
	`«mex
(
∑th
, 0, 
«me
);

664 
	}
}

666 
öode
*

667 
	$«meù¨ít
(*
∑th
, *
«me
)

669  
	`«mex
(
∑th
, 1, 
«me
);

670 
	}
}

	@fs.h

5 
	#ROOTINO
 1

6 
	#BSIZE
 512

7 

	)

14 
	ssu≥rblock
 {

15 
uöt
 
	msize
;

16 
uöt
 
	mnblocks
;

17 
uöt
 
	mnöodes
;

18 
uöt
 
	m∆og
;

19 
uöt
 
	mlog°¨t
;

20 
uöt
 
	möode°¨t
;

21 
uöt
 
	mbm≠°¨t
;

24 
	#NDIRECT
 12

	)

25 
	#NINDIRECT
 (
BSIZE
 / (
uöt
))

	)

26 
	#MAXFILE
 (
NDIRECT
 + 
NINDIRECT
)

	)

29 
	sdöode
 {

30 
	mty≥
;

31 
	mmaj‹
;

32 
	mmö‹
;

33 
	m∆ök
;

34 
uöt
 
	msize
;

35 
uöt
 
	maddrs
[
NDIRECT
+1];

39 
	#IPB
 (
BSIZE
 / (
döode
))

	)

42 
	#IBLOCK
(
i
, 
sb
Ë((iË/ 
IPB
 + sb.
öode°¨t
)

	)

45 
	#BPB
 (
BSIZE
*8)

	)

48 
	#BBLOCK
(
b
, 
sb
Ë(b/
BPB
 + sb.
bm≠°¨t
)

	)

51 
	#DIRSIZ
 14

	)

53 
	sdúít
 {

54 
ush‹t
 
	möum
;

55 
	m«me
[
DIRSIZ
];

	@grep.c

3 
	~"ty≥s.h
"

4 
	~"°©.h
"

5 
	~"u£r.h
"

7 
	gbuf
[1024];

8 
m©ch
(*, *);

11 
	$gªp
(*
∑âîn
, 
fd
)

13 
n
, 
m
;

14 *
p
, *
q
;

16 
m
 = 0;

17 (
n
 = 
	`ªad
(
fd
, 
buf
+
m
, (buf)-m-1)) > 0){

18 
m
 +
n
;

19 
buf
[
m
] = '\0';

20 
p
 = 
buf
;

21 (
q
 = 
	`°rchr
(
p
, '\n')) != 0){

22 *
q
 = 0;

23 if(
	`m©ch
(
∑âîn
, 
p
)){

24 *
q
 = '\n';

25 
	`wrôe
(1, 
p
, 
q
+1 -Ö);

27 
p
 = 
q
+1;

29 if(
p
 =
buf
)

30 
m
 = 0;

31 if(
m
 > 0){

32 
m
 -
p
 - 
buf
;

33 
	`memmove
(
buf
, 
p
, 
m
);

36 
	}
}

39 
	$maö
(
¨gc
, *
¨gv
[])

41 
fd
, 
i
;

42 *
∑âîn
;

44 if(
¨gc
 <= 1){

45 
	`¥ötf
(2, "usage: grepÖattern [file ...]\n");

46 
	`exô
();

48 
∑âîn
 = 
¨gv
[1];

50 if(
¨gc
 <= 2){

51 
	`gªp
(
∑âîn
, 0);

52 
	`exô
();

55 
i
 = 2; i < 
¨gc
; i++){

56 if((
fd
 = 
	`›í
(
¨gv
[
i
], 0)) < 0){

57 
	`¥ötf
(1, "gªp: c™nŸ o≥¿%s\n", 
¨gv
[
i
]);

58 
	`exô
();

60 
	`gªp
(
∑âîn
, 
fd
);

61 
	`˛o£
(
fd
);

63 
	`exô
();

64 
	}
}

69 
m©chhîe
(*, *);

70 
m©ch°¨
(, *, *);

73 
	$m©ch
(*
ª
, *
ãxt
)

75 if(
ª
[0] == '^')

76  
	`m©chhîe
(
ª
+1, 
ãxt
);

78 if(
	`m©chhîe
(
ª
, 
ãxt
))

80 }*
ãxt
++ != '\0');

82 
	}
}

85 
	$m©chhîe
(*
ª
, *
ãxt
)

87 if(
ª
[0] == '\0')

89 if(
ª
[1] == '*')

90  
	`m©ch°¨
(
ª
[0],Ñe+2, 
ãxt
);

91 if(
ª
[0] == '$' &&Ñe[1] == '\0')

92  *
ãxt
 == '\0';

93 if(*
ãxt
!='\0' && (
ª
[0]=='.' ||Ñe[0]==*text))

94  
	`m©chhîe
(
ª
+1, 
ãxt
+1);

96 
	}
}

99 
	$m©ch°¨
(
c
, *
ª
, *
ãxt
)

102 if(
	`m©chhîe
(
ª
, 
ãxt
))

104 }*
ãxt
!='\0' && (*ãxt++==
c
 || c=='.'));

106 
	}
}

	@ide.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"memœyout.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

9 
	~"x86.h
"

10 
	~"å≠s.h
"

11 
	~"•ölock.h
"

12 
	~"¶ì∂ock.h
"

13 
	~"fs.h
"

14 
	~"buf.h
"

16 
	#SECTOR_SIZE
 512

	)

17 
	#IDE_BSY
 0x80

	)

18 
	#IDE_DRDY
 0x40

	)

19 
	#IDE_DF
 0x20

	)

20 
	#IDE_ERR
 0x01

	)

22 
	#IDE_CMD_READ
 0x20

	)

23 
	#IDE_CMD_WRITE
 0x30

	)

24 
	#IDE_CMD_RDMUL
 0xc4

	)

25 
	#IDE_CMD_WRMUL
 0xc5

	)

31 
•ölock
 
	gidñock
;

32 
buf
 *
	gidequeue
;

34 
	ghavedisk1
;

35 
ide°¨t
(
buf
*);

39 
	$idewaô
(
checkîr
)

41 
r
;

43 ((
r
 = 
	`öb
(0x1f7)Ë& (
IDE_BSY
|
IDE_DRDY
)) != IDE_DRDY)

45 if(
checkîr
 && (
r
 & (
IDE_DF
|
IDE_ERR
)) != 0)

48 
	}
}

51 
	$ideöô
()

53 
i
;

55 
	`öôlock
(&
idñock
, "ide");

56 
	`iﬂpi˚«bÀ
(
IRQ_IDE
, 
n˝u
 - 1);

57 
	`idewaô
(0);

60 
	`outb
(0x1f6, 0xe0 | (1<<4));

61 
i
=0; i<1000; i++){

62 if(
	`öb
(0x1f7) != 0){

63 
havedisk1
 = 1;

69 
	`outb
(0x1f6, 0xe0 | (0<<4));

70 
	}
}

74 
	$ide°¨t
(
buf
 *
b
)

76 if(
b
 == 0)

77 
	`∑nic
("idestart");

78 if(
b
->
blockno
 >
FSSIZE
)

79 
	`∑nic
("incorrect blockno");

80 
£˘‹_≥r_block
 = 
BSIZE
/
SECTOR_SIZE
;

81 
£˘‹
 = 
b
->
blockno
 * 
£˘‹_≥r_block
;

82 
ªad_cmd
 = (
£˘‹_≥r_block
 =1Ë? 
IDE_CMD_READ
 : 
IDE_CMD_RDMUL
;

83 
wrôe_cmd
 = (
£˘‹_≥r_block
 =1Ë? 
IDE_CMD_WRITE
 : 
IDE_CMD_WRMUL
;

85 i‡(
£˘‹_≥r_block
 > 7Ë
	`∑nic
("idestart");

87 
	`idewaô
(0);

88 
	`outb
(0x3f6, 0);

89 
	`outb
(0x1f2, 
£˘‹_≥r_block
);

90 
	`outb
(0x1f3, 
£˘‹
 & 0xff);

91 
	`outb
(0x1f4, (
£˘‹
 >> 8) & 0xff);

92 
	`outb
(0x1f5, (
£˘‹
 >> 16) & 0xff);

93 
	`outb
(0x1f6, 0xe0 | ((
b
->
dev
&1)<<4Ë| ((
£˘‹
>>24)&0x0f));

94 if(
b
->
Êags
 & 
B_DIRTY
){

95 
	`outb
(0x1f7, 
wrôe_cmd
);

96 
	`out¶
(0x1f0, 
b
->
d©a
, 
BSIZE
/4);

98 
	`outb
(0x1f7, 
ªad_cmd
);

100 
	}
}

104 
	$ideöå
()

106 
buf
 *
b
;

109 
	`acquúe
(&
idñock
);

111 if((
b
 = 
idequeue
) == 0){

112 
	`ªÀa£
(&
idñock
);

115 
idequeue
 = 
b
->
q√xt
;

118 if(!(
b
->
Êags
 & 
B_DIRTY
Ë&& 
	`idewaô
(1) >= 0)

119 
	`ö¶
(0x1f0, 
b
->
d©a
, 
BSIZE
/4);

122 
b
->
Êags
 |
B_VALID
;

123 
b
->
Êags
 &~
B_DIRTY
;

124 
	`wakeup
(
b
);

127 if(
idequeue
 != 0)

128 
	`ide°¨t
(
idequeue
);

130 
	`ªÀa£
(&
idñock
);

131 
	}
}

138 
	$idîw
(
buf
 *
b
)

140 
buf
 **
µ
;

142 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

143 
	`∑nic
("iderw: bufÇotÜocked");

144 if((
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) == B_VALID)

145 
	`∑nic
("iderw:ÇothingÅo do");

146 if(
b
->
dev
 !0 && !
havedisk1
)

147 
	`∑nic
("iderw: ide disk 1ÇotÖresent");

149 
	`acquúe
(&
idñock
);

152 
b
->
q√xt
 = 0;

153 
µ
=&
idequeue
; *µ;Öp=&(*µ)->
q√xt
)

155 *
µ
 = 
b
;

158 if(
idequeue
 =
b
)

159 
	`ide°¨t
(
b
);

162 (
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) != B_VALID){

163 
	`¶ìp
(
b
, &
idñock
);

167 
	`ªÀa£
(&
idñock
);

168 
	}
}

	@init.c

3 
	~"ty≥s.h
"

4 
	~"°©.h
"

5 
	~"u£r.h
"

6 
	~"f˙é.h
"

8 *
	g¨gv
[] = { "sh", 0 };

11 
	$maö
()

13 
pid
, 
wpid
;

15 if(
	`›í
("c⁄sﬁe", 
O_RDWR
) < 0){

16 
	`mknod
("console", 1, 1);

17 
	`›í
("c⁄sﬁe", 
O_RDWR
);

19 
	`dup
(0);

20 
	`dup
(0);

23 
	`¥ötf
(1, "init: starting sh\n");

24 
pid
 = 
	`f‹k
();

25 if(
pid
 < 0){

26 
	`¥ötf
(1, "init: fork failed\n");

27 
	`exô
();

29 if(
pid
 == 0){

30 
	`exec
("sh", 
¨gv
);

31 
	`¥ötf
(1, "init:Éxec sh failed\n");

32 
	`exô
();

34 (
wpid
=
	`waô
()Ë>0 && wpid !
pid
)

35 
	`¥ötf
(1, "zombie!\n");

37 
	}
}

	@initcode.S

1 #Inôü»
¥o˚ss
 
execs
 /
öô
.

2 #Thi†
code
 
runs
 
ö
 
u£r
 
•a˚
.

4 
	~"sysˇŒ.h
"

5 
	~"å≠s.h
"

8 #exec(
öô
, 
¨gv
)

9 .
globl
 
°¨t


10 
	g°¨t
:

11 
pushl
 
$¨gv


12 
pushl
 
$öô


13 
pushl
 
$0


14 
movl
 
$SYS_exec
, %
óx


15 
	g$T_SYSCALL


17 #f‹(;;Ë
exô
();

18 
	gexô
:

19 
movl
 
$SYS_exô
, %
óx


20 
$T_SYSCALL


21 
jmp
 
	gexô


23 #ch¨ 
öô
[] = "/init\0";

24 
	göô
:

25 .
°rög
 "/init\0"

27 #ch¨ *
¨gv
[] = { 
öô
, 0 };

28 .
	gp2Æign
 2

29 
	g¨gv
:

30 .
öô


	@ioapic.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"å≠s.h
"

9 
	#IOAPIC
 0xFEC00000

10 

	)

11 
	#REG_ID
 0x00

12 
	#REG_VER
 0x01

13 
	#REG_TABLE
 0x10

14 

	)

20 
	#INT_DISABLED
 0x00010000

21 
	#INT_LEVEL
 0x00008000

22 
	#INT_ACTIVELOW
 0x00002000

23 
	#INT_LOGICAL
 0x00000800

24 

	)

25 vﬁ©ûê
iﬂpic
 *
	giﬂpic
;

28 
	siﬂpic
 {

29 
uöt
 
	mªg
;

30 
uöt
 
	m∑d
[3];

31 
uöt
 
	md©a
;

34 
uöt


35 
	$iﬂpi¸ód
(
ªg
)

37 
iﬂpic
->
ªg
 =Ñeg;

38  
iﬂpic
->
d©a
;

39 
	}
}

42 
	$iﬂpicwrôe
(
ªg
, 
uöt
 
d©a
)

44 
iﬂpic
->
ªg
 =Ñeg;

45 
iﬂpic
->
d©a
 = data;

46 
	}
}

49 
	$iﬂpicöô
()

51 
i
, 
id
, 
maxöå
;

53 
iﬂpic
 = (vﬁ©ûêiﬂpic*)
IOAPIC
;

54 
maxöå
 = (
	`iﬂpi¸ód
(
REG_VER
) >> 16) & 0xFF;

55 
id
 = 
	`iﬂpi¸ód
(
REG_ID
) >> 24;

56 if(
id
 !
iﬂpicid
)

57 
	`˝rötf
("ioapicinit: id isn'tÉqualÅo ioapicid;Çotá MP\n");

61 
i
 = 0; i <
maxöå
; i++){

62 
	`iﬂpicwrôe
(
REG_TABLE
+2*
i
, 
INT_DISABLED
 | (
T_IRQ0
 + i));

63 
	`iﬂpicwrôe
(
REG_TABLE
+2*
i
+1, 0);

65 
	}
}

68 
	$iﬂpi˚«bÀ
(
úq
, 
˝unum
)

73 
	`iﬂpicwrôe
(
REG_TABLE
+2*
úq
, 
T_IRQ0
 + irq);

74 
	`iﬂpicwrôe
(
REG_TABLE
+2*
úq
+1, 
˝unum
 << 24);

75 
	}
}

	@kalloc.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"memœyout.h
"

9 
	~"mmu.h
"

10 
	~"•ölock.h
"

12 
‰ìønge
(*
v°¨t
, *
víd
);

13 
íd
[];

16 
	srun
 {

17 
run
 *
	m√xt
;

21 
•ölock
 
	mlock
;

22 
	mu£_lock
;

23 
run
 *
	m‰ìli°
;

24 } 
	gkmem
;

32 
	$köô1
(*
v°¨t
, *
víd
)

34 
	`öôlock
(&
kmem
.
lock
, "kmem");

35 
kmem
.
u£_lock
 = 0;

36 
	`‰ìønge
(
v°¨t
, 
víd
);

37 
	}
}

40 
	$köô2
(*
v°¨t
, *
víd
)

42 
	`‰ìønge
(
v°¨t
, 
víd
);

43 
kmem
.
u£_lock
 = 1;

44 
	}
}

47 
	$‰ìønge
(*
v°¨t
, *
víd
)

49 *
p
;

50 
p
 = (*)
	`PGROUNDUP
((
uöt
)
v°¨t
);

51 ; 
p
 + 
PGSIZE
 <(*)
víd
;Ö += PGSIZE)

52 
	`k‰ì
(
p
);

53 
	}
}

60 
	$k‰ì
(*
v
)

62 
run
 *
r
;

64 if((
uöt
)
v
 % 
PGSIZE
 || v < 
íd
 || 
	`V2P
(vË>
PHYSTOP
)

65 
	`∑nic
("kfree");

68 
	`mem£t
(
v
, 1, 
PGSIZE
);

70 if(
kmem
.
u£_lock
)

71 
	`acquúe
(&
kmem
.
lock
);

72 
r
 = (
run
*)
v
;

73 
r
->
√xt
 = 
kmem
.
‰ìli°
;

74 
kmem
.
‰ìli°
 = 
r
;

75 if(
kmem
.
u£_lock
)

76 
	`ªÀa£
(&
kmem
.
lock
);

77 
	}
}

83 
	$kÆloc
()

85 
run
 *
r
;

87 if(
kmem
.
u£_lock
)

88 
	`acquúe
(&
kmem
.
lock
);

91 
r
 = 
kmem
.
‰ìli°
;

92 if(
r
)

93 
kmem
.
‰ìli°
 = 
r
->
√xt
;

94 if(
kmem
.
u£_lock
)

95 
	`ªÀa£
(&
kmem
.
lock
);

97  (*)
r
;

98 
	}
}

	@kbd.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"defs.h
"

4 
	~"kbd.h
"

7 
	$kbdgëc
()

9 
uöt
 
shi·
;

10 
uch¨
 *
ch¨code
[4] = {

11 
n‹mÆm≠
, 
shi·m≠
, 
˘lm≠
, ctlmap

13 
uöt
 
°
, 
d©a
, 
c
;

15 
°
 = 
	`öb
(
KBSTATP
);

16 if((
°
 & 
KBS_DIB
) == 0)

18 
d©a
 = 
	`öb
(
KBDATAP
);

20 if(
d©a
 == 0xE0){

21 
shi·
 |
E0ESC
;

23 } if(
d©a
 & 0x80){

25 
d©a
 = (
shi·
 & 
E0ESC
 ? data : data & 0x7F);

26 
shi·
 &~(
shi·code
[
d©a
] | 
E0ESC
);

28 } if(
shi·
 & 
E0ESC
){

30 
d©a
 |= 0x80;

31 
shi·
 &~
E0ESC
;

34 
shi·
 |
shi·code
[
d©a
];

35 
shi·
 ^
toggÀcode
[
d©a
];

36 
c
 = 
ch¨code
[
shi·
 & (
CTL
 | 
SHIFT
)][
d©a
];

37 if(
shi·
 & 
CAPSLOCK
){

38 if('a' <
c
 && c <= 'z')

39 
c
 += 'A' - 'a';

40 if('A' <
c
 && c <= 'Z')

41 
c
 += 'a' - 'A';

43  
c
;

44 
	}
}

47 
	$kbdöå
()

49 
	`c⁄sﬁeöå
(
kbdgëc
);

50 
	}
}

	@kbd.h

3 
	#KBSTATP
 0x64

4 
	#KBS_DIB
 0x01

5 
	#KBDATAP
 0x60

6 

	)

7 
	#NO
 0

	)

9 
	#SHIFT
 (1<<0)

	)

10 
	#CTL
 (1<<1)

	)

11 
	#ALT
 (1<<2)

	)

13 
	#CAPSLOCK
 (1<<3)

	)

14 
	#NUMLOCK
 (1<<4)

	)

15 
	#SCROLLLOCK
 (1<<5)

	)

17 
	#E0ESC
 (1<<6)

	)

20 
	#KEY_HOME
 0xE0

	)

21 
	#KEY_END
 0xE1

	)

22 
	#KEY_UP
 0xE2

	)

23 
	#KEY_DN
 0xE3

	)

24 
	#KEY_LF
 0xE4

	)

25 
	#KEY_RT
 0xE5

	)

26 
	#KEY_PGUP
 0xE6

	)

27 
	#KEY_PGDN
 0xE7

	)

28 
	#KEY_INS
 0xE8

	)

29 
	#KEY_DEL
 0xE9

	)

32 
	#C
(
x
Ë(x - '@')

	)

34 
uch¨
 
	gshi·code
[256] =

36 [0x1D] 
CTL
,

37 [0x2A] 
SHIFT
,

38 [0x36] 
SHIFT
,

39 [0x38] 
ALT
,

40 [0x9D] 
CTL
,

41 [0xB8] 
ALT


44 
uch¨
 
	gtoggÀcode
[256] =

46 [0x3A] 
CAPSLOCK
,

47 [0x45] 
NUMLOCK
,

48 [0x46] 
SCROLLLOCK


51 
uch¨
 
	gn‹mÆm≠
[256] =

53 
NO
, 0x1B, '1', '2', '3', '4', '5', '6',

56 'o', 'p', '[', ']', '\n', 
NO
, 'a', 's',

58 '\'', '`', 
NO
, '\\', 'z', 'x', 'c', 'v',

59 'b', 'n', 'm', ',', '.', '/', 
NO
, '*',

60 
NO
, ' ', NO, NO, NO, NO, NO, NO,

61 
NO
, NO, NO, NO, NO, NO, NO, '7',

63 '2', '3', '0', '.', 
NO
, NO, NO, NO,

66 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

67 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

68 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

69 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

70 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


73 
uch¨
 
	gshi·m≠
[256] =

75 
NO
, 033, '!', '@', '#', '$', '%', '^',

78 'O', 'P', '{', '}', '\n', 
NO
, 'A', 'S',

80 '"', '~', 
NO
, '|', 'Z', 'X', 'C', 'V',

81 'B', 'N', 'M', '<', '>', '?', 
NO
, '*',

82 
NO
, ' ', NO, NO, NO, NO, NO, NO,

83 
NO
, NO, NO, NO, NO, NO, NO, '7',

85 '2', '3', '0', '.', 
NO
, NO, NO, NO,

88 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

89 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

90 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

91 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

92 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


95 
uch¨
 
	g˘lm≠
[256] =

97 
NO
, NO, NO, NO, NO, NO, NO, NO,

98 
NO
, NO, NO, NO, NO, NO, NO, NO,

99 
C
('Q'), C('W'), C('E'), C('R'), C('T'), C('Y'), C('U'), C('I'),

100 
C
('O'), C('P'), 
NO
, NO, '\r', NO, C('A'), C('S'),

101 
C
('D'), C('F'), C('G'), C('H'), C('J'), C('K'), C('L'), 
NO
,

102 
NO
, NO, NO, 
C
('\\'), C('Z'), C('X'), C('C'), C('V'),

103 
C
('B'), C('N'), C('M'), 
NO
, NO, C('/'), NO, NO,

105 [0xB5] 
C
('/'),

106 [0xC8] 
KEY_UP
, [0xD0] 
KEY_DN
,

107 [0xC9] 
KEY_PGUP
, [0xD1] 
KEY_PGDN
,

108 [0xCB] 
KEY_LF
, [0xCD] 
KEY_RT
,

109 [0x97] 
KEY_HOME
, [0xCF] 
KEY_END
,

110 [0xD2] 
KEY_INS
, [0xD3] 
KEY_DEL


	@kill.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$maö
(
¨gc
, **
¨gv
)

8 
i
;

10 if(
¨gc
 < 2){

11 
	`¥ötf
(2, "usage: killÖid...\n");

12 
	`exô
();

14 
i
=1; i<
¨gc
; i++)

15 
	`kûl
(
	`©oi
(
¨gv
[
i
]));

16 
	`exô
();

17 
	}
}

	@lapic.c

4 
	~"∑øm.h
"

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"d©e.h
"

8 
	~"memœyout.h
"

9 
	~"å≠s.h
"

10 
	~"mmu.h
"

11 
	~"x86.h
"

14 
	#ID
 (0x0020/4)

15 
	#VER
 (0x0030/4)

16 
	#TPR
 (0x0080/4)

17 
	#EOI
 (0x00B0/4)

18 
	#SVR
 (0x00F0/4)

19 
	#ENABLE
 0x00000100

20 
	#ESR
 (0x0280/4)

21 
	#ICRLO
 (0x0300/4)

22 
	#INIT
 0x00000500

23 
	#STARTUP
 0x00000600

24 
	#DELIVS
 0x00001000

25 
	#ASSERT
 0x00004000

26 
	#DEASSERT
 0x00000000

	)

27 
	#LEVEL
 0x00008000

28 
	#BCAST
 0x00080000

29 
	#BUSY
 0x00001000

	)

30 
	#FIXED
 0x00000000

	)

31 
	#ICRHI
 (0x0310/4)

32 
	#TIMER
 (0x0320/4)

33 
	#X1
 0x0000000B

34 
	#PERIODIC
 0x00020000

35 
	#PCINT
 (0x0340/4)

36 
	#LINT0
 (0x0350/4)

37 
	#LINT1
 (0x0360/4)

38 
	#ERROR
 (0x0370/4)

39 
	#MASKED
 0x00010000

40 
	#TICR
 (0x0380/4)

41 
	#TCCR
 (0x0390/4)

42 
	#TDCR
 (0x03E0/4)

43 

	)

44 vﬁ©ûê
uöt
 *
	gœpic
;

48 
	$œpicw
(
ödex
, 
vÆue
)

50 
œpic
[
ödex
] = 
vÆue
;

51 
œpic
[
ID
];

52 
	}
}

55 
	$œpicöô
()

57 if(!
œpic
)

61 
	`œpicw
(
SVR
, 
ENABLE
 | (
T_IRQ0
 + 
IRQ_SPURIOUS
));

67 
	`œpicw
(
TDCR
, 
X1
);

68 
	`œpicw
(
TIMER
, 
PERIODIC
 | (
T_IRQ0
 + 
IRQ_TIMER
));

69 
	`œpicw
(
TICR
, 10000000);

72 
	`œpicw
(
LINT0
, 
MASKED
);

73 
	`œpicw
(
LINT1
, 
MASKED
);

77 if(((
œpic
[
VER
]>>16) & 0xFF) >= 4)

78 
	`œpicw
(
PCINT
, 
MASKED
);

81 
	`œpicw
(
ERROR
, 
T_IRQ0
 + 
IRQ_ERROR
);

84 
	`œpicw
(
ESR
, 0);

85 
	`œpicw
(
ESR
, 0);

88 
	`œpicw
(
EOI
, 0);

91 
	`œpicw
(
ICRHI
, 0);

92 
	`œpicw
(
ICRLO
, 
BCAST
 | 
INIT
 | 
LEVEL
);

93 
œpic
[
ICRLO
] & 
DELIVS
)

97 
	`œpicw
(
TPR
, 0);

98 
	}
}

101 
	$œpicid
()

103 i‡(!
œpic
)

105  
œpic
[
ID
] >> 24;

106 
	}
}

110 
	$œpi˚oi
()

112 if(
œpic
)

113 
	`œpicw
(
EOI
, 0);

114 
	}
}

119 
	$mi¸odñay
(
us
)

121 
	}
}

123 
	#CMOS_PORT
 0x70

	)

124 
	#CMOS_RETURN
 0x71

	)

129 
	$œpic°¨èp
(
uch¨
 
≠icid
, 
uöt
 
addr
)

131 
i
;

132 
ush‹t
 *
wrv
;

137 
	`outb
(
CMOS_PORT
, 0xF);

138 
	`outb
(
CMOS_PORT
+1, 0x0A);

139 
wrv
 = (
ush‹t
*)
	`P2V
((0x40<<4 | 0x67));

140 
wrv
[0] = 0;

141 
wrv
[1] = 
addr
 >> 4;

145 
	`œpicw
(
ICRHI
, 
≠icid
<<24);

146 
	`œpicw
(
ICRLO
, 
INIT
 | 
LEVEL
 | 
ASSERT
);

147 
	`mi¸odñay
(200);

148 
	`œpicw
(
ICRLO
, 
INIT
 | 
LEVEL
);

149 
	`mi¸odñay
(100);

156 
i
 = 0; i < 2; i++){

157 
	`œpicw
(
ICRHI
, 
≠icid
<<24);

158 
	`œpicw
(
ICRLO
, 
STARTUP
 | (
addr
>>12));

159 
	`mi¸odñay
(200);

161 
	}
}

163 
	#CMOS_STATA
 0x0a

	)

164 
	#CMOS_STATB
 0x0b

	)

165 
	#CMOS_UIP
 (1 << 7)

166 

	)

167 
	#SECS
 0x00

	)

168 
	#MINS
 0x02

	)

169 
	#HOURS
 0x04

	)

170 
	#DAY
 0x07

	)

171 
	#MONTH
 0x08

	)

172 
	#YEAR
 0x09

	)

174 
uöt


175 
	$cmos_ªad
(
uöt
 
ªg
)

177 
	`outb
(
CMOS_PORT
, 
ªg
);

178 
	`mi¸odñay
(200);

180  
	`öb
(
CMOS_RETURN
);

181 
	}
}

184 
	$fûl_πcd©e
(
πcd©e
 *
r
)

186 
r
->
£c⁄d
 = 
	`cmos_ªad
(
SECS
);

187 
r
->
möuã
 = 
	`cmos_ªad
(
MINS
);

188 
r
->
hour
 = 
	`cmos_ªad
(
HOURS
);

189 
r
->
day
 = 
	`cmos_ªad
(
DAY
);

190 
r
->
m⁄th
 = 
	`cmos_ªad
(
MONTH
);

191 
r
->
yór
 = 
	`cmos_ªad
(
YEAR
);

192 
	}
}

196 
	$cmo°ime
(
πcd©e
 *
r
)

198 
πcd©e
 
t1
, 
t2
;

199 
sb
, 
bcd
;

201 
sb
 = 
	`cmos_ªad
(
CMOS_STATB
);

203 
bcd
 = (
sb
 & (1 << 2)) == 0;

207 
	`fûl_πcd©e
(&
t1
);

208 if(
	`cmos_ªad
(
CMOS_STATA
Ë& 
CMOS_UIP
)

210 
	`fûl_πcd©e
(&
t2
);

211 if(
	`memcmp
(&
t1
, &
t2
, (t1)) == 0)

216 if(
bcd
) {

217 
	#CONV
(
x
Ë(
t1
.x = (—1.x >> 4Ë* 10Ë+ (t1.x & 0xf))

	)

218 
	`CONV
(
£c⁄d
);

219 
	`CONV
(
möuã
);

220 
	`CONV
(
hour
 );

221 
	`CONV
(
day
 );

222 
	`CONV
(
m⁄th
 );

223 
	`CONV
(
yór
 );

224 #unde‡
CONV


227 *
r
 = 
t1
;

228 
r
->
yór
 += 2000;

229 
	}
}

	@ln.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$maö
(
¨gc
, *
¨gv
[])

8 if(
¨gc
 != 3){

9 
	`¥ötf
(2, "Usage:Ün oldÇew\n");

10 
	`exô
();

12 if(
	`lök
(
¨gv
[1],árgv[2]) < 0)

13 
	`¥ötf
(2, "lök %†%s: faûed\n", 
¨gv
[1],árgv[2]);

14 
	`exô
();

15 
	}
}

	@log.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"•ölock.h
"

5 
	~"¶ì∂ock.h
"

6 
	~"fs.h
"

7 
	~"buf.h
"

34 
	sloghódî
 {

35 
	mn
;

36 
	mblock
[
LOGSIZE
];

39 
	slog
 {

40 
•ölock
 
	mlock
;

41 
	m°¨t
;

42 
	msize
;

43 
	mout°™dög
;

44 
	mcommôtög
;

45 
	mdev
;

46 
loghódî
 
	mlh
;

48 
log
 
	glog
;

50 
ªcovî_‰om_log
();

51 
commô
();

54 
	$öôlog
(
dev
)

56 i‡((
loghódî
Ë>
BSIZE
)

57 
	`∑nic
("initlog:Åoo bigÜogheader");

59 
su≥rblock
 
sb
;

60 
	`öôlock
(&
log
.
lock
, "log");

61 
	`ªadsb
(
dev
, &
sb
);

62 
log
.
°¨t
 = 
sb
.
log°¨t
;

63 
log
.
size
 = 
sb
.
∆og
;

64 
log
.
dev
 = dev;

65 
	`ªcovî_‰om_log
();

66 
	}
}

70 
	$ö°Æl_å™s
()

72 
èû
;

74 
èû
 = 0;Åaû < 
log
.
lh
.
n
;Åail++) {

75 
buf
 *
lbuf
 = 
	`bªad
(
log
.
dev
,Üog.
°¨t
+
èû
+1);

76 
buf
 *
dbuf
 = 
	`bªad
(
log
.
dev
,Üog.
lh
.
block
[
èû
]);

77 
	`memmove
(
dbuf
->
d©a
, 
lbuf
->d©a, 
BSIZE
);

78 
	`bwrôe
(
dbuf
);

79 
	`bªl£
(
lbuf
);

80 
	`bªl£
(
dbuf
);

82 
	}
}

86 
	$ªad_hód
()

88 
buf
 *bu‡
	`bªad
(
log
.
dev
,Üog.
°¨t
);

89 
loghódî
 *
lh
 = (loghódî *Ë(
buf
->
d©a
);

90 
i
;

91 
log
.
lh
.
n
 =Üh->n;

92 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

93 
log
.
lh
.
block
[
i
] =Üh->block[i];

95 
	`bªl£
(
buf
);

96 
	}
}

102 
	$wrôe_hód
()

104 
buf
 *bu‡
	`bªad
(
log
.
dev
,Üog.
°¨t
);

105 
loghódî
 *
hb
 = (loghódî *Ë(
buf
->
d©a
);

106 
i
;

107 
hb
->
n
 = 
log
.
lh
.n;

108 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

109 
hb
->
block
[
i
] = 
log
.
lh
.block[i];

111 
	`bwrôe
(
buf
);

112 
	`bªl£
(
buf
);

113 
	}
}

116 
	$ªcovî_‰om_log
()

118 
	`ªad_hód
();

119 
	`ö°Æl_å™s
();

120 
log
.
lh
.
n
 = 0;

121 
	`wrôe_hód
();

122 
	}
}

126 
	$begö_›
()

128 
	`acquúe
(&
log
.
lock
);

130 if(
log
.
commôtög
){

131 
	`¶ìp
(&
log
, &log.
lock
);

132 } if(
log
.
lh
.
n
 + (log.
out°™dög
+1)*
MAXOPBLOCKS
 > 
LOGSIZE
){

134 
	`¶ìp
(&
log
, &log.
lock
);

136 
log
.
out°™dög
 += 1;

137 
	`ªÀa£
(&
log
.
lock
);

141 
	}
}

146 
	$íd_›
()

148 
do_commô
 = 0;

150 
	`acquúe
(&
log
.
lock
);

151 
log
.
out°™dög
 -= 1;

152 if(
log
.
commôtög
)

153 
	`∑nic
("log.committing");

154 if(
log
.
out°™dög
 == 0){

155 
do_commô
 = 1;

156 
log
.
commôtög
 = 1;

161 
	`wakeup
(&
log
);

163 
	`ªÀa£
(&
log
.
lock
);

165 if(
do_commô
){

168 
	`commô
();

169 
	`acquúe
(&
log
.
lock
);

170 
log
.
commôtög
 = 0;

171 
	`wakeup
(&
log
);

172 
	`ªÀa£
(&
log
.
lock
);

174 
	}
}

178 
	$wrôe_log
()

180 
èû
;

182 
èû
 = 0;Åaû < 
log
.
lh
.
n
;Åail++) {

183 
buf
 *
to
 = 
	`bªad
(
log
.
dev
,Üog.
°¨t
+
èû
+1);

184 
buf
 *
‰om
 = 
	`bªad
(
log
.
dev
,Üog.
lh
.
block
[
èû
]);

185 
	`memmove
(
to
->
d©a
, 
‰om
->d©a, 
BSIZE
);

186 
	`bwrôe
(
to
);

187 
	`bªl£
(
‰om
);

188 
	`bªl£
(
to
);

190 
	}
}

193 
	$commô
()

195 i‡(
log
.
lh
.
n
 > 0) {

196 
	`wrôe_log
();

197 
	`wrôe_hód
();

198 
	`ö°Æl_å™s
();

199 
log
.
lh
.
n
 = 0;

200 
	`wrôe_hód
();

202 
	}
}

214 
	$log_wrôe
(
buf
 *
b
)

216 
i
;

218 i‡(
log
.
lh
.
n
 >
LOGSIZE
 ||Üog.lh.¿>log.
size
 - 1)

219 
	`∑nic
("too bigáÅransaction");

220 i‡(
log
.
out°™dög
 < 1)

221 
	`∑nic
("log_write outside ofÅrans");

223 
	`acquúe
(&
log
.
lock
);

224 
i
 = 0; i < 
log
.
lh
.
n
; i++) {

225 i‡(
log
.
lh
.
block
[
i
] =
b
->
blockno
)

228 
log
.
lh
.
block
[
i
] = 
b
->
blockno
;

229 i‡(
i
 =
log
.
lh
.
n
)

230 
log
.
lh
.
n
++;

231 
b
->
Êags
 |
B_DIRTY
;

232 
	`ªÀa£
(&
log
.
lock
);

233 
	}
}

	@ls.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

4 
	~"fs.h
"

7 
	$fmäame
(*
∑th
)

9 
buf
[
DIRSIZ
+1];

10 *
p
;

13 
p
=
∑th
+
	`°æí
(path);Ö >=Öath && *p != '/';Ö--)

15 
p
++;

18 if(
	`°æí
(
p
Ë>
DIRSIZ
)

19  
p
;

20 
	`memmove
(
buf
, 
p
, 
	`°æí
(p));

21 
	`mem£t
(
buf
+
	`°æí
(
p
), ' ', 
DIRSIZ
-strlen(p));

22  
buf
;

23 
	}
}

26 
	$ls
(*
∑th
)

28 
buf
[512], *
p
;

29 
fd
;

30 
dúít
 
de
;

31 
°©
 
°
;

33 if((
fd
 = 
	`›í
(
∑th
, 0)) < 0){

34 
	`¥ötf
(2, "ls: c™nŸ o≥¿%s\n", 
∑th
);

38 if(
	`f°©
(
fd
, &
°
) < 0){

39 
	`¥ötf
(2, "ls: c™nŸ sèà%s\n", 
∑th
);

40 
	`˛o£
(
fd
);

44 
°
.
ty≥
){

45 
T_FILE
:

46 
	`¥ötf
(1, "%†%d %d %d\n", 
	`fmäame
(
∑th
), 
°
.
ty≥
, st.
öo
, st.
size
);

49 
T_DIR
:

50 if(
	`°æí
(
∑th
Ë+ 1 + 
DIRSIZ
 + 1 >  
buf
){

51 
	`¥ötf
(1, "ls:ÖathÅooÜong\n");

54 
	`°r˝y
(
buf
, 
∑th
);

55 
p
 = 
buf
+
	`°æí
(buf);

56 *
p
++ = '/';

57 
	`ªad
(
fd
, &
de
, (de)) == (de)){

58 if(
de
.
öum
 == 0)

60 
	`memmove
(
p
, 
de
.
«me
, 
DIRSIZ
);

61 
p
[
DIRSIZ
] = 0;

62 if(
	`°©
(
buf
, &
°
) < 0){

63 
	`¥ötf
(1, "ls: c™nŸ sèà%s\n", 
buf
);

66 
	`¥ötf
(1, "%†%d %d %d\n", 
	`fmäame
(
buf
), 
°
.
ty≥
, st.
öo
, st.
size
);

70 
	`˛o£
(
fd
);

71 
	}
}

74 
	$maö
(
¨gc
, *
¨gv
[])

76 
i
;

78 if(
¨gc
 < 2){

79 
	`ls
(".");

80 
	`exô
();

82 
i
=1; i<
¨gc
; i++)

83 
	`ls
(
¨gv
[
i
]);

84 
	`exô
();

85 
	}
}

	@main.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

9 
°¨tŸhîs
();

10 
	$mpmaö
(Ë
	`__©åibuã__
((
n‹ëu∫
));

11 
pde_t
 *
kpgdú
;

12 
íd
[];

18 
	$maö
()

20 
	`köô1
(
íd
, 
	`P2V
(4*1024*1024));

21 
	`kvmÆloc
();

22 
	`mpöô
();

23 
	`œpicöô
();

24 
	`£göô
();

25 
	`picöô
();

26 
	`iﬂpicöô
();

27 
	`c⁄sﬁeöô
();

28 
	`u¨töô
();

29 
	`pöô
();

30 
	`tvöô
();

31 
	`böô
();

32 
	`fûeöô
();

33 
	`ideöô
();

34 
	`°¨tŸhîs
();

35 
	`köô2
(
	`P2V
(4*1024*1024), P2V(
PHYSTOP
));

36 
	`u£röô
();

37 
	`mpmaö
();

38 
	}
}

42 
	$m≥¡î
()

44 
	`swôchkvm
();

45 
	`£göô
();

46 
	`œpicöô
();

47 
	`mpmaö
();

48 
	}
}

52 
	$mpmaö
()

54 
	`˝rötf
("˝u%d: sèπög %d\n", 
	`˝uid
(), cpuid());

55 
	`idtöô
();

56 
	`xchg
(&(
	`my˝u
()->
°¨ãd
), 1);

57 
	`scheduÀr
();

58 
	}
}

60 
pde_t
 
	gíåypgdú
[];

64 
	$°¨tŸhîs
()

66 
uch¨
 
_bö¨y_íåyŸhî_°¨t
[], 
_bö¨y_íåyŸhî_size
[];

67 
uch¨
 *
code
;

68 
˝u
 *
c
;

69 *
°ack
;

74 
code
 = 
	`P2V
(0x7000);

75 
	`memmove
(
code
, 
_bö¨y_íåyŸhî_°¨t
, (
uöt
)
_bö¨y_íåyŸhî_size
);

77 
c
 = 
˝us
; c < cpus+
n˝u
; c++){

78 if(
c
 =
	`my˝u
())

84 
°ack
 = 
	`kÆloc
();

85 *(**)(
code
-4Ë
°ack
 + 
KSTACKSIZE
;

86 *((**)())(
code
-8Ë
m≥¡î
;

87 *(**)(
code
-12Ë(*Ë
	`V2P
(
íåypgdú
);

89 
	`œpic°¨èp
(
c
->
≠icid
, 
	`V2P
(
code
));

92 
c
->
°¨ãd
 == 0)

95 
	}
}

102 
__©åibuã__
((
	$__Æig√d__
(
PGSIZE
)))

103 
pde_t
 
íåypgdú
[
NPDENTRIES
] = {

105 [0] = (0Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_PS
,

107 [
KERNBASE
>>
PDXSHIFT
] = (0Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_PS
,

108 
	}
};

	@memide.c

4 
	~"ty≥s.h
"

5 
	~"defs.h
"

6 
	~"∑øm.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

9 
	~"x86.h
"

10 
	~"å≠s.h
"

11 
	~"•ölock.h
"

12 
	~"¶ì∂ock.h
"

13 
	~"fs.h
"

14 
	~"buf.h
"

16 
uch¨
 
_bö¨y_fs_img_°¨t
[], 
_bö¨y_fs_img_size
[];

18 
	gdisksize
;

19 
uch¨
 *
	gmemdisk
;

22 
	$ideöô
()

24 
memdisk
 = 
_bö¨y_fs_img_°¨t
;

25 
disksize
 = (
uöt
)
_bö¨y_fs_img_size
/
BSIZE
;

26 
	}
}

30 
	$ideöå
()

33 
	}
}

39 
	$idîw
(
buf
 *
b
)

41 
uch¨
 *
p
;

43 if(!
	`hﬁdög¶ìp
(&
b
->
lock
))

44 
	`∑nic
("iderw: bufÇotÜocked");

45 if((
b
->
Êags
 & (
B_VALID
|
B_DIRTY
)) == B_VALID)

46 
	`∑nic
("iderw:ÇothingÅo do");

47 if(
b
->
dev
 != 1)

48 
	`∑nic
("iderw:ÑequestÇot for disk 1");

49 if(
b
->
blockno
 >
disksize
)

50 
	`∑nic
("iderw: block out ofÑange");

52 
p
 = 
memdisk
 + 
b
->
blockno
*
BSIZE
;

54 if(
b
->
Êags
 & 
B_DIRTY
){

55 
b
->
Êags
 &~
B_DIRTY
;

56 
	`memmove
(
p
, 
b
->
d©a
, 
BSIZE
);

58 
	`memmove
(
b
->
d©a
, 
p
, 
BSIZE
);

59 
b
->
Êags
 |
B_VALID
;

60 
	}
}

	@memlayout.h

3 
	#EXTMEM
 0x100000

4 
	#PHYSTOP
 0xE000000

5 
	#DEVSPACE
 0xFE000000

6 

	)

8 
	#KERNBASE
 0x80000000

9 
	#KERNLINK
 (
KERNBASE
+
EXTMEM
)

10 

	)

11 
	#V2P
(
a
Ë(((
uöt
Ë◊)Ë- 
KERNBASE
)

	)

12 
	#P2V
(
a
Ë((*)(((*Ë◊)Ë+ 
KERNBASE
))

	)

14 
	#V2P_WO
(
x
Ë((xË- 
KERNBASE
)

15 
	#P2V_WO
(
x
Ë((xË+ 
KERNBASE
)

	@mkdir.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$maö
(
¨gc
, *
¨gv
[])

8 
i
;

10 if(
¨gc
 < 2){

11 
	`¥ötf
(2, "Usage: mkdir files...\n");

12 
	`exô
();

15 
i
 = 1; i < 
¨gc
; i++){

16 if(
	`mkdú
(
¨gv
[
i
]) < 0){

17 
	`¥ötf
(2, "mkdú: %†ÁûedÅÿ¸óã\n", 
¨gv
[
i
]);

22 
	`exô
();

23 
	}
}

	@mkfs.c

1 
	~<°dio.h
>

2 
	~<uni°d.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<f˙é.h
>

6 
	~<as£π.h
>

8 
	#°©
 
xv6_°©


9 
	~"ty≥s.h
"

	)

10 
	~"fs.h
"

11 
	~"°©.h
"

12 
	~"∑øm.h
"

14 #i‚de‡
°©ic_as£π


15 
	#°©ic_as£π
(
a
, 
b
Ëdÿ{ 0Ë0: ◊): ; } 0)

	)

18 
	#NINODES
 200

	)

23 
	gnbôm≠
 = 
FSSIZE
/(
BSIZE
*8) + 1;

24 
	gnöodeblocks
 = 
NINODES
 / 
IPB
 + 1;

25 
	g∆og
 = 
LOGSIZE
;

26 
	gnmëa
;

27 
	gnblocks
;

29 
	gfsfd
;

30 
su≥rblock
 
	gsb
;

31 
	gzî€s
[
BSIZE
];

32 
uöt
 
	g‰ìöode
 = 1;

33 
uöt
 
	g‰ìblock
;

36 
bÆloc
();

37 
w£˘
(
uöt
, *);

38 
wöode
(
uöt
, 
döode
*);

39 
röode
(
uöt
 
öum
, 
döode
 *
ù
);

40 
r£˘
(
uöt
 
£c
, *
buf
);

41 
uöt
 
üŒoc
(
ush‹t
 
ty≥
);

42 
üµíd
(
uöt
 
öum
, *
p
, 
n
);

45 
ush‹t


46 
	$xsh‹t
(
ush‹t
 
x
)

48 
ush‹t
 
y
;

49 
uch¨
 *
a
 = (uch¨*)&
y
;

50 
a
[0] = 
x
;

51 
a
[1] = 
x
 >> 8;

52  
y
;

53 
	}
}

55 
uöt


56 
	$xöt
(
uöt
 
x
)

58 
uöt
 
y
;

59 
uch¨
 *
a
 = (uch¨*)&
y
;

60 
a
[0] = 
x
;

61 
a
[1] = 
x
 >> 8;

62 
a
[2] = 
x
 >> 16;

63 
a
[3] = 
x
 >> 24;

64  
y
;

65 
	}
}

68 
	$maö
(
¨gc
, *
¨gv
[])

70 
i
, 
cc
, 
fd
;

71 
uöt
 
roŸöo
, 
öum
, 
off
;

72 
dúít
 
de
;

73 
buf
[
BSIZE
];

74 
döode
 
dö
;

77 
	`°©ic_as£π
(() == 4, "Integers must be 4 bytes!");

79 if(
¨gc
 < 2){

80 
	`Ârötf
(
°dîr
, "Usage: mkfs fs.img files...\n");

81 
	`exô
(1);

84 
	`as£π
((
BSIZE
 % (
döode
)) == 0);

85 
	`as£π
((
BSIZE
 % (
dúít
)) == 0);

87 
fsfd
 = 
	`›í
(
¨gv
[1], 
O_RDWR
|
O_CREAT
|
O_TRUNC
, 0666);

88 if(
fsfd
 < 0){

89 
	`≥º‹
(
¨gv
[1]);

90 
	`exô
(1);

94 
nmëa
 = 2 + 
∆og
 + 
nöodeblocks
 + 
nbôm≠
;

95 
nblocks
 = 
FSSIZE
 - 
nmëa
;

97 
sb
.
size
 = 
	`xöt
(
FSSIZE
);

98 
sb
.
nblocks
 = 
	`xöt
(nblocks);

99 
sb
.
nöodes
 = 
	`xöt
(
NINODES
);

100 
sb
.
∆og
 = 
	`xöt
(nlog);

101 
sb
.
log°¨t
 = 
	`xöt
(2);

102 
sb
.
öode°¨t
 = 
	`xöt
(2+
∆og
);

103 
sb
.
bm≠°¨t
 = 
	`xöt
(2+
∆og
+
nöodeblocks
);

105 
	`¥ötf
("nmeta %d (boot, super,Üog blocks %u inode blocks %u, bitmap blocks %u) blocks %dÅotal %d\n",

106 
nmëa
, 
∆og
, 
nöodeblocks
, 
nbôm≠
, 
nblocks
, 
FSSIZE
);

108 
‰ìblock
 = 
nmëa
;

110 
i
 = 0; i < 
FSSIZE
; i++)

111 
	`w£˘
(
i
, 
zî€s
);

113 
	`mem£t
(
buf
, 0, (buf));

114 
	`memmove
(
buf
, &
sb
, (sb));

115 
	`w£˘
(1, 
buf
);

117 
roŸöo
 = 
	`üŒoc
(
T_DIR
);

118 
	`as£π
(
roŸöo
 =
ROOTINO
);

120 
	`bzîo
(&
de
, (de));

121 
de
.
öum
 = 
	`xsh‹t
(
roŸöo
);

122 
	`°r˝y
(
de
.
«me
, ".");

123 
	`üµíd
(
roŸöo
, &
de
, (de));

125 
	`bzîo
(&
de
, (de));

126 
de
.
öum
 = 
	`xsh‹t
(
roŸöo
);

127 
	`°r˝y
(
de
.
«me
, "..");

128 
	`üµíd
(
roŸöo
, &
de
, (de));

130 
i
 = 2; i < 
¨gc
; i++){

131 
	`as£π
(
	`ödex
(
¨gv
[
i
], '/') == 0);

133 if((
fd
 = 
	`›í
(
¨gv
[
i
], 0)) < 0){

134 
	`≥º‹
(
¨gv
[
i
]);

135 
	`exô
(1);

142 if(
¨gv
[
i
][0] == '_')

143 ++
¨gv
[
i
];

145 
öum
 = 
	`üŒoc
(
T_FILE
);

147 
	`bzîo
(&
de
, (de));

148 
de
.
öum
 = 
	`xsh‹t
(inum);

149 
	`°∫˝y
(
de
.
«me
, 
¨gv
[
i
], 
DIRSIZ
);

150 
	`üµíd
(
roŸöo
, &
de
, (de));

152 (
cc
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0)

153 
	`üµíd
(
öum
, 
buf
, 
cc
);

155 
	`˛o£
(
fd
);

159 
	`röode
(
roŸöo
, &
dö
);

160 
off
 = 
	`xöt
(
dö
.
size
);

161 
off
 = ((off/
BSIZE
) + 1) * BSIZE;

162 
dö
.
size
 = 
	`xöt
(
off
);

163 
	`wöode
(
roŸöo
, &
dö
);

165 
	`bÆloc
(
‰ìblock
);

167 
	`exô
(0);

168 
	}
}

171 
	$w£˘
(
uöt
 
£c
, *
buf
)

173 if(
	`l£ek
(
fsfd
, 
£c
 * 
BSIZE
, 0) != sec * BSIZE){

174 
	`≥º‹
("lseek");

175 
	`exô
(1);

177 if(
	`wrôe
(
fsfd
, 
buf
, 
BSIZE
) != BSIZE){

178 
	`≥º‹
("write");

179 
	`exô
(1);

181 
	}
}

184 
	$wöode
(
uöt
 
öum
, 
döode
 *
ù
)

186 
buf
[
BSIZE
];

187 
uöt
 
bn
;

188 
döode
 *
dù
;

190 
bn
 = 
	`IBLOCK
(
öum
, 
sb
);

191 
	`r£˘
(
bn
, 
buf
);

192 
dù
 = ((
döode
*)
buf
Ë+ (
öum
 % 
IPB
);

193 *
dù
 = *
ù
;

194 
	`w£˘
(
bn
, 
buf
);

195 
	}
}

198 
	$röode
(
uöt
 
öum
, 
döode
 *
ù
)

200 
buf
[
BSIZE
];

201 
uöt
 
bn
;

202 
döode
 *
dù
;

204 
bn
 = 
	`IBLOCK
(
öum
, 
sb
);

205 
	`r£˘
(
bn
, 
buf
);

206 
dù
 = ((
döode
*)
buf
Ë+ (
öum
 % 
IPB
);

207 *
ù
 = *
dù
;

208 
	}
}

211 
	$r£˘
(
uöt
 
£c
, *
buf
)

213 if(
	`l£ek
(
fsfd
, 
£c
 * 
BSIZE
, 0) != sec * BSIZE){

214 
	`≥º‹
("lseek");

215 
	`exô
(1);

217 if(
	`ªad
(
fsfd
, 
buf
, 
BSIZE
) != BSIZE){

218 
	`≥º‹
("read");

219 
	`exô
(1);

221 
	}
}

223 
uöt


224 
	$üŒoc
(
ush‹t
 
ty≥
)

226 
uöt
 
öum
 = 
‰ìöode
++;

227 
döode
 
dö
;

229 
	`bzîo
(&
dö
, (din));

230 
dö
.
ty≥
 = 
	`xsh‹t
(type);

231 
dö
.
∆ök
 = 
	`xsh‹t
(1);

232 
dö
.
size
 = 
	`xöt
(0);

233 
	`wöode
(
öum
, &
dö
);

234  
öum
;

235 
	}
}

238 
	$bÆloc
(
u£d
)

240 
uch¨
 
buf
[
BSIZE
];

241 
i
;

243 
	`¥ötf
("bÆloc: fú° %d block†havêbì¿Æloˇãd\n", 
u£d
);

244 
	`as£π
(
u£d
 < 
BSIZE
*8);

245 
	`bzîo
(
buf
, 
BSIZE
);

246 
i
 = 0; i < 
u£d
; i++){

247 
buf
[
i
/8] = buf[i/8] | (0x1 << (i%8));

249 
	`¥ötf
("bÆloc: wrôêbôm≠ blockáà£˘‹ %d\n", 
sb
.
bm≠°¨t
);

250 
	`w£˘
(
sb
.
bm≠°¨t
, 
buf
);

251 
	}
}

253 
	#mö
(
a
, 
b
Ë(◊Ë< (bË? (aË: (b))

	)

256 
	$üµíd
(
uöt
 
öum
, *
xp
, 
n
)

258 *
p
 = (*)
xp
;

259 
uöt
 
fbn
, 
off
, 
n1
;

260 
döode
 
dö
;

261 
buf
[
BSIZE
];

262 
uöt
 
ödúe˘
[
NINDIRECT
];

263 
uöt
 
x
;

265 
	`röode
(
öum
, &
dö
);

266 
off
 = 
	`xöt
(
dö
.
size
);

268 
n
 > 0){

269 
fbn
 = 
off
 / 
BSIZE
;

270 
	`as£π
(
fbn
 < 
MAXFILE
);

271 if(
fbn
 < 
NDIRECT
){

272 if(
	`xöt
(
dö
.
addrs
[
fbn
]) == 0){

273 
dö
.
addrs
[
fbn
] = 
	`xöt
(
‰ìblock
++);

275 
x
 = 
	`xöt
(
dö
.
addrs
[
fbn
]);

277 if(
	`xöt
(
dö
.
addrs
[
NDIRECT
]) == 0){

278 
dö
.
addrs
[
NDIRECT
] = 
	`xöt
(
‰ìblock
++);

280 
	`r£˘
(
	`xöt
(
dö
.
addrs
[
NDIRECT
]), (*)
ödúe˘
);

281 if(
ödúe˘
[
fbn
 - 
NDIRECT
] == 0){

282 
ödúe˘
[
fbn
 - 
NDIRECT
] = 
	`xöt
(
‰ìblock
++);

283 
	`w£˘
(
	`xöt
(
dö
.
addrs
[
NDIRECT
]), (*)
ödúe˘
);

285 
x
 = 
	`xöt
(
ödúe˘
[
fbn
-
NDIRECT
]);

287 
n1
 = 
	`mö
(
n
, (
fbn
 + 1Ë* 
BSIZE
 - 
off
);

288 
	`r£˘
(
x
, 
buf
);

289 
	`bc›y
(
p
, 
buf
 + 
off
 - (
fbn
 * 
BSIZE
), 
n1
);

290 
	`w£˘
(
x
, 
buf
);

291 
n
 -
n1
;

292 
off
 +
n1
;

293 
p
 +
n1
;

295 
dö
.
size
 = 
	`xöt
(
off
);

296 
	`wöode
(
öum
, &
dö
);

297 
	}
}

	@mmu.h

5 
	#FL_IF
 0x00000200

6 

	)

8 
	#CR0_PE
 0x00000001

9 
	#CR0_WP
 0x00010000

10 
	#CR0_PG
 0x80000000

11 

	)

12 
	#CR4_PSE
 0x00000010

13 

	)

15 
	#SEG_KCODE
 1

16 
	#SEG_KDATA
 2

17 
	#SEG_UCODE
 3

18 
	#SEG_UDATA
 4

19 
	#SEG_TSS
 5

20 

	)

22 
	#NSEGS
 6

	)

24 #i‚de‡
__ASSEMBLER__


26 
	s£gdesc
 {

27 
uöt
 
	mlim_15_0
 : 16;

28 
uöt
 
	mba£_15_0
 : 16;

29 
uöt
 
	mba£_23_16
 : 8;

30 
uöt
 
	mty≥
 : 4;

31 
uöt
 
	ms
 : 1;

32 
uöt
 
	md∂
 : 2;

33 
uöt
 
	mp
 : 1;

34 
uöt
 
	mlim_19_16
 : 4;

35 
uöt
 
	mavl
 : 1;

36 
uöt
 
	mrsv1
 : 1;

37 
uöt
 
	mdb
 : 1;

38 
uöt
 
	mg
 : 1;

39 
uöt
 
	mba£_31_24
 : 8;

43 
	#SEG
(
ty≥
, 
ba£
, 
lim
, 
d∂
Ë(
£gdesc
) \

44 { ((
lim
Ë>> 12Ë& 0xffff, (
uöt
)(
ba£
) & 0xffff, \

45 ((
uöt
)(
ba£
Ë>> 16Ë& 0xff, 
ty≥
, 1, 
d∂
, 1, \

46 (
uöt
)(
lim
Ë>> 28, 0, 0, 1, 1, (uöt)(
ba£
Ë>> 24 }

	)

47 
	#SEG16
(
ty≥
, 
ba£
, 
lim
, 
d∂
Ë(
£gdesc
) \

48 { (
lim
Ë& 0xffff, (
uöt
)(
ba£
) & 0xffff, \

49 ((
uöt
)(
ba£
Ë>> 16Ë& 0xff, 
ty≥
, 1, 
d∂
, 1, \

50 (
uöt
)(
lim
Ë>> 16, 0, 0, 1, 0, (uöt)(
ba£
Ë>> 24 }

	)

53 
	#DPL_USER
 0x3

54 

	)

56 
	#STA_X
 0x8

57 
	#STA_W
 0x2

58 
	#STA_R
 0x2

59 

	)

61 
	#STS_T32A
 0x9

62 
	#STS_IG32
 0xE

63 
	#STS_TG32
 0xF

64 

	)

74 
	#PDX
(
va
Ë(((
uöt
)(vaË>> 
PDXSHIFT
Ë& 0x3FF)

	)

77 
	#PTX
(
va
Ë(((
uöt
)(vaË>> 
PTXSHIFT
Ë& 0x3FF)

	)

80 
	#PGADDR
(
d
, 
t
, 
o
Ë((
uöt
)((dË<< 
PDXSHIFT
 | (tË<< 
PTXSHIFT
 | (o)))

	)

83 
	#NPDENTRIES
 1024

84 
	#NPTENTRIES
 1024

85 
	#PGSIZE
 4096

86 

	)

87 
	#PTXSHIFT
 12

88 
	#PDXSHIFT
 22

89 

	)

90 
	#PGROUNDUP
(
sz
Ë(((sz)+
PGSIZE
-1Ë& ~(PGSIZE-1))

	)

91 
	#PGROUNDDOWN
(
a
Ë((◊)Ë& ~(
PGSIZE
-1))

	)

94 
	#PTE_P
 0x001

95 
	#PTE_W
 0x002

96 
	#PTE_U
 0x004

97 
	#PTE_PS
 0x080

98 

	)

100 
	#PTE_ADDR
(
±e
Ë((
uöt
)’ãË& ~0xFFF)

	)

101 
	#PTE_FLAGS
(
±e
Ë((
uöt
)’ãË& 0xFFF)

	)

103 #i‚de‡
__ASSEMBLER__


104 
uöt
 
	t±e_t
;

107 
	sèsk°©e
 {

108 
uöt
 
	mlök
;

109 
uöt
 
	me•0
;

110 
ush‹t
 
	mss0
;

111 
ush‹t
 
	m∑ddög1
;

112 
uöt
 *
	me•1
;

113 
ush‹t
 
	mss1
;

114 
ush‹t
 
	m∑ddög2
;

115 
uöt
 *
	me•2
;

116 
ush‹t
 
	mss2
;

117 
ush‹t
 
	m∑ddög3
;

118 *
	m¸3
;

119 
uöt
 *
	meù
;

120 
uöt
 
	meÊags
;

121 
uöt
 
	móx
;

122 
uöt
 
	mecx
;

123 
uöt
 
	medx
;

124 
uöt
 
	mebx
;

125 
uöt
 *
	me•
;

126 
uöt
 *
	mebp
;

127 
uöt
 
	mesi
;

128 
uöt
 
	medi
;

129 
ush‹t
 
	mes
;

130 
ush‹t
 
	m∑ddög4
;

131 
ush‹t
 
	mcs
;

132 
ush‹t
 
	m∑ddög5
;

133 
ush‹t
 
	mss
;

134 
ush‹t
 
	m∑ddög6
;

135 
ush‹t
 
	mds
;

136 
ush‹t
 
	m∑ddög7
;

137 
ush‹t
 
	mfs
;

138 
ush‹t
 
	m∑ddög8
;

139 
ush‹t
 
	mgs
;

140 
ush‹t
 
	m∑ddög9
;

141 
ush‹t
 
	mldt
;

142 
ush‹t
 
	m∑ddög10
;

143 
ush‹t
 
	mt
;

144 
ush‹t
 
	miomb
;

148 
	sg©edesc
 {

149 
uöt
 
	moff_15_0
 : 16;

150 
uöt
 
	mcs
 : 16;

151 
uöt
 
	m¨gs
 : 5;

152 
uöt
 
	mrsv1
 : 3;

153 
uöt
 
	mty≥
 : 4;

154 
uöt
 
	ms
 : 1;

155 
uöt
 
	md∂
 : 2;

156 
uöt
 
	mp
 : 1;

157 
uöt
 
	moff_31_16
 : 16;

168 
	#SETGATE
(
g©e
, 
i°øp
, 
£l
, 
off
, 
d
) \

170 (
g©e
).
off_15_0
 = (
uöt
)(
off
) & 0xffff; \

171 (
g©e
).
cs
 = (
£l
); \

172 (
g©e
).
¨gs
 = 0; \

173 (
g©e
).
rsv1
 = 0; \

174 (
g©e
).
ty≥
 = (
i°øp
Ë? 
STS_TG32
 : 
STS_IG32
; \

175 (
g©e
).
s
 = 0; \

176 (
g©e
).
d∂
 = (
d
); \

177 (
g©e
).
p
 = 1; \

178 (
g©e
).
off_31_16
 = (
uöt
)(
off
) >> 16; \

179 }

	)

	@mp.c

5 
	~"ty≥s.h
"

6 
	~"defs.h
"

7 
	~"∑øm.h
"

8 
	~"memœyout.h
"

9 
	~"mp.h
"

10 
	~"x86.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

14 
˝u
 
	g˝us
[
NCPU
];

15 
	gn˝u
;

16 
uch¨
 
	giﬂpicid
;

18 
uch¨


19 
	$sum
(
uch¨
 *
addr
, 
Àn
)

21 
i
, 
sum
;

23 
sum
 = 0;

24 
i
=0; i<
Àn
; i++)

25 
sum
 +
addr
[
i
];

26  
sum
;

27 
	}
}

30 
mp
*

31 
	$mp£¨ch1
(
uöt
 
a
, 
Àn
)

33 
uch¨
 *
e
, *
p
, *
addr
;

35 
addr
 = 
	`P2V
(
a
);

36 
e
 = 
addr
+
Àn
;

37 
p
 = 
addr
;Ö < 
e
;Ö +(
mp
))

38 if(
	`memcmp
(
p
, "_MP_", 4Ë=0 && 
	`sum
’, (
mp
)) == 0)

39  (
mp
*)
p
;

41 
	}
}

48 
mp
*

49 
	$mp£¨ch
()

51 
uch¨
 *
bda
;

52 
uöt
 
p
;

53 
mp
 *mp;

55 
bda
 = (
uch¨
 *Ë
	`P2V
(0x400);

56 if((
p
 = ((
bda
[0x0F]<<8)| bda[0x0E]) << 4)){

57 if((
mp
 = 
	`mp£¨ch1
(
p
, 1024)))

58  
mp
;

60 
p
 = ((
bda
[0x14]<<8)|bda[0x13])*1024;

61 if((
mp
 = 
	`mp£¨ch1
(
p
-1024, 1024)))

62  
mp
;

64  
	`mp£¨ch1
(0xF0000, 0x10000);

65 
	}
}

72 
mpc⁄f
*

73 
	$mpc⁄fig
(
mp
 **
pmp
)

75 
mpc⁄f
 *
c⁄f
;

76 
mp
 *mp;

78 if((
mp
 = 
	`mp£¨ch
()Ë=0 || mp->
phyßddr
 == 0)

80 
c⁄f
 = (
mpc⁄f
*Ë
	`P2V
((
uöt
Ë
mp
->
phyßddr
);

81 if(
	`memcmp
(
c⁄f
, "PCMP", 4) != 0)

83 if(
c⁄f
->
vîsi⁄
 != 1 && conf->version != 4)

85 if(
	`sum
((
uch¨
*)
c⁄f
, c⁄f->
Àngth
) != 0)

87 *
pmp
 = 
mp
;

88  
c⁄f
;

89 
	}
}

92 
	$mpöô
()

94 
uch¨
 *
p
, *
e
;

95 
ismp
;

96 
mp
 *mp;

97 
mpc⁄f
 *
c⁄f
;

98 
mµroc
 *
¥oc
;

99 
mpiﬂpic
 *
iﬂpic
;

101 if((
c⁄f
 = 
	`mpc⁄fig
(&
mp
)) == 0)

102 
	`∑nic
("ExpectÅoÑun onán SMP");

103 
ismp
 = 1;

104 
œpic
 = (
uöt
*)
c⁄f
->
œpiˇddr
;

105 
p
=(
uch¨
*)(
c⁄f
+1), 
e
=(uch¨*)c⁄f+c⁄f->
Àngth
;Ö<e; ){

106 *
p
){

107 
MPPROC
:

108 
¥oc
 = (
mµroc
*)
p
;

109 if(
n˝u
 < 
NCPU
) {

110 
˝us
[
n˝u
].
≠icid
 = 
¥oc
->apicid;

111 
n˝u
++;

113 
p
 +(
mµroc
);

115 
MPIOAPIC
:

116 
iﬂpic
 = (
mpiﬂpic
*)
p
;

117 
iﬂpicid
 = 
iﬂpic
->
≠i˙o
;

118 
p
 +(
mpiﬂpic
);

120 
MPBUS
:

121 
MPIOINTR
:

122 
MPLINTR
:

123 
p
 += 8;

126 
ismp
 = 0;

130 if(!
ismp
)

131 
	`∑nic
("Didn't findá suitable machine");

133 if(
mp
->
im¸p
){

136 
	`outb
(0x22, 0x70);

137 
	`outb
(0x23, 
	`öb
(0x23) | 1);

139 
	}
}

	@mp.h

3 
	smp
 {

4 
uch¨
 
	msig«tuª
[4];

5 *
	mphyßddr
;

6 
uch¨
 
	mÀngth
;

7 
uch¨
 
	m•e¸ev
;

8 
uch¨
 
	mchecksum
;

9 
uch¨
 
	mty≥
;

10 
uch¨
 
	mim¸p
;

11 
uch¨
 
	mª£rved
[3];

14 
	smpc⁄f
 {

15 
uch¨
 
	msig«tuª
[4];

16 
ush‹t
 
	mÀngth
;

17 
uch¨
 
	mvîsi⁄
;

18 
uch¨
 
	mchecksum
;

19 
uch¨
 
	m¥odu˘
[20];

20 
uöt
 *
	m€mèbÀ
;

21 
ush‹t
 
	m€mÀngth
;

22 
ush‹t
 
	míåy
;

23 
uöt
 *
	mœpiˇddr
;

24 
ush‹t
 
	mxÀngth
;

25 
uch¨
 
	mxchecksum
;

26 
uch¨
 
	mª£rved
;

29 
	smµroc
 {

30 
uch¨
 
	mty≥
;

31 
uch¨
 
	m≠icid
;

32 
uch¨
 
	mvîsi⁄
;

33 
uch¨
 
	mÊags
;

34 
	#MPBOOT
 0x02

35 
uch¨
 
sig«tuª
[4];

36 
uöt
 
„©uª
;

37 
uch¨
 
ª£rved
[8];

	)

40 
	smpiﬂpic
 {

41 
uch¨
 
	mty≥
;

42 
uch¨
 
	m≠i˙o
;

43 
uch¨
 
	mvîsi⁄
;

44 
uch¨
 
	mÊags
;

45 
uöt
 *
	maddr
;

49 
	#MPPROC
 0x00

50 
	#MPBUS
 0x01

51 
	#MPIOAPIC
 0x02

52 
	#MPIOINTR
 0x03

53 
	#MPLINTR
 0x04

54 

	)

	@param.h

1 
	#NPROC
 64

2 
	#NTHREAD
 64

3 
	#KSTACKSIZE
 4096

4 
	#NCPU
 8

5 
	#NOFILE
 16

6 
	#NFILE
 100

7 
	#NINODE
 50

8 
	#NDEV
 10

9 
	#ROOTDEV
 1

10 
	#MAXARG
 32

11 
	#MAXOPBLOCKS
 10

12 
	#LOGSIZE
 (
MAXOPBLOCKS
*3)

13 
	#NBUF
 (
MAXOPBLOCKS
*3)

14 
	#FSSIZE
 1000

15 #i‚de‡
NULL


	)

16 
	#NULL
 ((*)0)

	)

	@picirq.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"å≠s.h
"

6 
	#IO_PIC1
 0x20

7 
	#IO_PIC2
 0xA0

8 

	)

11 
	$picöô
()

14 
	`outb
(
IO_PIC1
+1, 0xFF);

15 
	`outb
(
IO_PIC2
+1, 0xFF);

16 
	}
}

	@pipe.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"mmu.h
"

5 
	~"¥oc.h
"

6 
	~"fs.h
"

7 
	~"•ölock.h
"

8 
	~"¶ì∂ock.h
"

9 
	~"fûe.h
"

11 
	#PIPESIZE
 512

	)

13 
	spùe
 {

14 
•ölock
 
	mlock
;

15 
	md©a
[
PIPESIZE
];

16 
uöt
 
	mƒód
;

17 
uöt
 
	mnwrôe
;

18 
	mªad›í
;

19 
	mwrôe›í
;

23 
	$pùóŒoc
(
fûe
 **
f0
, fûê**
f1
)

25 
pùe
 *
p
;

27 
p
 = 0;

28 *
f0
 = *
f1
 = 0;

29 if((*
f0
 = 
	`fûóŒoc
()Ë=0 || (*
f1
 = filealloc()) == 0)

30 
bad
;

31 if((
p
 = (
pùe
*)
	`kÆloc
()) == 0)

32 
bad
;

33 
p
->
ªad›í
 = 1;

34 
p
->
wrôe›í
 = 1;

35 
p
->
nwrôe
 = 0;

36 
p
->
ƒód
 = 0;

37 
	`öôlock
(&
p
->
lock
, "pipe");

38 (*
f0
)->
ty≥
 = 
FD_PIPE
;

39 (*
f0
)->
ªadabÀ
 = 1;

40 (*
f0
)->
wrôabÀ
 = 0;

41 (*
f0
)->
pùe
 = 
p
;

42 (*
f1
)->
ty≥
 = 
FD_PIPE
;

43 (*
f1
)->
ªadabÀ
 = 0;

44 (*
f1
)->
wrôabÀ
 = 1;

45 (*
f1
)->
pùe
 = 
p
;

49 
bad
:

50 if(
p
)

51 
	`k‰ì
((*)
p
);

52 if(*
f0
)

53 
	`fûe˛o£
(*
f0
);

54 if(*
f1
)

55 
	`fûe˛o£
(*
f1
);

57 
	}
}

60 
	$pùe˛o£
(
pùe
 *
p
, 
wrôabÀ
)

62 
	`acquúe
(&
p
->
lock
);

63 if(
wrôabÀ
){

64 
p
->
wrôe›í
 = 0;

65 
	`wakeup
(&
p
->
ƒód
);

67 
p
->
ªad›í
 = 0;

68 
	`wakeup
(&
p
->
nwrôe
);

70 if(
p
->
ªad›í
 =0 &&Ö->
wrôe›í
 == 0){

71 
	`ªÀa£
(&
p
->
lock
);

72 
	`k‰ì
((*)
p
);

74 
	`ªÀa£
(&
p
->
lock
);

75 
	}
}

79 
	$pùewrôe
(
pùe
 *
p
, *
addr
, 
n
)

81 
i
;

83 
	`acquúe
(&
p
->
lock
);

84 
i
 = 0; i < 
n
; i++){

85 
p
->
nwrôe
 =p->
ƒód
 + 
PIPESIZE
){

86 if(
p
->
ªad›í
 =0 || 
	`my¥oc
()->
kûÀd
){

87 
	`ªÀa£
(&
p
->
lock
);

90 
	`wakeup
(&
p
->
ƒód
);

91 
	`¶ìp
(&
p
->
nwrôe
, &p->
lock
);

93 
p
->
d©a
[p->
nwrôe
++ % 
PIPESIZE
] = 
addr
[
i
];

95 
	`wakeup
(&
p
->
ƒód
);

96 
	`ªÀa£
(&
p
->
lock
);

97  
n
;

98 
	}
}

101 
	$pùîód
(
pùe
 *
p
, *
addr
, 
n
)

103 
i
;

105 
	`acquúe
(&
p
->
lock
);

106 
p
->
ƒód
 =p->
nwrôe
 &&Ö->
wrôe›í
){

107 if(
	`my¥oc
()->
kûÀd
){

108 
	`ªÀa£
(&
p
->
lock
);

111 
	`¶ìp
(&
p
->
ƒód
, &p->
lock
);

113 
i
 = 0; i < 
n
; i++){

114 if(
p
->
ƒód
 =p->
nwrôe
)

116 
addr
[
i
] = 
p
->
d©a
[p->
ƒód
++ % 
PIPESIZE
];

118 
	`wakeup
(&
p
->
nwrôe
);

119 
	`ªÀa£
(&
p
->
lock
);

120  
i
;

121 
	}
}

	@printf.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$putc
(
fd
, 
c
)

8 
	`wrôe
(
fd
, &
c
, 1);

9 
	}
}

12 
	$¥ötöt
(
fd
, 
xx
, 
ba£
, 
sgn
)

14 
digôs
[] = "0123456789ABCDEF";

15 
buf
[16];

16 
i
, 
√g
;

17 
uöt
 
x
;

19 
√g
 = 0;

20 if(
sgn
 && 
xx
 < 0){

21 
√g
 = 1;

22 
x
 = -
xx
;

24 
x
 = 
xx
;

27 
i
 = 0;

29 
buf
[
i
++] = 
digôs
[
x
 % 
ba£
];

30 }(
x
 /
ba£
) != 0);

31 if(
√g
)

32 
buf
[
i
++] = '-';

34 --
i
 >= 0)

35 
	`putc
(
fd
, 
buf
[
i
]);

36 
	}
}

40 
	$¥ötf
(
fd
, c⁄° *
fmt
, ...)

42 *
s
;

43 
c
, 
i
, 
°©e
;

44 
uöt
 *
≠
;

46 
°©e
 = 0;

47 
≠
 = (
uöt
*)(*)&
fmt
 + 1;

48 
i
 = 0; 
fmt
[i]; i++){

49 
c
 = 
fmt
[
i
] & 0xff;

50 if(
°©e
 == 0){

51 if(
c
 == '%'){

52 
°©e
 = '%';

54 
	`putc
(
fd
, 
c
);

56 } if(
°©e
 == '%'){

57 if(
c
 == 'd'){

58 
	`¥ötöt
(
fd
, *
≠
, 10, 1);

59 
≠
++;

60 } if(
c
 == 'x' || c == 'p'){

61 
	`¥ötöt
(
fd
, *
≠
, 16, 0);

62 
≠
++;

63 } if(
c
 == 's'){

64 
s
 = (*)*
≠
;

65 
≠
++;

66 if(
s
 == 0)

67 
s
 = "(null)";

68 *
s
 != 0){

69 
	`putc
(
fd
, *
s
);

70 
s
++;

72 } if(
c
 == 'c'){

73 
	`putc
(
fd
, *
≠
);

74 
≠
++;

75 } if(
c
 == '%'){

76 
	`putc
(
fd
, 
c
);

79 
	`putc
(
fd
, '%');

80 
	`putc
(
fd
, 
c
);

82 
°©e
 = 0;

85 
	}
}

	@proc.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"x86.h
"

7 
	~"¥oc.h
"

8 
	~"•ölock.h
"

10 
	#MULTSTRIDESHARE
 (1000)

	)

11 
	#DEPTH_QUEUE
 (3)

	)

12 
	#PERIOD_BOOSTING
 (200)

	)

13 
	#STRIDE_DEFAULT_TIME_QUANTOM
 (5)

	)

14 
	#INITIAL_LEV
 (0)

	)

15 
	#STRIDE_LEV
 (9)

	)

19 
•ölock
 
	mlock
;

20 
¥oc
 
	m¥oc
[
NPROC
];

21 
¥oc
* 
	mARRAYQUEUE
[
DEPTH_QUEUE
][
NPROC
];

22 
	mq_size
[
DEPTH_QUEUE
];

23 } 
	g±abÀ
;

26 
¥oc
* 
	m¥oc
[
NPROC
];

27 
	m°abÀ_size
;

28 } 
	g°abÀ
;

30 
¥oc
 *
	göô¥oc
;

32 
	g√xçid
 = 1;

34 
f‹kªt
();

35 
å≠ªt
();

36 
wakeup1
(*
ch™
);

38 
	gmö_∑ss
;

67 
thªad
*

68 
	$Ælo˘hªad
()

70 
¥oc
 *
p
;

71 
¥oc
* 
cuΩroc
 = 
	`my¥oc
();

72 *
•
;

74 
	`acquúe
(&
±abÀ
.
lock
);

76 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++)

77 if(
p
->
°©e
 =
UNUSED
)

78 
found
;

80 
	`ªÀa£
(&
±abÀ
.
lock
);

83 
found
:

84 
p
->
°©e
 = 
EMBRYO
;

85 
p
->
pid
 = -1;

87 
	`ªÀa£
(&
±abÀ
.
lock
);

90 if((
p
->
k°ack
 = 
	`kÆloc
()) == 0){

91 
p
->
°©e
 = 
UNUSED
;

95 
•
 = 
p
->
k°ack
 + 
KSTACKSIZE
;

98 
•
 - *
p
->
tf
;

99 
p
->
tf
 = (
å≠‰ame
*)
•
;

103 
•
 -= 4;

104 *(
uöt
*)
•
 = (uöt)
å≠ªt
;

107 
•
 - *
p
->
c⁄ãxt
;

108 
p
->
c⁄ãxt
 = (c⁄ãxt*)
•
;

109 
	`mem£t
(
p
->
c⁄ãxt
, 0,  *p->context);

110 
p
->
c⁄ãxt
->
eù
 = (
uöt
)
f‹kªt
;

112 
	`acquúe
(&
±abÀ
.
lock
);

113 
cuΩroc
 -> 
thªads
[++(cuΩroc->
num_thªad
)] = 
p
;

115 
	`ªÀa£
(&
±abÀ
.
lock
);

117 
thªad
* 
t
 = (thªad*Ë
p
;

119  
t
;

120 
	}
}

124 
	$thªad_¸óã
(
thªad_t
 *
thªad
, * (*
°¨t_routöe
)(*), *
¨g
)

126 
¥oc
* 
p
;

127 
¥oc
* 
¡
;

131 
p
 = 
	`my¥oc
();

136 if((
¡
 = 
	`Ælo˘hªad
()Ë=
NULL
)

139 if(
p
->
mu…i_thªaded
 == 0){

140 
p
->
mu…i_thªaded
 = 1;

141 
p
->
ma°î_thªad
 =Ö;

144 
¡
 -> 
mu…i_thªaded
 = 1;

146 
¡
 -> 
tid
 = 
p
 -> 
num_thªad
;

147 
¡
 -> 
ma°î_thªad
 = 
p
;

150 
¡
 -> 
pgdú
 = 
p
 ->Ögdir;

151 
¡
 -> 
ch™
 = 0;

152 
¡
 -> 
kûÀd
 = 0;

153 
¡
 -> 
cwd
 = 
p
 ->cwd;

157 
¡
 -> 
tf
 -> 
eù
 = (
uöt
)
°¨t_routöe
;

158 
	`˝rötf
("start_rountine changed\n");

163 
sz
 = 
p
 -> sz;

166 
sz
 = 
	`PGROUNDUP
(sz);

168 if((
sz
 = 
	`Ælocuvm
(
¡
->
pgdú
, sz, sz + 2*
PGSIZE
)) == 0)

169 
	`∑nic
("allocuvm");

171 
p
 -> 
sz
 = sz;

176 
	`˛óΩãu
(
p
->
pgdú
,(*)’ -> 
sz
 - 2*
PGSIZE
));

180 
u°ack
[2];

184 
u°ack
[0] = (
uöt
)
thªad_exô
;

185 
u°ack
[1] = (
uöt
)
¨g
;

187 
¡
 -> 
pgdú
 = 
p
 ->Ögdir;

193 
¡
 -> 
sz
 = 
p
 -> sz;

194 
¡
 -> 
tf
 -> 
e•
 = 
p
 -> 
sz
;

195 
¡
 -> 
tf
 -> 
e•
 -= 2 * ();

197 if(
	`c›yout
(
p
->
pgdú
, 
¡
 -> 
tf
 -> 
e•
, 
u°ack
, 2 * 4) < 0)

198 
	`∑nic
("copyout");

200 
	`˝rötf
("first copyoutÉz\n");

202 
•
 = 0;

203 
¡
 -> 
sz
 = sz;

204 
¡
 -> 
k°ack
 = (*Ë
•
;

205 
¡
 -> 
tf
 -> 
ebp
 =Çà->Å‡-> 
e•
;

207 
i
 = 0; i < 
NOFILE
; i++)

208 if(
p
->
ofûe
[
i
])

209 
¡
->
ofûe
[
i
] = 
	`fûedup
(
p
->ofile[i]);

210 
¡
->
cwd
 = 
	`idup
(
p
->cwd);

213 
	`ß„°r˝y
(
¡
->
«me
, 
p
->name, (p->name));

215 
	`acquúe
(&
±abÀ
.
lock
);

217 
¡
->
°©e
 = 
SLEEPING
;

218 
	`ªÀa£
(&
±abÀ
.
lock
);

220 
	`˝rötf
("thªad ALLOCED wôhÅid[%d]\n",
p
->
tid
);

221 
	`˝rötf
("pid[%d] sz[%x] k°ack[%x]\n",
p
->
pid
,p->
sz
,p->
k°ack
);

222 
	`˝rötf
("ma°î_thªad[%x]Çum_thªad[%d]Ögdú[%x]\n",
p
->
ma°î_thªad
,p->
num_thªad
,p->
pgdú
);

225 
	}
}

228 
	$thªad_exô
(*
ªtvÆ
)

230 
¥oc
 * 
cuΩroc
;

232 
cuΩroc
 = 
	`my¥oc
();

235 
cuΩroc
 -> 
°©e
 = 
ZOMBIE
;

237 
cuΩroc
 -> 
ªt_vÆ
[cuΩroc->
tid
] = *(*)
ªtvÆ
;

239 
	`wakeup1
(
cuΩroc
->
∑ª¡
);

242 
	`sched
();

243 
	`∑nic
("[THREAD]zombieÉxit");

246 
	}
}

249 
	$thªad_joö
(
thªad_t
 
thªadid
, **
ªtvÆ
)

251 
¥oc
 * 
cuΩroc
;

252 
cuΩroc
 = 
	`my¥oc
();

256 
	`k‰ì
(
cuΩroc
 -> 
k°ack
);

263 
	`¶ìp
(
cuΩroc
,
NULL
);

272 *(*)
ªtvÆ
 = 
cuΩroc
->
ªt_vÆ
[
thªadid
];

274 
	}
}

283 
	$queue_èbÀ_lookup
()

285 
i
=0;i<
DEPTH_QUEUE
;i++){

286 
	`˝rötf
("[LEV%d]SIZE[%d] : ",
i
 ,
±abÀ
.
q_size
[i]+1);

287 
j
=0;j<=
±abÀ
.
q_size
[
i
];j++)

288 
	`˝rötf
("%d[%d] ",
±abÀ
.
ARRAYQUEUE
[
i
][
j
]->
pid
,±abÀ.ARRAYQUEUE[i][j]->
°©e
);

289 
	`˝rötf
("\n");

291 
	}
}

294 
	$mö
(
x
,
y
)

296  
x
<
y
?x:y;

297 
	}
}

300 
	$gëÀv
()

302  
	`my¥oc
()->
Àv
;

303 
	}
}

306 
	$£t_˝u_sh¨e
(
sh¨e
)

309 
¥oc
* 
mlfq
 = 
°abÀ
.proc[0];

311 i‡(
mlfq
 -> 
sh¨e
 - share < 20 || share < 0){

312 
	`˝rötf
("proc.c:set_cpu_share:: unableÅo set cpu share\n");

316 
	`acquúe
(&
±abÀ
.
lock
);

317 
¥oc
* 
p

	`my¥oc
();

319 if(
p
 -> 
tid
)

320 
p
 =Ö -> 
∑ª¡
;

322 
°abÀ
.
¥oc
[++°abÀ.
°abÀ_size
] = 
p
;

324 
mlfq
 -> 
sh¨e
 -= share;

325 
p
 -> 
sh¨e
 = share;

326 
p
 -> 
∑ss
 = 
mö_∑ss
;

329 
i
=0;i<=
±abÀ
.
q_size
[
p
->
Àv
];i++){

330 if(
p
 =
±abÀ
.
ARRAYQUEUE
[p->
Àv
][
i
]){

331 
±abÀ
.
q_size
[
p
->
Àv
]--;

332 
j
=
i
;j<=
±abÀ
.
q_size
[
p
->
Àv
];j++)

333 
±abÀ
.
ARRAYQUEUE
[
p
->
Àv
][
j
] =Ötable.ARRAYQUEUE[p->lev][j+1];

339 
p
->
Àv
 = 
STRIDE_LEV
;

340 
p
->
time_ÆlŸmít
 = 
STRIDE_DEFAULT_TIME_QUANTOM
;

342 
	`ªÀa£
(&
±abÀ
.
lock
);

344 
	}
}

349 
	$pöô
()

351 
	`öôlock
(&
±abÀ
.
lock
, "ptable");

352 
	}
}

356 
	$˝uid
()

358  
	`my˝u
()-
˝us
;

359 
	}
}

363 
˝u
*

364 
	$my˝u
()

366 
≠icid
, 
i
;

368 if(
	`ªadeÊags
()&
FL_IF
)

369 
	`∑nic
("mycpu called with interruptsÉnabled\n");

371 
≠icid
 = 
	`œpicid
();

374 
i
 = 0; i < 
n˝u
; ++i) {

375 i‡(
˝us
[
i
].
≠icid
 ==ápicid)

376  &
˝us
[
i
];

378 
	`∑nic
("unknownápicid\n");

379 
	}
}

383 
¥oc
*

384 
	$my¥oc
() {

385 
˝u
 *
c
;

386 
¥oc
 *
p
;

387 
	`push˛i
();

388 
c
 = 
	`my˝u
();

389 
p
 = 
c
->
¥oc
;

390 
	`p›˛i
();

391  
p
;

392 
	}
}

399 
¥oc
*

400 
	$Ælo˝roc
()

402 
¥oc
 *
p
;

403 *
•
;

405 
	`acquúe
(&
±abÀ
.
lock
);

407 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++)

408 if(
p
->
°©e
 =
UNUSED
)

409 
found
;

411 
	`ªÀa£
(&
±abÀ
.
lock
);

414 
found
:

415 
p
->
°©e
 = 
EMBRYO
;

416 
p
->
pid
 = 
√xçid
++;

418 
	`ªÀa£
(&
±abÀ
.
lock
);

420 if((
p
->
k°ack
 = 
	`kÆloc
()) == 0){

421 
p
->
°©e
 = 
UNUSED
;

425 
•
 = 
p
->
k°ack
 + 
KSTACKSIZE
;

428 
•
 - *
p
->
tf
;

429 
p
->
tf
 = (
å≠‰ame
*)
•
;

433 
•
 -= 4;

434 *(
uöt
*)
•
 = (uöt)
å≠ªt
;

436 
•
 - *
p
->
c⁄ãxt
;

437 
p
->
c⁄ãxt
 = (c⁄ãxt*)
•
;

438 
	`mem£t
(
p
->
c⁄ãxt
, 0,  *p->context);

439 
p
->
c⁄ãxt
->
eù
 = (
uöt
)
f‹kªt
;

442 
p
 -> 
mu…i_thªaded
 = 0;

443 
p
 -> 
num_thªad
 = 0;

446 
p
 -> 
Àv
 = 
INITIAL_LEV
;

447 
p
 -> 
time_ÆlŸmít
 =Åime_ÆlŸmít[
INITIAL_LEV
];

448 
p
 -> 
°¨t_tick
 = 
ticks
;

451 
p
 -> 
sh¨e
 = 0;

452 
p
 -> 
∑ss
 = 0;

455 
p
 -> 
fú°_scheduÀd
 = 0;

457 
	`acquúe
(&
±abÀ
.
lock
);

458 
±abÀ
.
ARRAYQUEUE
[0][++±abÀ.
q_size
[0]] = 
p
;

459 
	`ªÀa£
(&
±abÀ
.
lock
);

461  
p
;

462 
	}
}

467 
	$u£röô
()

469 
	`˝rötf
("[USERINIT]Entering\n");

470 
¥oc
 *
p
;

471 
_bö¨y_öôcode_°¨t
[], 
_bö¨y_öôcode_size
[];

474 
i
 = 0; i < 
DEPTH_QUEUE
; i++)

475 
±abÀ
.
q_size
[
i
] = -1;

476 
°abÀ
.
°abÀ_size
 = -1;

479 
p
 = 
	`Ælo˝roc
();

481 
öô¥oc
 = 
p
;

482 if((
p
->
pgdú
 = 
	`£tupkvm
()) == 0)

483 
	`∑nic
("userinit: out of memory?");

484 
	`öôuvm
(
p
->
pgdú
, 
_bö¨y_öôcode_°¨t
, ()
_bö¨y_öôcode_size
);

485 
p
->
sz
 = 
PGSIZE
;

486 
	`mem£t
(
p
->
tf
, 0, (*p->tf));

487 
p
->
tf
->
cs
 = (
SEG_UCODE
 << 3Ë| 
DPL_USER
;

488 
p
->
tf
->
ds
 = (
SEG_UDATA
 << 3Ë| 
DPL_USER
;

489 
p
->
tf
->
es
 =Ö->tf->
ds
;

490 
p
->
tf
->
ss
 =Ö->tf->
ds
;

491 
p
->
tf
->
eÊags
 = 
FL_IF
;

492 
p
->
tf
->
e•
 = 
PGSIZE
;

493 
p
->
tf
->
eù
 = 0;

495 
	`ß„°r˝y
(
p
->
«me
, "initcode", (p->name));

496 
p
->
cwd
 = 
	`«mei
("/");

502 
	`acquúe
(&
±abÀ
.
lock
);

504 
p
->
°©e
 = 
RUNNABLE
;

506 
	`ªÀa£
(&
±abÀ
.
lock
);

508 
	`˝rötf
("[USERINIT]Escaping\n");

509 
	}
}

514 
	$grow¥oc
(
n
)

516 
uöt
 
sz
;

517 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

519 
sz
 = 
cuΩroc
->sz;

520 if(
n
 > 0){

521 if((
sz
 = 
	`Ælocuvm
(
cuΩroc
->
pgdú
, sz, sz + 
n
)) == 0)

523 } if(
n
 < 0){

524 if((
sz
 = 
	`dóŒocuvm
(
cuΩroc
->
pgdú
, sz, sz + 
n
)) == 0)

527 
cuΩroc
->
sz
 = sz;

528 
	`swôchuvm
(
cuΩroc
);

530 
	}
}

536 
	$f‹k
()

538 
i
, 
pid
;

539 
¥oc
 *
≈
;

540 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

543 if((
≈
 = 
	`Ælo˝roc
()) == 0){

548 if((
≈
->
pgdú
 = 
	`c›yuvm
(
cuΩroc
->pgdú, cuΩroc->
sz
)) == 0){

549 
	`k‰ì
(
≈
->
k°ack
);

550 
≈
->
k°ack
 = 0;

551 
≈
->
°©e
 = 
UNUSED
;

554 
≈
->
sz
 = 
cuΩroc
->sz;

555 
≈
->
∑ª¡
 = 
cuΩroc
;

556 *
≈
->
tf
 = *
cuΩroc
->tf;

559 
≈
->
tf
->
óx
 = 0;

561 
i
 = 0; i < 
NOFILE
; i++)

562 if(
cuΩroc
->
ofûe
[
i
])

563 
≈
->
ofûe
[
i
] = 
	`fûedup
(
cuΩroc
->ofile[i]);

564 
≈
->
cwd
 = 
	`idup
(
cuΩroc
->cwd);

566 
	`ß„°r˝y
(
≈
->
«me
, 
cuΩroc
->name, (curproc->name));

569 
pid
 = 
≈
->pid;

572 
≈
 -> 
num_thªad
 = 0;

573 
≈
 -> 
tid
 = 0;

575 
	`acquúe
(&
±abÀ
.
lock
);

576 
≈
->
°©e
 = 
RUNNABLE
;

577 
	`ªÀa£
(&
±abÀ
.
lock
);

579  
pid
;

580 
	}
}

586 
	$exô
()

588 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

589 
¥oc
 *
p
;

590 
fd
;

592 
	`˝rötf
("exiting\n");

593 if(
cuΩroc
 =
öô¥oc
)

594 
	`∑nic
("initÉxiting");

597 
fd
 = 0; fd < 
NOFILE
; fd++){

598 if(
cuΩroc
->
ofûe
[
fd
]){

599 
	`fûe˛o£
(
cuΩroc
->
ofûe
[
fd
]);

600 
cuΩroc
->
ofûe
[
fd
] = 0;

604 
	`begö_›
();

605 
	`ùut
(
cuΩroc
->
cwd
);

606 
	`íd_›
();

607 
cuΩroc
->
cwd
 = 0;

609 
	`acquúe
(&
±abÀ
.
lock
);

612 
	`wakeup1
(
cuΩroc
->
∑ª¡
);

616 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

617 if(
p
->
∑ª¡
 =
cuΩroc
){

618 
p
->
∑ª¡
 = 
öô¥oc
;

619 if(
p
->
°©e
 =
ZOMBIE
)

620 
	`wakeup1
(
öô¥oc
);

624 
¥oc
* 
t
;

625 if(
cuΩroc
 -> 
sh¨e
 == 0){

628 
i
=0;i<=
±abÀ
.
q_size
[
cuΩroc
->
Àv
];i++){

630 
t
 = 
±abÀ
.
ARRAYQUEUE
[
cuΩroc
->
Àv
][
i
];

631 if(
t
 =
cuΩroc
){

632 
±abÀ
.
q_size
[
cuΩroc
->
Àv
]--;

633 
j
=
i
;j<=
±abÀ
.
q_size
[
cuΩroc
->
Àv
];j++)

634 
±abÀ
.
ARRAYQUEUE
[
cuΩroc
->
Àv
][
j
] =Ötable.ARRAYQUEUE[curproc->lev][j+1];

643 
i
=0;i<=
°abÀ
.
°abÀ_size
;i++){

645 
t
 = 
°abÀ
.
¥oc
[
i
];

646 if(
t
 =
cuΩroc
){

647 
°abÀ
.
°abÀ_size
--;

648 
j
=
i
;j<=
°abÀ
.
°abÀ_size
;j++)

649 
°abÀ
.
¥oc
[
j
] = stable.proc[j+1];

655 
°abÀ
.
¥oc
[0]->
sh¨e
 +
cuΩroc
->share;

660 
cuΩroc
->
°©e
 = 
ZOMBIE
;

661 
	`sched
();

662 
	`∑nic
("zombieÉxit");

663 
	}
}

668 
	$waô
()

670 
¥oc
 *
p
;

671 
havekids
, 
pid
;

672 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

674 
	`acquúe
(&
±abÀ
.
lock
);

677 
havekids
 = 0;

678 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

679 if(
p
->
∑ª¡
 !
cuΩroc
)

681 
havekids
 = 1;

682 if(
p
->
°©e
 =
ZOMBIE
){

684 
pid
 = 
p
->pid;

685 
	`k‰ì
(
p
->
k°ack
);

686 
p
->
k°ack
 = 0;

687 
	`‰ìvm
(
p
->
pgdú
);

688 
p
->
pid
 = 0;

689 
p
->
∑ª¡
 = 0;

690 
p
->
«me
[0] = 0;

691 
p
->
kûÀd
 = 0;

692 
p
->
°©e
 = 
UNUSED
;

693 
	`ªÀa£
(&
±abÀ
.
lock
);

694  
pid
;

699 if(!
havekids
 || 
cuΩroc
->
kûÀd
){

700 
	`ªÀa£
(&
±abÀ
.
lock
);

705 
	`¶ìp
(
cuΩroc
, &
±abÀ
.
lock
);

707 
	}
}

714 
	$boo°
 ()

716 
	`acquúe
(&
±abÀ
.
lock
);

717 
	`˝rötf
("boosting\n");

719 
¥oc
* 
p
;

720 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

721 
p
->
Àv
 = 0;

722 
p
->
time_ÆlŸmít
 =Åime_allotment[0];

724 
	`ªÀa£
(&
±abÀ
.
lock
);

725 
	}
}

729 
	$scheduÀr
()

731 
¥oc
 *
p
;

732 
˝u
 *
c
 = 
	`my˝u
();

733 
c
->
¥oc
 = 0;

735 
time_qu™tom
[
STRIDE_LEV
] = 
STRIDE_DEFAULT_TIME_QUANTOM
;

736 
time_ÆlŸmít
[
STRIDE_LEV
] = 
STRIDE_DEFAULT_TIME_QUANTOM
;

741 
¥oc
 
mlfq
;

742 
mlfq
.
sh¨e
 = 100;

743 
mlfq
.
∑ss
 = 0;

744 
mlfq
.
pid
 = 85064538;

745 
mlfq
.
°©e
 = 
RUNNABLE
;

746 
°abÀ
.
¥oc
[++°abÀ.
°abÀ_size
] = &
mlfq
;

749 
i
,
j
;

750 
mö_ödex
;

756 
	`°i
();

758 
	`acquúe
(&
±abÀ
.
lock
);

760 
mö_ödex
 = 0;

761 
i
 = 0; i <
°abÀ
.
°abÀ_size
; i++ ){

762 if(
°abÀ
.
¥oc
[
i
]->
°©e
 !
RUNNABLE
)

764 if(
°abÀ
.
¥oc
[
i
] -> 
∑ss
 < sèbÀ.¥oc[
mö_ödex
] ->Öass){

765 
mö_ödex
 = 
i
;

770 
p
 = 
°abÀ
.
¥oc
[
mö_ödex
];

771 
p
 -> 
∑ss
 +
MULTSTRIDESHARE
 /Ö->
sh¨e
;

772 
mö_∑ss
 = 
p
->
∑ss
;

774 
found
 = 0;

775 if(
mö_ödex
 == 0){

777 
i
 = 0; i < 
DEPTH_QUEUE
; i++){

778 
j
 = 0; j <
±abÀ
.
q_size
[
i
]; j++){

779 
p
 = 
±abÀ
.
ARRAYQUEUE
[
i
][
j
];

780 if(
p
->
°©e
 !
RUNNABLE
)

782 if(
p
->
sh¨e
)

784 
found
 = 1;

787 if(
found
)

795 if(
p
->
°©e
==
RUNNABLE
){

796 if(
p
->
fú°_scheduÀd
 == 0){

797 
	`˝rötf
("pid[%d] sz[%x] k°ack[%x]\n",
p
->
pid
,p->
sz
,p->
k°ack
);

798 
	`˝rötf
("ma°î_thªad[%x]Çum_thªad[%d]Ögdú[%x]\n",
p
->
ma°î_thªad
,p->
num_thªad
,p->
pgdú
);

800 
p
->
fú°_scheduÀd
 = 1;

824 
p
->
°¨t_tick
 = 
MLFQ_ticks
;

826 
c
->
¥oc
 = 
p
;

827 
	`swôchuvm
(
p
);

828 
p
->
°©e
 = 
RUNNING
;

830 
	`swtch
(&(
c
->
scheduÀr
), 
p
->
c⁄ãxt
);

831 
	`swôchkvm
();

835 
c
->
¥oc
 = 0;

839 
	`ªÀa£
(&
±abÀ
.
lock
);

841 
	}
}

852 
	$sched
()

854 
öã«
;

855 
¥oc
 *
p
 = 
	`my¥oc
();

857 if(!
	`hﬁdög
(&
±abÀ
.
lock
))

858 
	`∑nic
("schedÖtable.lock");

859 if(
	`my˝u
()->
n˛i
 != 1)

860 
	`∑nic
("schedÜocks");

861 if(
p
->
°©e
 =
RUNNING
)

862 
	`∑nic
("schedÑunning");

863 if(
	`ªadeÊags
()&
FL_IF
)

864 
	`∑nic
("sched interruptible");

865 
öã«
 = 
	`my˝u
()->intena;

866 
	`swtch
(&
p
->
c⁄ãxt
, 
	`my˝u
()->
scheduÀr
);

867 
	`my˝u
()->
öã«
 = intena;

868 
	}
}

872 
	$yõld
()

874 
	`acquúe
(&
±abÀ
.
lock
);

875 
	`my¥oc
()->
°©e
 = 
RUNNABLE
;

880 
¥oc
* 
p
 = 
	`my¥oc
();

883 if(
p
->
‰om_å≠
);

891 
p
->
time_ÆlŸmít
--;

893 if(
p
->
sh¨e
==0){

897 
Àv_¥e
 = 
p
->
Àv
;

899 if(
p
 -> 
time_ÆlŸmít
 == 0

900 && 
p
 -> 
Àv
 !
DEPTH_QUEUE
 - 1)

901 
p
->
Àv
++;

903 
Àv_now
 = 
p
->
Àv
;

908 
i
=0;i<=
±abÀ
.
q_size
[
Àv_¥e
];i++){

909 if(
±abÀ
.
ARRAYQUEUE
[
Àv_¥e
][
i
] =
p
){

910 
±abÀ
.
q_size
[
Àv_¥e
]--;

911 
j
=
i
;j<=
±abÀ
.
q_size
[
Àv_¥e
];j++){

912 
±abÀ
.
ARRAYQUEUE
[
Àv_¥e
][
j
] =Ötable.ARRAYQUEUE[lev_pre][j+1];

918 
±abÀ
.
ARRAYQUEUE
[
Àv_now
][++±abÀ.
q_size
[Àv_now]] = 
p
;

920 if(
Àv_now
!=
Àv_¥e
)

921 
p
 -> 
time_ÆlŸmít
 =Åime_ÆlŸmít[p->
Àv
];

927 
p
 -> 
time_ÆlŸmít
 =Åime_ÆlŸmít[p->
Àv
];

931 
	`sched
();

932 
	`ªÀa£
(&
±abÀ
.
lock
);

933 
	}
}

938 
	$f‹kªt
()

940 
fú°
 = 1;

942 
	`ªÀa£
(&
±abÀ
.
lock
);

944 i‡(
fú°
) {

948 
fú°
 = 0;

949 
	`iöô
(
ROOTDEV
);

950 
	`öôlog
(
ROOTDEV
);

952 
	`˝rötf
("[FORKRET]ESCAPING\n");

955 
	}
}

960 
	$¶ìp
(*
ch™
, 
•ölock
 *
lk
)

962 
¥oc
 *
p
 = 
	`my¥oc
();

964 if(
p
 == 0)

965 
	`∑nic
("sleep");

967 if(
lk
 == 0)

968 
	`∑nic
("sleep withoutÜk");

976 if(
lk
 !&
±abÀ
.
lock
){

977 
	`acquúe
(&
±abÀ
.
lock
);

978 
	`ªÀa£
(
lk
);

981 
p
->
ch™
 = chan;

982 
p
->
°©e
 = 
SLEEPING
;

984 
	`sched
();

987 
p
->
ch™
 = 0;

990 if(
lk
 !&
±abÀ
.
lock
){

991 
	`ªÀa£
(&
±abÀ
.
lock
);

992 
	`acquúe
(
lk
);

994 
	}
}

1000 
	$wakeup1
(*
ch™
)

1002 
¥oc
 *
p
;

1004 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++)

1005 if(
p
->
°©e
 =
SLEEPING
 &&Ö->
ch™
 == chan)

1006 
p
->
°©e
 = 
RUNNABLE
;

1007 
	}
}

1011 
	$wakeup
(*
ch™
)

1013 
	`acquúe
(&
±abÀ
.
lock
);

1014 
	`wakeup1
(
ch™
);

1015 
	`ªÀa£
(&
±abÀ
.
lock
);

1016 
	}
}

1022 
	$kûl
(
pid
)

1024 
¥oc
 *
p
;

1026 
	`acquúe
(&
±abÀ
.
lock
);

1027 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

1028 if(
p
->
pid
 ==Öid){

1029 
p
->
kûÀd
 = 1;

1031 if(
p
->
°©e
 =
SLEEPING
)

1032 
p
->
°©e
 = 
RUNNABLE
;

1033 
	`ªÀa£
(&
±abÀ
.
lock
);

1037 
	`ªÀa£
(&
±abÀ
.
lock
);

1039 
	}
}

1046 
	$¥ocdump
()

1048 *
°©es
[] = {

1049 [
UNUSED
] "unused",

1050 [
EMBRYO
] "embryo",

1051 [
SLEEPING
] "sleep ",

1052 [
RUNNABLE
] "runble",

1053 [
RUNNING
] "run ",

1054 [
ZOMBIE
] "zombie"

1056 
i
;

1057 
¥oc
 *
p
;

1058 *
°©e
;

1059 
uöt
 
pc
[10];

1061 
p
 = 
±abÀ
.
¥oc
;Ö < &±abÀ.¥oc[
NPROC
];Ö++){

1062 if(
p
->
°©e
 =
UNUSED
)

1064 if(
p
->
°©e
 >0 &&Ö->°©ê< 
	`NELEM
(
°©es
) && states[p->state])

1065 
°©e
 = 
°©es
[
p
->state];

1067 
°©e
 = "???";

1068 
	`˝rötf
("%d %†%s", 
p
->
pid
, 
°©e
,Ö->
«me
);

1069 if(
p
->
°©e
 =
SLEEPING
){

1070 
	`gëˇŒîpcs
((
uöt
*)
p
->
c⁄ãxt
->
ebp
+2, 
pc
);

1071 
i
=0; i<10 && 
pc
[i] != 0; i++)

1072 
	`˝rötf
(" %p", 
pc
[
i
]);

1074 
	`˝rötf
("\n");

1076 
	}
}

	@proc.h

2 
	s˝u
 {

3 
uch¨
 
	m≠icid
;

4 
c⁄ãxt
 *
	mscheduÀr
;

5 
èsk°©e
 
	mts
;

6 
£gdesc
 
	mgdt
[
NSEGS
];

7 vﬁ©ûê
uöt
 
	m°¨ãd
;

8 
	mn˛i
;

9 
	möã«
;

10 
¥oc
 *
	m¥oc
;

13 
˝u
 
˝us
[
NCPU
];

14 
n˝u
;

27 
	sc⁄ãxt
 {

28 
uöt
 
	medi
;

29 
uöt
 
	mesi
;

30 
uöt
 
	mebx
;

31 
uöt
 
	mebp
;

32 
uöt
 
	meù
;

36 
	tpid_t
;

39 
	tthªad_t
;

40 
¥oc
 
	tthªad
;

41 
¥oc°©e
 
	tthªad°©e
;

49 
	e¥oc°©e
 { 
	mUNUSED
, 
	mEMBRYO
, 
	mSLEEPING
, 
	mRUNNABLE
, 
	mRUNNING
, 
	mZOMBIE
 };

52 
	s¥oc
 {

53 
pde_t
* 
	mpgdú
;

55 
uöt
 
	msz
;

56 *
	mk°ack
;

57 
¥oc°©e
 
	m°©e
;

58 
¥oc
 *
	m∑ª¡
;

59 
å≠‰ame
 *
	mtf
;

60 
c⁄ãxt
 *
	mc⁄ãxt
;

61 *
	mch™
;

62 
	mkûÀd
;

63 
fûe
 *
	mofûe
[
NOFILE
];

64 
öode
 *
	mcwd
;

67 
	m«me
[16];

70 
uöt
 
	m°¨t_tick
;

71 
	mÀv
;

72 
	mtime_ÆlŸmít
;

75 
	msh¨e
;

76 
	m∑ss
;

79 
	mpid
;

82 
	mmu…i_thªaded
;

83 
	mtid
;

84 
	mnum_thªad
;

85 
	mªt_vÆ
[
NTHREAD
];

88 
thªad
* 
	mthªads
[
NTHREAD
];

89 
	mlock
;

94 
	mfú°_scheduÀd
;

95 
	m‰om_å≠
;

97 
¥oc
* 
	mma°î_thªad
;

	@rm.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

6 
	$maö
(
¨gc
, *
¨gv
[])

8 
i
;

10 if(
¨gc
 < 2){

11 
	`¥ötf
(2, "Usage:Ñm files...\n");

12 
	`exô
();

15 
i
 = 1; i < 
¨gc
; i++){

16 if(
	`u∆ök
(
¨gv
[
i
]) < 0){

17 
	`¥ötf
(2, "rm: %†ÁûedÅÿdñëe\n", 
¨gv
[
i
]);

22 
	`exô
();

23 
	}
}

	@sh.c

3 
	~"ty≥s.h
"

4 
	~"u£r.h
"

5 
	~"f˙é.h
"

8 
	#EXEC
 1

	)

9 
	#REDIR
 2

	)

10 
	#PIPE
 3

	)

11 
	#LIST
 4

	)

12 
	#BACK
 5

	)

14 
	#MAXARGS
 10

	)

16 
	scmd
 {

17 
	mty≥
;

20 
	sexeccmd
 {

21 
	mty≥
;

22 *
	m¨gv
[
MAXARGS
];

23 *
	mórgv
[
MAXARGS
];

26 
	sªdúcmd
 {

27 
	mty≥
;

28 
cmd
 *
	mcmd
;

29 *
	mfûe
;

30 *
	mefûe
;

31 
	mmode
;

32 
	mfd
;

35 
	spùecmd
 {

36 
	mty≥
;

37 
cmd
 *
	mÀ·
;

38 
cmd
 *
	mright
;

41 
	sli°cmd
 {

42 
	mty≥
;

43 
cmd
 *
	mÀ·
;

44 
cmd
 *
	mright
;

47 
	sbackcmd
 {

48 
	mty≥
;

49 
cmd
 *
	mcmd
;

52 
f‹k1
();

53 
∑nic
(*);

54 
cmd
 *
∑r£cmd
(*);

58 
	$runcmd
(
cmd
 *cmd)

60 
p
[2];

61 
backcmd
 *
bcmd
;

62 
execcmd
 *
ecmd
;

63 
li°cmd
 *
lcmd
;

64 
pùecmd
 *
pcmd
;

65 
ªdúcmd
 *
rcmd
;

67 if(
cmd
 == 0)

68 
	`exô
();

70 
cmd
->
ty≥
){

72 
	`∑nic
("runcmd");

74 
EXEC
:

75 
ecmd
 = (
execcmd
*)
cmd
;

76 if(
ecmd
->
¨gv
[0] == 0)

77 
	`exô
();

78 
	`exec
(
ecmd
->
¨gv
[0],Écmd->argv);

79 
	`¥ötf
(2, "exe¯%†Áûed\n", 
ecmd
->
¨gv
[0]);

82 
REDIR
:

83 
rcmd
 = (
ªdúcmd
*)
cmd
;

84 
	`˛o£
(
rcmd
->
fd
);

85 if(
	`›í
(
rcmd
->
fûe
,Ñcmd->
mode
) < 0){

86 
	`¥ötf
(2, "›í %†Áûed\n", 
rcmd
->
fûe
);

87 
	`exô
();

89 
	`runcmd
(
rcmd
->
cmd
);

92 
LIST
:

93 
lcmd
 = (
li°cmd
*)
cmd
;

94 if(
	`f‹k1
() == 0)

95 
	`runcmd
(
lcmd
->
À·
);

96 
	`waô
();

97 
	`runcmd
(
lcmd
->
right
);

100 
PIPE
:

101 
pcmd
 = (
pùecmd
*)
cmd
;

102 if(
	`pùe
(
p
) < 0)

103 
	`∑nic
("pipe");

104 if(
	`f‹k1
() == 0){

105 
	`˛o£
(1);

106 
	`dup
(
p
[1]);

107 
	`˛o£
(
p
[0]);

108 
	`˛o£
(
p
[1]);

109 
	`runcmd
(
pcmd
->
À·
);

111 if(
	`f‹k1
() == 0){

112 
	`˛o£
(0);

113 
	`dup
(
p
[0]);

114 
	`˛o£
(
p
[0]);

115 
	`˛o£
(
p
[1]);

116 
	`runcmd
(
pcmd
->
right
);

118 
	`˛o£
(
p
[0]);

119 
	`˛o£
(
p
[1]);

120 
	`waô
();

121 
	`waô
();

124 
BACK
:

125 
bcmd
 = (
backcmd
*)
cmd
;

126 if(
	`f‹k1
() == 0)

127 
	`runcmd
(
bcmd
->
cmd
);

130 
	`exô
();

131 
	}
}

134 
	$gëcmd
(*
buf
, 
nbuf
)

136 
	`¥ötf
(2, "$ ");

137 
	`mem£t
(
buf
, 0, 
nbuf
);

138 
	`gës
(
buf
, 
nbuf
);

139 if(
buf
[0] == 0)

142 
	}
}

145 
	$maö
()

147 
buf
[100];

148 
fd
;

151 (
fd
 = 
	`›í
("c⁄sﬁe", 
O_RDWR
)) >= 0){

152 if(
fd
 >= 3){

153 
	`˛o£
(
fd
);

159 
	`gëcmd
(
buf
, (buf)) >= 0){

163 if(
buf
[0] == 'c' && buf[1] == 'd' && buf[2] == ' '){

165 
buf
[
	`°æí
(buf)-1] = 0;

166 if(
	`chdú
(
buf
+3) < 0)

167 
	`¥ötf
(2, "ˇ¬Ÿ cd %s\n", 
buf
+3);

170 if(
	`f‹k1
() == 0)

171 
	`runcmd
(
	`∑r£cmd
(
buf
));

174 
	`waô
();

176 
	`exô
();

177 
	}
}

180 
	$∑nic
(*
s
)

182 
	`¥ötf
(2, "%s\n", 
s
);

183 
	`exô
();

184 
	}
}

187 
	$f‹k1
()

189 
pid
;

191 
pid
 = 
	`f‹k
();

192 if(
pid
 == -1)

193 
	`∑nic
("fork");

194  
pid
;

195 
	}
}

200 
cmd
*

201 
	$execcmd
()

203 
execcmd
 *
cmd
;

205 
cmd
 = 
	`mÆloc
((*cmd));

206 
	`mem£t
(
cmd
, 0, (*cmd));

207 
cmd
->
ty≥
 = 
EXEC
;

208  (
cmd
*)cmd;

209 
	}
}

211 
cmd
*

212 
	$ªdúcmd
(
cmd
 *
subcmd
, *
fûe
, *
efûe
, 
mode
, 
fd
)

214 
ªdúcmd
 *
cmd
;

216 
cmd
 = 
	`mÆloc
((*cmd));

217 
	`mem£t
(
cmd
, 0, (*cmd));

218 
cmd
->
ty≥
 = 
REDIR
;

219 
cmd
->cmd = 
subcmd
;

220 
cmd
->
fûe
 = file;

221 
cmd
->
efûe
 =Éfile;

222 
cmd
->
mode
 = mode;

223 
cmd
->
fd
 = fd;

224  (
cmd
*)cmd;

225 
	}
}

227 
cmd
*

228 
	$pùecmd
(
cmd
 *
À·
, cmd *
right
)

230 
pùecmd
 *
cmd
;

232 
cmd
 = 
	`mÆloc
((*cmd));

233 
	`mem£t
(
cmd
, 0, (*cmd));

234 
cmd
->
ty≥
 = 
PIPE
;

235 
cmd
->
À·
 =Üeft;

236 
cmd
->
right
 =Ñight;

237  (
cmd
*)cmd;

238 
	}
}

240 
cmd
*

241 
	$li°cmd
(
cmd
 *
À·
, cmd *
right
)

243 
li°cmd
 *
cmd
;

245 
cmd
 = 
	`mÆloc
((*cmd));

246 
	`mem£t
(
cmd
, 0, (*cmd));

247 
cmd
->
ty≥
 = 
LIST
;

248 
cmd
->
À·
 =Üeft;

249 
cmd
->
right
 =Ñight;

250  (
cmd
*)cmd;

251 
	}
}

253 
cmd
*

254 
	$backcmd
(
cmd
 *
subcmd
)

256 
backcmd
 *
cmd
;

258 
cmd
 = 
	`mÆloc
((*cmd));

259 
	`mem£t
(
cmd
, 0, (*cmd));

260 
cmd
->
ty≥
 = 
BACK
;

261 
cmd
->cmd = 
subcmd
;

262  (
cmd
*)cmd;

263 
	}
}

267 
	gwhôe•a˚
[] = " \t\r\n\v";

268 
	gsymbﬁs
[] = "<|>&;()";

271 
	$gëtokí
(**
ps
, *
es
, **
q
, **
eq
)

273 *
s
;

274 
ªt
;

276 
s
 = *
ps
;

277 
s
 < 
es
 && 
	`°rchr
(
whôe•a˚
, *s))

278 
s
++;

279 if(
q
)

280 *
q
 = 
s
;

281 
ªt
 = *
s
;

282 *
s
){

291 
s
++;

294 
s
++;

295 if(*
s
 == '>'){

296 
ªt
 = '+';

297 
s
++;

301 
ªt
 = 'a';

302 
s
 < 
es
 && !
	`°rchr
(
whôe•a˚
, *sË&& !°rchr(
symbﬁs
, *s))

303 
s
++;

306 if(
eq
)

307 *
eq
 = 
s
;

309 
s
 < 
es
 && 
	`°rchr
(
whôe•a˚
, *s))

310 
s
++;

311 *
ps
 = 
s
;

312  
ªt
;

313 
	}
}

316 
	$≥ek
(**
ps
, *
es
, *
toks
)

318 *
s
;

320 
s
 = *
ps
;

321 
s
 < 
es
 && 
	`°rchr
(
whôe•a˚
, *s))

322 
s
++;

323 *
ps
 = 
s
;

324  *
s
 && 
	`°rchr
(
toks
, *s);

325 
	}
}

327 
cmd
 *
∑r£löe
(**, *);

328 
cmd
 *
∑r£pùe
(**, *);

329 
cmd
 *
∑r£exec
(**, *);

330 
cmd
 *
nu…îmö©e
(cmd*);

332 
cmd
*

333 
	$∑r£cmd
(*
s
)

335 *
es
;

336 
cmd
 *cmd;

338 
es
 = 
s
 + 
	`°æí
(s);

339 
cmd
 = 
	`∑r£löe
(&
s
, 
es
);

340 
	`≥ek
(&
s
, 
es
, "");

341 if(
s
 !
es
){

342 
	`¥ötf
(2, "À·ovîs: %s\n", 
s
);

343 
	`∑nic
("syntax");

345 
	`nu…îmö©e
(
cmd
);

346  
cmd
;

347 
	}
}

349 
cmd
*

350 
	$∑r£löe
(**
ps
, *
es
)

352 
cmd
 *cmd;

354 
cmd
 = 
	`∑r£pùe
(
ps
, 
es
);

355 
	`≥ek
(
ps
, 
es
, "&")){

356 
	`gëtokí
(
ps
, 
es
, 0, 0);

357 
cmd
 = 
	`backcmd
(cmd);

359 if(
	`≥ek
(
ps
, 
es
, ";")){

360 
	`gëtokí
(
ps
, 
es
, 0, 0);

361 
cmd
 = 
	`li°cmd
(cmd, 
	`∑r£löe
(
ps
, 
es
));

363  
cmd
;

364 
	}
}

366 
cmd
*

367 
	$∑r£pùe
(**
ps
, *
es
)

369 
cmd
 *cmd;

371 
cmd
 = 
	`∑r£exec
(
ps
, 
es
);

372 if(
	`≥ek
(
ps
, 
es
, "|")){

373 
	`gëtokí
(
ps
, 
es
, 0, 0);

374 
cmd
 = 
	`pùecmd
(cmd, 
	`∑r£pùe
(
ps
, 
es
));

376  
cmd
;

377 
	}
}

379 
cmd
*

380 
	$∑r£ªdús
(
cmd
 *cmd, **
ps
, *
es
)

382 
tok
;

383 *
q
, *
eq
;

385 
	`≥ek
(
ps
, 
es
, "<>")){

386 
tok
 = 
	`gëtokí
(
ps
, 
es
, 0, 0);

387 if(
	`gëtokí
(
ps
, 
es
, &
q
, &
eq
) != 'a')

388 
	`∑nic
("missing file forÑedirection");

389 
tok
){

391 
cmd
 = 
	`ªdúcmd
(cmd, 
q
, 
eq
, 
O_RDONLY
, 0);

394 
cmd
 = 
	`ªdúcmd
(cmd, 
q
, 
eq
, 
O_WRONLY
|
O_CREATE
, 1);

397 
cmd
 = 
	`ªdúcmd
(cmd, 
q
, 
eq
, 
O_WRONLY
|
O_CREATE
, 1);

401  
cmd
;

402 
	}
}

404 
cmd
*

405 
	$∑r£block
(**
ps
, *
es
)

407 
cmd
 *cmd;

409 if(!
	`≥ek
(
ps
, 
es
, "("))

410 
	`∑nic
("parseblock");

411 
	`gëtokí
(
ps
, 
es
, 0, 0);

412 
cmd
 = 
	`∑r£löe
(
ps
, 
es
);

413 if(!
	`≥ek
(
ps
, 
es
, ")"))

414 
	`∑nic
("syntax - missing )");

415 
	`gëtokí
(
ps
, 
es
, 0, 0);

416 
cmd
 = 
	`∑r£ªdús
(cmd, 
ps
, 
es
);

417  
cmd
;

418 
	}
}

420 
cmd
*

421 
	$∑r£exec
(**
ps
, *
es
)

423 *
q
, *
eq
;

424 
tok
, 
¨gc
;

425 
execcmd
 *
cmd
;

426 
cmd
 *
ªt
;

428 if(
	`≥ek
(
ps
, 
es
, "("))

429  
	`∑r£block
(
ps
, 
es
);

431 
ªt
 = 
	`execcmd
();

432 
cmd
 = (
execcmd
*)
ªt
;

434 
¨gc
 = 0;

435 
ªt
 = 
	`∑r£ªdús
‘ë, 
ps
, 
es
);

436 !
	`≥ek
(
ps
, 
es
, "|)&;")){

437 if((
tok
=
	`gëtokí
(
ps
, 
es
, &
q
, &
eq
)) == 0)

439 if(
tok
 != 'a')

440 
	`∑nic
("syntax");

441 
cmd
->
¨gv
[
¨gc
] = 
q
;

442 
cmd
->
órgv
[
¨gc
] = 
eq
;

443 
¨gc
++;

444 if(
¨gc
 >
MAXARGS
)

445 
	`∑nic
("too manyárgs");

446 
ªt
 = 
	`∑r£ªdús
‘ë, 
ps
, 
es
);

448 
cmd
->
¨gv
[
¨gc
] = 0;

449 
cmd
->
órgv
[
¨gc
] = 0;

450  
ªt
;

451 
	}
}

454 
cmd
*

455 
	$nu…îmö©e
(
cmd
 *cmd)

457 
i
;

458 
backcmd
 *
bcmd
;

459 
execcmd
 *
ecmd
;

460 
li°cmd
 *
lcmd
;

461 
pùecmd
 *
pcmd
;

462 
ªdúcmd
 *
rcmd
;

464 if(
cmd
 == 0)

467 
cmd
->
ty≥
){

468 
EXEC
:

469 
ecmd
 = (
execcmd
*)
cmd
;

470 
i
=0; 
ecmd
->
¨gv
[i]; i++)

471 *
ecmd
->
órgv
[
i
] = 0;

474 
REDIR
:

475 
rcmd
 = (
ªdúcmd
*)
cmd
;

476 
	`nu…îmö©e
(
rcmd
->
cmd
);

477 *
rcmd
->
efûe
 = 0;

480 
PIPE
:

481 
pcmd
 = (
pùecmd
*)
cmd
;

482 
	`nu…îmö©e
(
pcmd
->
À·
);

483 
	`nu…îmö©e
(
pcmd
->
right
);

486 
LIST
:

487 
lcmd
 = (
li°cmd
*)
cmd
;

488 
	`nu…îmö©e
(
lcmd
->
À·
);

489 
	`nu…îmö©e
(
lcmd
->
right
);

492 
BACK
:

493 
bcmd
 = (
backcmd
*)
cmd
;

494 
	`nu…îmö©e
(
bcmd
->
cmd
);

497  
cmd
;

498 
	}
}

	@sleeplock.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"x86.h
"

7 
	~"memœyout.h
"

8 
	~"mmu.h
"

9 
	~"¥oc.h
"

10 
	~"•ölock.h
"

11 
	~"¶ì∂ock.h
"

14 
	$öô¶ì∂ock
(
¶ì∂ock
 *
lk
, *
«me
)

16 
	`öôlock
(&
lk
->lk, "sleepÜock");

17 
lk
->
«me
 =Çame;

18 
lk
->
locked
 = 0;

19 
lk
->
pid
 = 0;

20 
	}
}

23 
	$acquúe¶ìp
(
¶ì∂ock
 *
lk
)

25 
	`acquúe
(&
lk
->lk);

26 
lk
->
locked
) {

27 
	`¶ìp
(
lk
, &lk->lk);

29 
lk
->
locked
 = 1;

30 
lk
->
pid
 = 
	`my¥oc
()->pid;

31 
	`ªÀa£
(&
lk
->lk);

32 
	}
}

35 
	$ªÀa£¶ìp
(
¶ì∂ock
 *
lk
)

37 
	`acquúe
(&
lk
->lk);

38 
lk
->
locked
 = 0;

39 
lk
->
pid
 = 0;

40 
	`wakeup
(
lk
);

41 
	`ªÀa£
(&
lk
->lk);

42 
	}
}

45 
	$hﬁdög¶ìp
(
¶ì∂ock
 *
lk
)

47 
r
;

49 
	`acquúe
(&
lk
->lk);

50 
r
 = 
lk
->
locked
 && (lk->
pid
 =
	`my¥oc
()->pid);

51 
	`ªÀa£
(&
lk
->lk);

52  
r
;

53 
	}
}

	@sleeplock.h

2 
	s¶ì∂ock
 {

3 
uöt
 
	mlocked
;

4 
•ölock
 
	mlk
;

7 *
	m«me
;

8 
	mpid
;

	@spinlock.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"x86.h
"

7 
	~"memœyout.h
"

8 
	~"mmu.h
"

9 
	~"¥oc.h
"

10 
	~"•ölock.h
"

13 
	$öôlock
(
•ölock
 *
lk
, *
«me
)

15 
lk
->
«me
 =Çame;

16 
lk
->
locked
 = 0;

17 
lk
->
˝u
 = 0;

18 
	}
}

25 
	$acquúe
(
•ölock
 *
lk
)

27 
	`push˛i
();

28 if(
	`hﬁdög
(
lk
))

29 
	`∑nic
("acquire");

32 
	`xchg
(&
lk
->
locked
, 1) != 0)

38 
	`__sync_synchr⁄ize
();

41 
lk
->
˝u
 = 
	`my˝u
();

42 
	`gëˇŒîpcs
(&
lk
,Ük->
pcs
);

43 
	}
}

47 
	$ªÀa£
(
•ölock
 *
lk
)

49 if(!
	`hﬁdög
(
lk
))

50 
	`∑nic
("release");

52 
lk
->
pcs
[0] = 0;

53 
lk
->
˝u
 = 0;

60 
	`__sync_synchr⁄ize
();

65 
asm
 vﬁ©ûe("mov»$0, %0" : "+m" (
lk
->
locked
) : );

67 
	`p›˛i
();

68 
	}
}

72 
	$gëˇŒîpcs
(*
v
, 
uöt
 
pcs
[])

74 
uöt
 *
ebp
;

75 
i
;

77 
ebp
 = (
uöt
*)
v
 - 2;

78 
i
 = 0; i < 10; i++){

79 if(
ebp
 =0 ||Éb∞< (
uöt
*)
KERNBASE
 ||Ébp == (uint*)0xffffffff)

81 
pcs
[
i
] = 
ebp
[1];

82 
ebp
 = (
uöt
*)ebp[0];

84 ; 
i
 < 10; i++)

85 
pcs
[
i
] = 0;

86 
	}
}

90 
	$hﬁdög
(
•ölock
 *
lock
)

92 
r
;

93 
	`push˛i
();

94 
r
 = 
lock
->
locked
 &&Üock->
˝u
 =
	`my˝u
();

95 
	`p›˛i
();

96  
r
;

97 
	}
}

105 
	$push˛i
()

107 
eÊags
;

109 
eÊags
 = 
	`ªadeÊags
();

110 
	`˛i
();

111 if(
	`my˝u
()->
n˛i
 == 0)

112 
	`my˝u
()->
öã«
 = 
eÊags
 & 
FL_IF
;

113 
	`my˝u
()->
n˛i
 += 1;

114 
	}
}

117 
	$p›˛i
()

119 if(
	`ªadeÊags
()&
FL_IF
)

120 
	`∑nic
("popcli - interruptible");

121 if(--
	`my˝u
()->
n˛i
 < 0)

122 
	`∑nic
("popcli");

123 if(
	`my˝u
()->
n˛i
 =0 && my˝u()->
öã«
)

124 
	`°i
();

125 
	}
}

	@spinlock.h

2 
	s•ölock
 {

3 
uöt
 
	mlocked
;

6 *
	m«me
;

7 
˝u
 *
	m˝u
;

8 
uöt
 
	mpcs
[10];

	@stat.h

1 
	#T_DIR
 1

2 
	#T_FILE
 2

3 
	#T_DEV
 3

4 

	)

5 
	s°©
 {

6 
	mty≥
;

7 
	mdev
;

8 
uöt
 
	möo
;

9 
	m∆ök
;

10 
uöt
 
	msize
;

	@stressfs.c

10 
	~"ty≥s.h
"

11 
	~"°©.h
"

12 
	~"u£r.h
"

13 
	~"fs.h
"

14 
	~"f˙é.h
"

17 
	$maö
(
¨gc
, *
¨gv
[])

19 
fd
, 
i
;

20 
∑th
[] = "stressfs0";

21 
d©a
[512];

23 
	`¥ötf
(1, "stressfs starting\n");

24 
	`mem£t
(
d©a
, 'a', (data));

26 
i
 = 0; i < 4; i++)

27 if(
	`f‹k
() > 0)

30 
	`¥ötf
(1, "wrôê%d\n", 
i
);

32 
∑th
[8] +
i
;

33 
fd
 = 
	`›í
(
∑th
, 
O_CREATE
 | 
O_RDWR
);

34 
i
 = 0; i < 20; i++)

36 
	`wrôe
(
fd
, 
d©a
, (data));

37 
	`˛o£
(
fd
);

39 
	`¥ötf
(1, "read\n");

41 
fd
 = 
	`›í
(
∑th
, 
O_RDONLY
);

42 
i
 = 0; i < 20; i++)

43 
	`ªad
(
fd
, 
d©a
, (data));

44 
	`˛o£
(
fd
);

46 
	`waô
();

48 
	`exô
();

49 
	}
}

	@string.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

5 
	$mem£t
(*
d°
, 
c
, 
uöt
 
n
)

7 i‡(()
d°
%4 =0 && 
n
%4 == 0){

8 
c
 &= 0xFF;

9 
	`°o¶
(
d°
, (
c
<<24)|(c<<16)|(c<<8)|c, 
n
/4);

11 
	`°osb
(
d°
, 
c
, 
n
);

12  
d°
;

13 
	}
}

16 
	$memcmp
(c⁄° *
v1
, c⁄° *
v2
, 
uöt
 
n
)

18 c⁄° 
uch¨
 *
s1
, *
s2
;

20 
s1
 = 
v1
;

21 
s2
 = 
v2
;

22 
n
-- > 0){

23 if(*
s1
 !*
s2
)

24  *
s1
 - *
s2
;

25 
s1
++, 
s2
++;

29 
	}
}

32 
	$memmove
(*
d°
, c⁄° *
§c
, 
uöt
 
n
)

34 c⁄° *
s
;

35 *
d
;

37 
s
 = 
§c
;

38 
d
 = 
d°
;

39 if(
s
 < 
d
 && s + 
n
 > d){

40 
s
 +
n
;

41 
d
 +
n
;

42 
n
-- > 0)

43 *--
d
 = *--
s
;

45 
n
-- > 0)

46 *
d
++ = *
s
++;

48  
d°
;

49 
	}
}

53 
	$mem˝y
(*
d°
, c⁄° *
§c
, 
uöt
 
n
)

55  
	`memmove
(
d°
, 
§c
, 
n
);

56 
	}
}

59 
	$°∫cmp
(c⁄° *
p
, c⁄° *
q
, 
uöt
 
n
)

61 
n
 > 0 && *
p
 && *∞=*
q
)

62 
n
--, 
p
++, 
q
++;

63 if(
n
 == 0)

65  (
uch¨
)*
p
 - (uch¨)*
q
;

66 
	}
}

69 
	$°∫˝y
(*
s
, c⁄° *
t
, 
n
)

71 *
os
;

73 
os
 = 
s
;

74 
n
-- > 0 && (*
s
++ = *
t
++) != 0)

76 
n
-- > 0)

77 *
s
++ = 0;

78  
os
;

79 
	}
}

83 
	$ß„°r˝y
(*
s
, c⁄° *
t
, 
n
)

85 *
os
;

87 
os
 = 
s
;

88 if(
n
 <= 0)

89  
os
;

90 --
n
 > 0 && (*
s
++ = *
t
++) != 0)

92 *
s
 = 0;

93  
os
;

94 
	}
}

97 
	$°æí
(c⁄° *
s
)

99 
n
;

101 
n
 = 0; 
s
[n];Ç++)

103  
n
;

104 
	}
}

	@swtch.S

2 #
#void 
swtch
(
c⁄ãxt
 **
ﬁd
, c⁄ãxà*
√w
);

4 #
#Savê
the
 
cuºít
 
ªgi°îs
 
⁄
Åhê
°ack
, 
¸ótög


6 #®
c⁄ãxt
, 
™d
 
ßve
 
ôs
 
addªss
 
ö
 *
ﬁd
.

7 #Swôch 
°acks
 
to
 
√w
 
™d
 
p›
 
¥eviou¶y
-
ßved
 
ªgi°îs
.

9 .
globl
 
swtch


10 
	gswtch
:

11 
movl
 4(%
e•
), %
óx


12 
	gmovl
 8(%
	ge•
), %
	gedx


14 #Savê
ﬁd
 
ˇŒì
-
ßved
 
ªgi°îs


15 
	gpushl
 %
ebp


16 
	gpushl
 %
ebx


17 
	gpushl
 %
esi


18 
	gpushl
 %
	gedi


20 #Swôch 
°acks


21 
	gmovl
 %
	ge•
, (%
	góx
)

22 
	gmovl
 %
	gedx
, %
	ge•


24 #Lﬂd 
√w
 
ˇŒì
-
ßved
 
ªgi°îs


25 
	gp›l
 %
edi


26 
	gp›l
 %
esi


27 
	gp›l
 %
ebx


28 
	gp›l
 %
ebp


29 
	gªt


	@syscall.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

8 
	~"sysˇŒ.h
"

18 
	$„tchöt
(
uöt
 
addr
, *
ù
)

20 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

22 if(
addr
 >
cuΩroc
->
sz
 ||áddr+4 > curproc->sz)

24 *
ù
 = *(*)(
addr
);

26 
	}
}

32 
	$„tch°r
(
uöt
 
addr
, **
µ
)

34 *
s
, *
ï
;

35 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

37 if(
addr
 >
cuΩroc
->
sz
)

39 *
µ
 = (*)
addr
;

40 
ï
 = (*)
cuΩroc
->
sz
;

41 
s
 = *
µ
; s < 
ï
; s++){

42 if(*
s
 == 0)

43  
s
 - *
µ
;

46 
	}
}

50 
	$¨göt
(
n
, *
ù
)

52  
	`„tchöt
((
	`my¥oc
()->
tf
->
e•
Ë+ 4 + 4*
n
, 
ù
);

53 
	}
}

59 
	$¨g±r
(
n
, **
µ
, 
size
)

61 
i
;

62 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

64 if(
	`¨göt
(
n
, &
i
) < 0)

66 if(
size
 < 0 || (
uöt
)
i
 >
cuΩroc
->
sz
 || (uint)i+size > curproc->sz)

68 *
µ
 = (*)
i
;

70 
	}
}

77 
	$¨g°r
(
n
, **
µ
)

79 
addr
;

80 if(
	`¨göt
(
n
, &
addr
) < 0)

82  
	`„tch°r
(
addr
, 
µ
);

83 
	}
}

85 
sys_chdú
();

86 
sys_˛o£
();

87 
sys_dup
();

88 
sys_exec
();

89 
sys_exô
();

90 
sys_f‹k
();

91 
sys_f°©
();

92 
sys_gëpid
();

93 
sys_kûl
();

94 
sys_lök
();

95 
sys_mkdú
();

96 
sys_mknod
();

97 
sys_›í
();

98 
sys_pùe
();

99 
sys_ªad
();

100 
sys_sbrk
();

101 
sys_¶ìp
();

102 
sys_u∆ök
();

103 
sys_waô
();

104 
sys_wrôe
();

105 
sys_u±ime
();

107 
sys_£t_˝u_sh¨e
();

108 
sys_gëÀv
();

109 
sys_yõld
();

110 
sys_myfun˘i⁄
();

111 
sys_gëµid
();

112 
sys_queue_èbÀ_lookup
();

114 
sys_thªad_¸óã
();

115 
sys_thªad_exô
();

116 
sys_thªad_joö
();

125 (*
sysˇŒs
[])() = {

126 [
SYS_f‹k
] 
sys_f‹k
,

127 [
SYS_exô
] 
sys_exô
,

128 [
SYS_waô
] 
sys_waô
,

129 [
SYS_pùe
] 
sys_pùe
,

130 [
SYS_ªad
] 
sys_ªad
,

131 [
SYS_kûl
] 
sys_kûl
,

132 [
SYS_exec
] 
sys_exec
,

133 [
SYS_f°©
] 
sys_f°©
,

134 [
SYS_chdú
] 
sys_chdú
,

135 [
SYS_dup
] 
sys_dup
,

136 [
SYS_gëpid
] 
sys_gëpid
,

137 [
SYS_sbrk
] 
sys_sbrk
,

138 [
SYS_¶ìp
] 
sys_¶ìp
,

139 [
SYS_u±ime
] 
sys_u±ime
,

140 [
SYS_›í
] 
sys_›í
,

141 [
SYS_wrôe
] 
sys_wrôe
,

142 [
SYS_mknod
] 
sys_mknod
,

143 [
SYS_u∆ök
] 
sys_u∆ök
,

144 [
SYS_lök
] 
sys_lök
,

145 [
SYS_mkdú
] 
sys_mkdú
,

146 [
SYS_˛o£
] 
sys_˛o£
,

148 [
SYS_yõld
] 
sys_yõld
,

149 [
SYS_£t_˝u_sh¨e
] 
sys_£t_˝u_sh¨e
,

150 [
SYS_gëÀv
] 
sys_gëÀv
,

152 [
SYS_queue_èbÀ_lookup
] 
sys_queue_èbÀ_lookup
,

154 [
SYS_thªad_¸óã
] 
sys_thªad_¸óã
,

155 [
SYS_thªad_exô
] 
sys_thªad_exô
,

156 [
SYS_thªad_joö
] 
sys_thªad_joö
,

157 
	}
};

166 
	$sysˇŒ
()

168 
num
;

169 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

171 
num
 = 
cuΩroc
->
tf
->
óx
;

172 if(
num
 > 0 &&Çum < 
	`NELEM
(
sysˇŒs
) && syscalls[num]) {

173 
cuΩroc
->
tf
->
óx
 = 
sysˇŒs
[
num
]();

175 
	`˝rötf
("%d %s: unknown sys call %d\n",

176 
cuΩroc
->
pid
, cuΩroc->
«me
, 
num
);

177 
cuΩroc
->
tf
->
óx
 = -1;

179 
	}
}

	@syscall.h

2 
	#SYS_f‹k
 1

	)

3 
	#SYS_exô
 2

	)

4 
	#SYS_waô
 3

	)

5 
	#SYS_pùe
 4

	)

6 
	#SYS_ªad
 5

	)

7 
	#SYS_kûl
 6

	)

8 
	#SYS_exec
 7

	)

9 
	#SYS_f°©
 8

	)

10 
	#SYS_chdú
 9

	)

11 
	#SYS_dup
 10

	)

12 
	#SYS_gëpid
 11

	)

13 
	#SYS_sbrk
 12

	)

14 
	#SYS_¶ìp
 13

	)

15 
	#SYS_u±ime
 14

	)

16 
	#SYS_›í
 15

	)

17 
	#SYS_wrôe
 16

	)

18 
	#SYS_mknod
 17

	)

19 
	#SYS_u∆ök
 18

	)

20 
	#SYS_lök
 19

	)

21 
	#SYS_mkdú
 20

	)

22 
	#SYS_˛o£
 21

	)

24 
	#SYS_yõld
 22

	)

25 
	#SYS_£t_˝u_sh¨e
 23

	)

26 
	#SYS_gëÀv
 24

	)

28 
	#SYS_queue_èbÀ_lookup
 25

	)

30 
	#SYS_thªad_¸óã
 26

	)

31 
	#SYS_thªad_joö
 27

	)

32 
	#SYS_thªad_exô
 28

	)

	@sysfile.c

7 
	~"ty≥s.h
"

8 
	~"defs.h
"

9 
	~"∑øm.h
"

10 
	~"°©.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

13 
	~"fs.h
"

14 
	~"•ölock.h
"

15 
	~"¶ì∂ock.h
"

16 
	~"fûe.h
"

17 
	~"f˙é.h
"

22 
	$¨gfd
(
n
, *
pfd
, 
fûe
 **
pf
)

24 
fd
;

25 
fûe
 *
f
;

27 if(
	`¨göt
(
n
, &
fd
) < 0)

29 if(
fd
 < 0 || fd >
NOFILE
 || (
f
=
	`my¥oc
()->
ofûe
[fd]) == 0)

31 if(
pfd
)

32 *
pfd
 = 
fd
;

33 if(
pf
)

34 *
pf
 = 
f
;

36 
	}
}

41 
	$fdÆloc
(
fûe
 *
f
)

43 
fd
;

44 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

46 
fd
 = 0; fd < 
NOFILE
; fd++){

47 if(
cuΩroc
->
ofûe
[
fd
] == 0){

48 
cuΩroc
->
ofûe
[
fd
] = 
f
;

49  
fd
;

53 
	}
}

56 
	$sys_dup
()

58 
fûe
 *
f
;

59 
fd
;

61 if(
	`¨gfd
(0, 0, &
f
) < 0)

63 if((
fd
=
	`fdÆloc
(
f
)) < 0)

65 
	`fûedup
(
f
);

66  
fd
;

67 
	}
}

70 
	$sys_ªad
()

72 
fûe
 *
f
;

73 
n
;

74 *
p
;

76 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨göt
(2, &
n
Ë< 0 || 
	`¨g±r
(1, &
p
,Ç) < 0)

78  
	`fûîód
(
f
, 
p
, 
n
);

79 
	}
}

82 
	$sys_wrôe
()

84 
fûe
 *
f
;

85 
n
;

86 *
p
;

88 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨göt
(2, &
n
Ë< 0 || 
	`¨g±r
(1, &
p
,Ç) < 0)

90  
	`fûewrôe
(
f
, 
p
, 
n
);

91 
	}
}

94 
	$sys_˛o£
()

96 
fd
;

97 
fûe
 *
f
;

99 if(
	`¨gfd
(0, &
fd
, &
f
) < 0)

101 
	`my¥oc
()->
ofûe
[
fd
] = 0;

102 
	`fûe˛o£
(
f
);

104 
	}
}

107 
	$sys_f°©
()

109 
fûe
 *
f
;

110 
°©
 *
°
;

112 if(
	`¨gfd
(0, 0, &
f
Ë< 0 || 
	`¨g±r
(1, (*)&
°
, (*st)) < 0)

114  
	`fûe°©
(
f
, 
°
);

115 
	}
}

119 
	$sys_lök
()

121 
«me
[
DIRSIZ
], *
√w
, *
ﬁd
;

122 
öode
 *
dp
, *
ù
;

124 if(
	`¨g°r
(0, &
ﬁd
Ë< 0 ||árg°r(1, &
√w
) < 0)

127 
	`begö_›
();

128 if((
ù
 = 
	`«mei
(
ﬁd
)) == 0){

129 
	`íd_›
();

133 
	`ûock
(
ù
);

134 if(
ù
->
ty≥
 =
T_DIR
){

135 
	`iu∆ockput
(
ù
);

136 
	`íd_›
();

140 
ù
->
∆ök
++;

141 
	`iupd©e
(
ù
);

142 
	`iu∆ock
(
ù
);

144 if((
dp
 = 
	`«meù¨ít
(
√w
, 
«me
)) == 0)

145 
bad
;

146 
	`ûock
(
dp
);

147 if(
dp
->
dev
 !
ù
->dev || 
	`dúlök
(dp, 
«me
, ip->
öum
) < 0){

148 
	`iu∆ockput
(
dp
);

149 
bad
;

151 
	`iu∆ockput
(
dp
);

152 
	`ùut
(
ù
);

154 
	`íd_›
();

158 
bad
:

159 
	`ûock
(
ù
);

160 
ù
->
∆ök
--;

161 
	`iupd©e
(
ù
);

162 
	`iu∆ockput
(
ù
);

163 
	`íd_›
();

165 
	}
}

169 
	$isdúem±y
(
öode
 *
dp
)

171 
off
;

172 
dúít
 
de
;

174 
off
=2*(
de
); off<
dp
->
size
; off+=(de)){

175 if(
	`ªadi
(
dp
, (*)&
de
, 
off
, (de)) != (de))

176 
	`∑nic
("isdirempty:Ñeadi");

177 if(
de
.
öum
 != 0)

181 
	}
}

185 
	$sys_u∆ök
()

187 
öode
 *
ù
, *
dp
;

188 
dúít
 
de
;

189 
«me
[
DIRSIZ
], *
∑th
;

190 
uöt
 
off
;

192 if(
	`¨g°r
(0, &
∑th
) < 0)

195 
	`begö_›
();

196 if((
dp
 = 
	`«meù¨ít
(
∑th
, 
«me
)) == 0){

197 
	`íd_›
();

201 
	`ûock
(
dp
);

204 if(
	`«mecmp
(
«me
, ".") == 0 ||Çamecmp(name, "..") == 0)

205 
bad
;

207 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, &
off
)) == 0)

208 
bad
;

209 
	`ûock
(
ù
);

211 if(
ù
->
∆ök
 < 1)

212 
	`∑nic
("unlink:Çlink < 1");

213 if(
ù
->
ty≥
 =
T_DIR
 && !
	`isdúem±y
(ip)){

214 
	`iu∆ockput
(
ù
);

215 
bad
;

218 
	`mem£t
(&
de
, 0, (de));

219 if(
	`wrôei
(
dp
, (*)&
de
, 
off
, (de)) != (de))

220 
	`∑nic
("unlink: writei");

221 if(
ù
->
ty≥
 =
T_DIR
){

222 
dp
->
∆ök
--;

223 
	`iupd©e
(
dp
);

225 
	`iu∆ockput
(
dp
);

227 
ù
->
∆ök
--;

228 
	`iupd©e
(
ù
);

229 
	`iu∆ockput
(
ù
);

231 
	`íd_›
();

235 
bad
:

236 
	`iu∆ockput
(
dp
);

237 
	`íd_›
();

239 
	}
}

241 
öode
*

242 
	$¸óã
(*
∑th
, 
ty≥
, 
maj‹
, 
mö‹
)

244 
öode
 *
ù
, *
dp
;

245 
«me
[
DIRSIZ
];

247 if((
dp
 = 
	`«meù¨ít
(
∑th
, 
«me
)) == 0)

249 
	`ûock
(
dp
);

251 if((
ù
 = 
	`dúlookup
(
dp
, 
«me
, 0)) != 0){

252 
	`iu∆ockput
(
dp
);

253 
	`ûock
(
ù
);

254 if(
ty≥
 =
T_FILE
 && 
ù
->type == T_FILE)

255  
ù
;

256 
	`iu∆ockput
(
ù
);

260 if((
ù
 = 
	`üŒoc
(
dp
->
dev
, 
ty≥
)) == 0)

261 
	`∑nic
("create: ialloc");

263 
	`ûock
(
ù
);

264 
ù
->
maj‹
 = major;

265 
ù
->
mö‹
 = minor;

266 
ù
->
∆ök
 = 1;

267 
	`iupd©e
(
ù
);

269 if(
ty≥
 =
T_DIR
){

270 
dp
->
∆ök
++;

271 
	`iupd©e
(
dp
);

273 if(
	`dúlök
(
ù
, ".", ip->
öum
Ë< 0 || dúlök(ù, "..", 
dp
->inum) < 0)

274 
	`∑nic
("create dots");

277 if(
	`dúlök
(
dp
, 
«me
, 
ù
->
öum
) < 0)

278 
	`∑nic
("create: dirlink");

280 
	`iu∆ockput
(
dp
);

282  
ù
;

283 
	}
}

286 
	$sys_›í
()

288 *
∑th
;

289 
fd
, 
omode
;

290 
fûe
 *
f
;

291 
öode
 *
ù
;

293 if(
	`¨g°r
(0, &
∑th
Ë< 0 || 
	`¨göt
(1, &
omode
) < 0)

296 
	`begö_›
();

298 if(
omode
 & 
O_CREATE
){

299 
ù
 = 
	`¸óã
(
∑th
, 
T_FILE
, 0, 0);

300 if(
ù
 == 0){

301 
	`íd_›
();

305 if((
ù
 = 
	`«mei
(
∑th
)) == 0){

306 
	`íd_›
();

309 
	`ûock
(
ù
);

310 if(
ù
->
ty≥
 =
T_DIR
 && 
omode
 !
O_RDONLY
){

311 
	`iu∆ockput
(
ù
);

312 
	`íd_›
();

317 if((
f
 = 
	`fûóŒoc
()Ë=0 || (
fd
 = 
	`fdÆloc
(f)) < 0){

318 if(
f
)

319 
	`fûe˛o£
(
f
);

320 
	`iu∆ockput
(
ù
);

321 
	`íd_›
();

324 
	`iu∆ock
(
ù
);

325 
	`íd_›
();

327 
f
->
ty≥
 = 
FD_INODE
;

328 
f
->
ù
 = ip;

329 
f
->
off
 = 0;

330 
f
->
ªadabÀ
 = !(
omode
 & 
O_WRONLY
);

331 
f
->
wrôabÀ
 = (
omode
 & 
O_WRONLY
Ë|| (omodê& 
O_RDWR
);

332  
fd
;

333 
	}
}

336 
	$sys_mkdú
()

338 *
∑th
;

339 
öode
 *
ù
;

341 
	`begö_›
();

342 if(
	`¨g°r
(0, &
∑th
Ë< 0 || (
ù
 = 
	`¸óã
’©h, 
T_DIR
, 0, 0)) == 0){

343 
	`íd_›
();

346 
	`iu∆ockput
(
ù
);

347 
	`íd_›
();

349 
	}
}

352 
	$sys_mknod
()

354 
öode
 *
ù
;

355 *
∑th
;

356 
maj‹
, 
mö‹
;

358 
	`begö_›
();

359 if((
	`¨g°r
(0, &
∑th
)) < 0 ||

360 
	`¨göt
(1, &
maj‹
) < 0 ||

361 
	`¨göt
(2, &
mö‹
) < 0 ||

362 (
ù
 = 
	`¸óã
(
∑th
, 
T_DEV
, 
maj‹
, 
mö‹
)) == 0){

363 
	`íd_›
();

366 
	`iu∆ockput
(
ù
);

367 
	`íd_›
();

369 
	}
}

372 
	$sys_chdú
()

374 *
∑th
;

375 
öode
 *
ù
;

376 
¥oc
 *
cuΩroc
 = 
	`my¥oc
();

378 
	`begö_›
();

379 if(
	`¨g°r
(0, &
∑th
Ë< 0 || (
ù
 = 
	`«mei
(path)) == 0){

380 
	`íd_›
();

383 
	`ûock
(
ù
);

384 if(
ù
->
ty≥
 !
T_DIR
){

385 
	`iu∆ockput
(
ù
);

386 
	`íd_›
();

389 
	`iu∆ock
(
ù
);

390 
	`ùut
(
cuΩroc
->
cwd
);

391 
	`íd_›
();

392 
cuΩroc
->
cwd
 = 
ù
;

394 
	}
}

397 
	$sys_exec
()

399 *
∑th
, *
¨gv
[
MAXARG
];

400 
i
;

401 
uöt
 
u¨gv
, 
u¨g
;

403 if(
	`¨g°r
(0, &
∑th
Ë< 0 || 
	`¨göt
(1, (*)&
u¨gv
) < 0){

406 
	`mem£t
(
¨gv
, 0, (argv));

407 
i
=0;; i++){

408 if(
i
 >
	`NELEM
(
¨gv
))

410 if(
	`„tchöt
(
u¨gv
+4*
i
, (*)&
u¨g
) < 0)

412 if(
u¨g
 == 0){

413 
¨gv
[
i
] = 0;

416 if(
	`„tch°r
(
u¨g
, &
¨gv
[
i
]) < 0)

419  
	`exec
(
∑th
, 
¨gv
);

420 
	}
}

423 
	$sys_pùe
()

425 *
fd
;

426 
fûe
 *
rf
, *
wf
;

427 
fd0
, 
fd1
;

429 if(
	`¨g±r
(0, (*)&
fd
, 2*(fd[0])) < 0)

431 if(
	`pùóŒoc
(&
rf
, &
wf
) < 0)

433 
fd0
 = -1;

434 if((
fd0
 = 
	`fdÆloc
(
rf
)Ë< 0 || (
fd1
 = fdÆloc(
wf
)) < 0){

435 if(
fd0
 >= 0)

436 
	`my¥oc
()->
ofûe
[
fd0
] = 0;

437 
	`fûe˛o£
(
rf
);

438 
	`fûe˛o£
(
wf
);

441 
fd
[0] = 
fd0
;

442 
fd
[1] = 
fd1
;

444 
	}
}

	@sysproc.c

1 
	~"ty≥s.h
"

2 
	~"x86.h
"

3 
	~"defs.h
"

4 
	~"d©e.h
"

5 
	~"∑øm.h
"

6 
	~"memœyout.h
"

7 
	~"mmu.h
"

8 
	~"¥oc.h
"

37 
	$sys_thªad_¸óã
()

39 
thªad_t
 *
thªad_
;

40 * (*
°¨t_rou¡öe_
)(*);

41 *
¨g_
;

43 if(
	`¨g±r
(0, (*)&
thªad_
,(*thread_)) < 0 ||

44 
	`¨g±r
(1, (*)&
°¨t_rou¡öe_
,(*start_rountine_)) < 0 ||

45 
	`¨g±r
(2, (*)&
¨g_
,(*arg_)) < 0)

48  
	`thªad_¸óã
(
thªad_
, 
°¨t_rou¡öe_
, 
¨g_
);

49 
	}
}

52 
	$sys_thªad_exô
()

54 *
ªtvÆ_
;

55 if(
	`¨göt
(0, (*)&
ªtvÆ_
) < 0)

58 
	`thªad_exô
(
ªtvÆ_
);

60 
	}
}

63 
	$sys_thªad_joö
()

65 
thªad_t
 
thªad_
;

66 **
ªtvÆ_
;

68 if(
	`¨göt
(0, (*)&
thªad_
) < 0

69 ||
	`¨göt
(1, (*)&
ªtvÆ_
) < 0)

72  
	`thªad_joö
(
thªad_
, 
ªtvÆ_
);

73 
	}
}

80 
	$sys_queue_èbÀ_lookup
()

82 
	`queue_èbÀ_lookup
();

84 
	}
}

88 
	$sys_yõld
()

90 
	`my¥oc
()->
‰om_å≠
 = 0;

91 
	`yõld
();

93 
	}
}

97 
	$sys_gëÀv
()

99  
	`gëÀv
();

100 
	}
}

103 
	$sys_£t_˝u_sh¨e
()

105 
sh¨e_
;

106 if(
	`¨göt
(0, &
sh¨e_
) < 0)

108  
	`£t_˝u_sh¨e
(
sh¨e_
)

109 ;
	}
}

112 
	$sys_f‹k
()

114  
	`f‹k
();

115 
	}
}

118 
	$sys_exô
()

120 
	`exô
();

122 
	}
}

125 
	$sys_waô
()

127  
	`waô
();

128 
	}
}

131 
	$sys_kûl
()

133 
pid
;

135 if(
	`¨göt
(0, &
pid
) < 0)

137  
	`kûl
(
pid
);

138 
	}
}

141 
	$sys_gëpid
()

143  
	`my¥oc
()->
pid
;

144 
	}
}

147 
	$sys_gëµid
()

149  
	`my¥oc
()->
∑ª¡
->
pid
;

150 
	}
}

153 
	$sys_sbrk
()

155 
addr
;

156 
n
;

158 if(
	`¨göt
(0, &
n
) < 0)

160 
addr
 = 
	`my¥oc
()->
sz
;

161 if(
	`grow¥oc
(
n
) < 0)

163  
addr
;

164 
	}
}

167 
	$sys_¶ìp
()

169 
n
;

170 
uöt
 
ticks0
;

172 if(
	`¨göt
(0, &
n
) < 0)

174 
	`acquúe
(&
tick¶ock
);

175 
ticks0
 = 
ticks
;

176 
ticks
 - 
ticks0
 < 
n
){

177 if(
	`my¥oc
()->
kûÀd
){

178 
	`ªÀa£
(&
tick¶ock
);

181 
	`¶ìp
(&
ticks
, &
tick¶ock
);

183 
	`ªÀa£
(&
tick¶ock
);

185 
	}
}

190 
	$sys_u±ime
()

192 
uöt
 
xticks
;

194 
	`acquúe
(&
tick¶ock
);

195 
xticks
 = 
ticks
;

196 
	`ªÀa£
(&
tick¶ock
);

197  
xticks
;

198 
	}
}

	@trap.c

1 
	~"ty≥s.h
"

2 
	~"defs.h
"

3 
	~"∑øm.h
"

4 
	~"memœyout.h
"

5 
	~"mmu.h
"

6 
	~"¥oc.h
"

7 
	~"x86.h
"

8 
	~"å≠s.h
"

9 
	~"•ölock.h
"

12 
g©edesc
 
	gidt
[256];

13 
uöt
 
ve˘‹s
[];

14 
•ölock
 
	gtick¶ock
;

16 
uöt
 
	gticks
;

17 
uöt
 
	gMLFQ_ticks
;

19 #i‚de‡
STRIDE_LEV


20 
	#STRIDE_LEV
 (9)

	)

23 #i‚de‡
STRIDE_DEFAULT_TIME_QUANTOM


24 
	#STRIDE_DEFAULT_TIME_QUANTOM
 (5)

	)

27 #i‚de‡
PERIOD_BOOSTING


28 
	#PERIOD_BOOSTING
 (200)

	)

31 
	gtime_qu™tom
[10] = {5,10,20};

32 
	gtime_ÆlŸmít
[10] = {20,40,0};

35 
	$tvöô
()

37 
i
;

39 
i
 = 0; i < 256; i++)

40 
	`SETGATE
(
idt
[
i
], 0, 
SEG_KCODE
<<3, 
ve˘‹s
[i], 0);

41 
	`SETGATE
(
idt
[
T_SYSCALL
], 1, 
SEG_KCODE
<<3, 
ve˘‹s
[T_SYSCALL], 
DPL_USER
);

43 
	`öôlock
(&
tick¶ock
, "time");

44 
	}
}

47 
	$idtöô
()

49 
	`lidt
(
idt
, (idt));

50 
	}
}

54 
	$å≠
(
å≠‰ame
 *
tf
)

56 if(
tf
->
å≠no
 =
T_SYSCALL
){

57 if(
	`my¥oc
()->
kûÀd
)

58 
	`exô
();

59 
	`my¥oc
()->
tf
 =Åf;

60 
	`sysˇŒ
();

61 if(
	`my¥oc
()->
kûÀd
)

62 
	`exô
();

66 
tf
->
å≠no
){

67 
T_IRQ0
 + 
IRQ_TIMER
:

68 if(
	`˝uid
() == 0){

69 
	`acquúe
(&
tick¶ock
);

70 
ticks
++;

71 
	`wakeup
(&
ticks
);

72 
	`ªÀa£
(&
tick¶ock
);

74 
	`œpi˚oi
();

76 
T_IRQ0
 + 
IRQ_IDE
:

77 
	`ideöå
();

78 
	`œpi˚oi
();

80 
T_IRQ0
 + 
IRQ_IDE
+1:

83 
T_IRQ0
 + 
IRQ_KBD
:

84 
	`kbdöå
();

85 
	`œpi˚oi
();

87 
T_IRQ0
 + 
IRQ_COM1
:

88 
	`u¨töå
();

89 
	`œpi˚oi
();

91 
T_IRQ0
 + 7:

92 
T_IRQ0
 + 
IRQ_SPURIOUS
:

93 
	`˝rötf
("cpu%d: spurious interruptát %x:%x\n",

94 
	`˝uid
(), 
tf
->
cs
,Åf->
eù
);

95 
	`œpi˚oi
();

100 if(
	`my¥oc
(Ë=0 || (
tf
->
cs
&3) == 0){

102 
	`˝rötf
("unexpectedÅrap %d from cpu %dÉip %x (cr2=0x%x)\n",

103 
tf
->
å≠no
, 
	`˝uid
(),Åf->
eù
, 
	`r¸2
());

104 
	`∑nic
("trap");

107 
	`˝rötf
("pid %d %s:Årap %dÉrr %d on cpu %d "

109 
	`my¥oc
()->
pid
, my¥oc()->
«me
, 
tf
->
å≠no
,

110 
tf
->
îr
, 
	`˝uid
(),Åf->
eù
, 
	`r¸2
());

111 
	`my¥oc
()->
kûÀd
 = 1;

117 if(
	`my¥oc
(Ë&& my¥oc()->
kûÀd
 && (
tf
->
cs
&3Ë=
DPL_USER
)

118 
	`exô
();

122 if(
	`my¥oc
()

123 && 
	`my¥oc
()->
°©e
 =
RUNNING


124 && 
tf
->
å≠no
 =
T_IRQ0
+
IRQ_TIMER
){

126 
¥oc
* 
p
 = 
	`my¥oc
();

129 if(
p
->
sh¨e
 == 0){

132 
	`acquúe
(&
tick¶ock
);

134 
MLFQ_ticks
++;

135 
	`ªÀa£
(&
tick¶ock
);

145 if(! (
MLFQ_ticks
%
PERIOD_BOOSTING
) )

146 
	`boo°
();

153 if(
p
 -> 
num_thªad
 == 0){

154 
p
 -> 
time_ÆlŸmít
--;

164 if(–
p
->
time_ÆlŸmít
 % 
time_qu™tom
[p->
Àv
] ) != 0){

173 
p
->
‰om_å≠
 = 1;

174 
	`yõld
();

181 
p
->
time_ÆlŸmít
--;

182 if–(
p
->
time_ÆlŸmít
%
time_qu™tom
[p->
Àv
])!=0 ){

188 
¥oc
* 
µ
 = 
p
->
∑ª¡
;

189 
thªad
* 
¡
 = 
NULL
;

194 
i
=1;i<=
µ
->
num_thªad
;i++){

196 
idx
 = (
p
->
tid
+
i
)%
µ
->
num_thªad
+1;

197 
	`˝rötf
("[%d/%d]\n",
idx
,
µ
->
num_thªad
);

198 
¡
 = 
µ
->
thªads
[
idx
];

200 if(
¡
->
°©e
!=
RUNNABLE
)

203 
p
->
°©e
 = 
RUNNABLE
;

204 
	`swtch
(&
p
->
c⁄ãxt
, 
¡
->context);

208 
	`∑nic
("threadÅoÑunÇot found");

218 
p
->
‰om_å≠
 = 1;

219 
	`yõld
();

226 if(
	`my¥oc
()

227 && 
	`my¥oc
()->
kûÀd


228 && (
tf
->
cs
&3Ë=
DPL_USER
)

229 
	`exô
();

230 
	}
}

	@trapasm.S

1 
	~"mmu.h
"

3 #ve˘‹s.
S
 
£nds
 
Æl
 
å≠s
 
hîe
.

4 .
globl
 
Æ…øps


5 
	gÆ…øps
:

6 #Buûd 
å≠
 
‰ame
.

7 
pushl
 %
ds


8 
pushl
 %
es


9 
pushl
 %
fs


10 
pushl
 %
gs


11 
pushÆ


13 #Së 
up
 
d©a
 
£gmíts
.

14 
movw
 
$
(
SEG_KDATA
<<3), %
ax


15 
	gmovw
 %
	gax
, %
ds


16 
	gmovw
 %
	gax
, %
	ges


18 #CÆ»
å≠
(
tf
), 
whîe
Åf=%
e•


19 
	gpushl
 %
e•


20 
ˇŒ
 
å≠


21 
addl
 
	g$4
, %
	ge•


23 #Rëu∫ 
ÁŒs
 
through
 
to
 
å≠ªt
...

24 .
globl
 
å≠ªt


25 
	gå≠ªt
:

26 
p›Æ


27 
p›l
 %
gs


28 
p›l
 %
fs


29 
p›l
 %
es


30 
p›l
 %
ds


31 
addl
 
$0x8
, %
	ge•
 #å≠nÿ
™d
 
îrcode


32 
	gúë


	@traps.h

4 
	#T_DIVIDE
 0

5 
	#T_DEBUG
 1

6 
	#T_NMI
 2

7 
	#T_BRKPT
 3

8 
	#T_OFLOW
 4

9 
	#T_BOUND
 5

10 
	#T_ILLOP
 6

11 
	#T_DEVICE
 7

12 
	#T_DBLFLT
 8

14 
	#T_TSS
 10

15 
	#T_SEGNP
 11

16 
	#T_STACK
 12

17 
	#T_GPFLT
 13

18 
	#T_PGFLT
 14

20 
	#T_FPERR
 16

21 
	#T_ALIGN
 17

22 
	#T_MCHK
 18

23 
	#T_SIMDERR
 19

24 

	)

27 
	#T_SYSCALL
 64

28 
	#T_DEFAULT
 500

29 

	)

30 
	#T_IRQ0
 32

31 

	)

32 
	#IRQ_TIMER
 0

	)

33 
	#IRQ_KBD
 1

	)

34 
	#IRQ_COM1
 4

	)

35 
	#IRQ_IDE
 14

	)

36 
	#IRQ_ERROR
 19

	)

37 
	#IRQ_SPURIOUS
 31

	)

	@types.h

1 
	tuöt
;

2 
	tush‹t
;

3 
	tuch¨
;

4 
uöt
 
	tpde_t
;

5 
	tthªad_t
;

	@uart.c

3 
	~"ty≥s.h
"

4 
	~"defs.h
"

5 
	~"∑øm.h
"

6 
	~"å≠s.h
"

7 
	~"•ölock.h
"

8 
	~"¶ì∂ock.h
"

9 
	~"fs.h
"

10 
	~"fûe.h
"

11 
	~"mmu.h
"

12 
	~"¥oc.h
"

13 
	~"x86.h
"

15 
	#COM1
 0x3f8

	)

17 
	gu¨t
;

20 
	$u¨töô
()

22 *
p
;

25 
	`outb
(
COM1
+2, 0);

28 
	`outb
(
COM1
+3, 0x80);

29 
	`outb
(
COM1
+0, 115200/9600);

30 
	`outb
(
COM1
+1, 0);

31 
	`outb
(
COM1
+3, 0x03);

32 
	`outb
(
COM1
+4, 0);

33 
	`outb
(
COM1
+1, 0x01);

36 if(
	`öb
(
COM1
+5) == 0xFF)

38 
u¨t
 = 1;

42 
	`öb
(
COM1
+2);

43 
	`öb
(
COM1
+0);

44 
	`iﬂpi˚«bÀ
(
IRQ_COM1
, 0);

47 
p
="xv6...\n"; *p;Ö++)

48 
	`u¨çutc
(*
p
);

49 
	}
}

52 
	$u¨çutc
(
c
)

54 
i
;

56 if(!
u¨t
)

58 
i
 = 0; i < 128 && !(
	`öb
(
COM1
+5) & 0x20); i++)

59 
	`mi¸odñay
(10);

60 
	`outb
(
COM1
+0, 
c
);

61 
	}
}

64 
	$u¨tgëc
()

66 if(!
u¨t
)

68 if(!(
	`öb
(
COM1
+5) & 0x01))

70  
	`öb
(
COM1
+0);

71 
	}
}

74 
	$u¨töå
()

76 
	`c⁄sﬁeöå
(
u¨tgëc
);

77 
	}
}

	@ulib.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"f˙é.h
"

4 
	~"u£r.h
"

5 
	~"x86.h
"

8 
	$°r˝y
(*
s
, c⁄° *
t
)

10 *
os
;

12 
os
 = 
s
;

13 (*
s
++ = *
t
++) != 0)

15  
os
;

16 
	}
}

19 
	$°rcmp
(c⁄° *
p
, c⁄° *
q
)

21 *
p
 && *∞=*
q
)

22 
p
++, 
q
++;

23  (
uch¨
)*
p
 - (uch¨)*
q
;

24 
	}
}

26 
uöt


27 
	$°æí
(c⁄° *
s
)

29 
n
;

31 
n
 = 0; 
s
[n];Ç++)

33  
n
;

34 
	}
}

37 
	$mem£t
(*
d°
, 
c
, 
uöt
 
n
)

39 
	`°osb
(
d°
, 
c
, 
n
);

40  
d°
;

41 
	}
}

44 
	$°rchr
(c⁄° *
s
, 
c
)

46 ; *
s
; s++)

47 if(*
s
 =
c
)

48  (*)
s
;

50 
	}
}

53 
	$gës
(*
buf
, 
max
)

55 
i
, 
cc
;

56 
c
;

58 
i
=0; i+1 < 
max
; ){

59 
cc
 = 
	`ªad
(0, &
c
, 1);

60 if(
cc
 < 1)

62 
buf
[
i
++] = 
c
;

63 if(
c
 == '\n' || c == '\r')

66 
buf
[
i
] = '\0';

67  
buf
;

68 
	}
}

71 
	$°©
(c⁄° *
n
, 
°©
 *
°
)

73 
fd
;

74 
r
;

76 
fd
 = 
	`›í
(
n
, 
O_RDONLY
);

77 if(
fd
 < 0)

79 
r
 = 
	`f°©
(
fd
, 
°
);

80 
	`˛o£
(
fd
);

81  
r
;

82 
	}
}

85 
	$©oi
(c⁄° *
s
)

87 
n
;

89 
n
 = 0;

90 '0' <*
s
 && *s <= '9')

91 
n
 =Ç*10 + *
s
++ - '0';

92  
n
;

93 
	}
}

96 
	$memmove
(*
vd°
, c⁄° *
v§c
, 
n
)

98 *
d°
;

99 c⁄° *
§c
;

101 
d°
 = 
vd°
;

102 
§c
 = 
v§c
;

103 
n
-- > 0)

104 *
d°
++ = *
§c
++;

105  
vd°
;

106 
	}
}

	@umalloc.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

4 
	~"∑øm.h
"

9 
	tAlign
;

11 
	uhódî
 {

13 
hódî
 *
	m±r
;

14 
uöt
 
	msize
;

15 } 
	ms
;

16 
Align
 
	mx
;

19 
hódî
 
	tHódî
;

21 
Hódî
 
	gba£
;

22 
Hódî
 *
	g‰ìp
;

25 
	$‰ì
(*
≠
)

27 
Hódî
 *
bp
, *
p
;

29 
bp
 = (
Hódî
*)
≠
 - 1;

30 
p
 = 
‰ìp
; !(
bp
 >Ö && b∞<Ö->
s
.
±r
);Ö =Ö->s.ptr)

31 if(
p
 >p->
s
.
±r
 && (
bp
 >Ö || bp <Ö->s.ptr))

33 if(
bp
 + bp->
s
.
size
 =
p
->s.
±r
){

34 
bp
->
s
.
size
 +
p
->s.
±r
->s.size;

35 
bp
->
s
.
±r
 = 
p
->s.ptr->s.ptr;

37 
bp
->
s
.
±r
 = 
p
->s.ptr;

38 if(
p
 +Ö->
s
.
size
 =
bp
){

39 
p
->
s
.
size
 +
bp
->s.size;

40 
p
->
s
.
±r
 = 
bp
->s.ptr;

42 
p
->
s
.
±r
 = 
bp
;

43 
‰ìp
 = 
p
;

44 
	}
}

46 
Hódî
*

47 
	$m‹ec‹e
(
uöt
 
nu
)

49 *
p
;

50 
Hódî
 *
hp
;

52 if(
nu
 < 4096)

53 
nu
 = 4096;

54 
p
 = 
	`sbrk
(
nu
 * (
Hódî
));

55 if(
p
 == (*)-1)

57 
hp
 = (
Hódî
*)
p
;

58 
hp
->
s
.
size
 = 
nu
;

59 
	`‰ì
((*)(
hp
 + 1));

60  
‰ìp
;

61 
	}
}

64 
	$mÆloc
(
uöt
 
nbyãs
)

66 
Hódî
 *
p
, *
¥evp
;

67 
uöt
 
nunôs
;

69 
nunôs
 = (
nbyãs
 + (
Hódî
) - 1)/(Header) + 1;

70 if((
¥evp
 = 
‰ìp
) == 0){

71 
ba£
.
s
.
±r
 = 
‰ìp
 = 
¥evp
 = &base;

72 
ba£
.
s
.
size
 = 0;

74 
p
 = 
¥evp
->
s
.
±r
; ;Örevp =Ö,Ö =Ö->s.ptr){

75 if(
p
->
s
.
size
 >
nunôs
){

76 if(
p
->
s
.
size
 =
nunôs
)

77 
¥evp
->
s
.
±r
 = 
p
->s.ptr;

79 
p
->
s
.
size
 -
nunôs
;

80 
p
 +p->
s
.
size
;

81 
p
->
s
.
size
 = 
nunôs
;

83 
‰ìp
 = 
¥evp
;

84  (*)(
p
 + 1);

86 if(
p
 =
‰ìp
)

87 if((
p
 = 
	`m‹ec‹e
(
nunôs
)) == 0)

90 
	}
}

	@user.h

1 
	g°©
;

2 
	gπcd©e
;

5 
f‹k
();

6 
	$exô
(Ë
	`__©åibuã__
((
n‹ëu∫
));

7 
	`waô
();

8 
	`pùe
(*);

9 
	`wrôe
(, const *, );

10 
	`ªad
(, *, );

11 
	`˛o£
();

12 
	`kûl
();

13 
	`exec
(*, **);

14 
	`›í
(const *, );

15 
	`mknod
(const *, , );

16 
	`u∆ök
(const *);

17 
	`f°©
(
fd
, 
°©
*);

18 
	`lök
(const *, const *);

19 
	`mkdú
(const *);

20 
	`chdú
(const *);

21 
	`dup
();

22 
	`gëpid
();

23 * 
	`sbrk
();

24 
	`¶ìp
();

25 
	`u±ime
();

28 
	`£t_˝u_sh¨e
();

29 
	`gëÀv
();

30 
	`myfun˘i⁄
(*);

31 
	`gëµid
();

32 
	`yõld
();

33 
	`queue_èbÀ_lookup
();

36 
	`thªad_¸óã
(*
thªad
, * (*
°¨t_rou¡öe
)(*), *
¨g
);

37 
	`thªad_exô
(*
ªtvÆ
);

38 
	`thªad_joö
(
thªad
, **
ªtvÆ
);

41 
	`°©
(c⁄° *, 
°©
*);

42 * 
	`°r˝y
(*, const *);

43 *
	`memmove
(*, const *, );

44 * 
	`°rchr
(c⁄° *, 
c
);

45 
	`°rcmp
(const *, const *);

46 
	`¥ötf
(, const *, ...);

47 * 
	`gës
(*, 
max
);

48 
uöt
 
	`°æí
(const *);

49 * 
	`mem£t
(*, , 
uöt
);

50 * 
	`mÆloc
(
uöt
);

51 
	`‰ì
(*);

52 
	`©oi
(const *);

	@usertests.c

1 
	~"∑øm.h
"

2 
	~"ty≥s.h
"

3 
	~"°©.h
"

4 
	~"u£r.h
"

5 
	~"fs.h
"

6 
	~"f˙é.h
"

7 
	~"sysˇŒ.h
"

8 
	~"å≠s.h
"

9 
	~"memœyout.h
"

11 
	gbuf
[8192];

12 
	g«me
[3];

13 *
	gechﬂrgv
[] = { "echo", "ALL", "TESTS", "PASSED", 0 };

14 
	g°dout
 = 1;

18 
	$ùuâe°
()

20 
	`¥ötf
(
°dout
, "iputÅest\n");

22 if(
	`mkdú
("iputdir") < 0){

23 
	`¥ötf
(
°dout
, "mkdir failed\n");

24 
	`exô
();

26 if(
	`chdú
("iputdir") < 0){

27 
	`¥ötf
(
°dout
, "chdir iputdir failed\n");

28 
	`exô
();

30 if(
	`u∆ök
("../iputdir") < 0){

31 
	`¥ötf
(
°dout
, "unlink ../iputdir failed\n");

32 
	`exô
();

34 if(
	`chdú
("/") < 0){

35 
	`¥ötf
(
°dout
, "chdir / failed\n");

36 
	`exô
();

38 
	`¥ötf
(
°dout
, "iputÅest ok\n");

39 
	}
}

43 
	$exôùuâe°
()

45 
pid
;

47 
	`¥ötf
(
°dout
, "exitiputÅest\n");

49 
pid
 = 
	`f‹k
();

50 if(
pid
 < 0){

51 
	`¥ötf
(
°dout
, "fork failed\n");

52 
	`exô
();

54 if(
pid
 == 0){

55 if(
	`mkdú
("iputdir") < 0){

56 
	`¥ötf
(
°dout
, "mkdir failed\n");

57 
	`exô
();

59 if(
	`chdú
("iputdir") < 0){

60 
	`¥ötf
(
°dout
, "child chdir failed\n");

61 
	`exô
();

63 if(
	`u∆ök
("../iputdir") < 0){

64 
	`¥ötf
(
°dout
, "unlink ../iputdir failed\n");

65 
	`exô
();

67 
	`exô
();

69 
	`waô
();

70 
	`¥ötf
(
°dout
, "exitiputÅest ok\n");

71 
	}
}

85 
	$›íùuâe°
()

87 
pid
;

89 
	`¥ötf
(
°dout
, "openiputÅest\n");

90 if(
	`mkdú
("oidir") < 0){

91 
	`¥ötf
(
°dout
, "mkdir oidir failed\n");

92 
	`exô
();

94 
pid
 = 
	`f‹k
();

95 if(
pid
 < 0){

96 
	`¥ötf
(
°dout
, "fork failed\n");

97 
	`exô
();

99 if(
pid
 == 0){

100 
fd
 = 
	`›í
("oidú", 
O_RDWR
);

101 if(
fd
 >= 0){

102 
	`¥ötf
(
°dout
, "open directory for write succeeded\n");

103 
	`exô
();

105 
	`exô
();

107 
	`¶ìp
(1);

108 if(
	`u∆ök
("oidir") != 0){

109 
	`¥ötf
(
°dout
, "unlink failed\n");

110 
	`exô
();

112 
	`waô
();

113 
	`¥ötf
(
°dout
, "openiputÅest ok\n");

114 
	}
}

119 
	$›íã°
()

121 
fd
;

123 
	`¥ötf
(
°dout
, "openÅest\n");

124 
fd
 = 
	`›í
("echo", 0);

125 if(
fd
 < 0){

126 
	`¥ötf
(
°dout
, "openÉcho failed!\n");

127 
	`exô
();

129 
	`˛o£
(
fd
);

130 
fd
 = 
	`›í
("doesnotexist", 0);

131 if(
fd
 >= 0){

132 
	`¥ötf
(
°dout
, "open doesnotexist succeeded!\n");

133 
	`exô
();

135 
	`¥ötf
(
°dout
, "openÅest ok\n");

136 
	}
}

139 
	$wrôëe°
()

141 
fd
;

142 
i
;

144 
	`¥ötf
(
°dout
, "small fileÅest\n");

145 
fd
 = 
	`›í
("smÆl", 
O_CREATE
|
O_RDWR
);

146 if(
fd
 >= 0){

147 
	`¥ötf
(
°dout
, "creat small succeeded; ok\n");

149 
	`¥ötf
(
°dout
, "error: creat small failed!\n");

150 
	`exô
();

152 
i
 = 0; i < 100; i++){

153 if(
	`wrôe
(
fd
, "aaaaaaaaaa", 10) != 10){

154 
	`¥ötf
(
°dout
, "îr‹: wrôêØ %dÇew fûêÁûed\n", 
i
);

155 
	`exô
();

157 if(
	`wrôe
(
fd
, "bbbbbbbbbb", 10) != 10){

158 
	`¥ötf
(
°dout
, "îr‹: wrôêbb %dÇew fûêÁûed\n", 
i
);

159 
	`exô
();

162 
	`¥ötf
(
°dout
, "writes ok\n");

163 
	`˛o£
(
fd
);

164 
fd
 = 
	`›í
("smÆl", 
O_RDONLY
);

165 if(
fd
 >= 0){

166 
	`¥ötf
(
°dout
, "open small succeeded ok\n");

168 
	`¥ötf
(
°dout
, "error: open small failed!\n");

169 
	`exô
();

171 
i
 = 
	`ªad
(
fd
, 
buf
, 2000);

172 if(
i
 == 2000){

173 
	`¥ötf
(
°dout
, "read succeeded ok\n");

175 
	`¥ötf
(
°dout
, "read failed\n");

176 
	`exô
();

178 
	`˛o£
(
fd
);

180 if(
	`u∆ök
("small") < 0){

181 
	`¥ötf
(
°dout
, "unlink small failed\n");

182 
	`exô
();

184 
	`¥ötf
(
°dout
, "small fileÅest ok\n");

185 
	}
}

188 
	$wrôëe°1
()

190 
i
, 
fd
, 
n
;

192 
	`¥ötf
(
°dout
, "big filesÅest\n");

194 
fd
 = 
	`›í
("big", 
O_CREATE
|
O_RDWR
);

195 if(
fd
 < 0){

196 
	`¥ötf
(
°dout
, "error: creat big failed!\n");

197 
	`exô
();

200 
i
 = 0; i < 
MAXFILE
; i++){

201 ((*)
buf
)[0] = 
i
;

202 if(
	`wrôe
(
fd
, 
buf
, 512) != 512){

203 
	`¥ötf
(
°dout
, "îr‹: wrôêbig fûêÁûed\n", 
i
);

204 
	`exô
();

208 
	`˛o£
(
fd
);

210 
fd
 = 
	`›í
("big", 
O_RDONLY
);

211 if(
fd
 < 0){

212 
	`¥ötf
(
°dout
, "error: open big failed!\n");

213 
	`exô
();

216 
n
 = 0;

218 
i
 = 
	`ªad
(
fd
, 
buf
, 512);

219 if(
i
 == 0){

220 if(
n
 =
MAXFILE
 - 1){

221 
	`¥ötf
(
°dout
, "ªad o∆y %d block†‰om big", 
n
);

222 
	`exô
();

225 } if(
i
 != 512){

226 
	`¥ötf
(
°dout
, "ªad faûed %d\n", 
i
);

227 
	`exô
();

229 if(((*)
buf
)[0] !
n
){

230 
	`¥ötf
(
°dout
, "read content of block %d is %d\n",

231 
n
, ((*)
buf
)[0]);

232 
	`exô
();

234 
n
++;

236 
	`˛o£
(
fd
);

237 if(
	`u∆ök
("big") < 0){

238 
	`¥ötf
(
°dout
, "unlink big failed\n");

239 
	`exô
();

241 
	`¥ötf
(
°dout
, "big files ok\n");

242 
	}
}

245 
	$¸óãã°
()

247 
i
, 
fd
;

249 
	`¥ötf
(
°dout
, "many creates, followed by unlinkÅest\n");

251 
«me
[0] = 'a';

252 
«me
[2] = '\0';

253 
i
 = 0; i < 52; i++){

254 
«me
[1] = '0' + 
i
;

255 
fd
 = 
	`›í
(
«me
, 
O_CREATE
|
O_RDWR
);

256 
	`˛o£
(
fd
);

258 
«me
[0] = 'a';

259 
«me
[2] = '\0';

260 
i
 = 0; i < 52; i++){

261 
«me
[1] = '0' + 
i
;

262 
	`u∆ök
(
«me
);

264 
	`¥ötf
(
°dout
, "many creates, followed by unlink; ok\n");

265 
	}
}

267 
	$dúã°
()

269 
	`¥ötf
(
°dout
, "mkdirÅest\n");

271 if(
	`mkdú
("dir0") < 0){

272 
	`¥ötf
(
°dout
, "mkdir failed\n");

273 
	`exô
();

276 if(
	`chdú
("dir0") < 0){

277 
	`¥ötf
(
°dout
, "chdir dir0 failed\n");

278 
	`exô
();

281 if(
	`chdú
("..") < 0){

282 
	`¥ötf
(
°dout
, "chdir .. failed\n");

283 
	`exô
();

286 if(
	`u∆ök
("dir0") < 0){

287 
	`¥ötf
(
°dout
, "unlink dir0 failed\n");

288 
	`exô
();

290 
	`¥ötf
(
°dout
, "mkdirÅest ok\n");

291 
	}
}

294 
	$exe˘e°
()

296 
	`¥ötf
(
°dout
, "execÅest\n");

297 if(
	`exec
("echo", 
echﬂrgv
) < 0){

298 
	`¥ötf
(
°dout
, "execÉcho failed\n");

299 
	`exô
();

301 
	}
}

306 
	$pùe1
()

308 
fds
[2], 
pid
;

309 
£q
, 
i
, 
n
, 
cc
, 
tŸÆ
;

311 if(
	`pùe
(
fds
) != 0){

312 
	`¥ötf
(1, "pipe() failed\n");

313 
	`exô
();

315 
pid
 = 
	`f‹k
();

316 
£q
 = 0;

317 if(
pid
 == 0){

318 
	`˛o£
(
fds
[0]);

319 
n
 = 0;Ç < 5;Ç++){

320 
i
 = 0; i < 1033; i++)

321 
buf
[
i
] = 
£q
++;

322 if(
	`wrôe
(
fds
[1], 
buf
, 1033) != 1033){

323 
	`¥ötf
(1, "pipe1 oops 1\n");

324 
	`exô
();

327 
	`exô
();

328 } if(
pid
 > 0){

329 
	`˛o£
(
fds
[1]);

330 
tŸÆ
 = 0;

331 
cc
 = 1;

332 (
n
 = 
	`ªad
(
fds
[0], 
buf
, 
cc
)) > 0){

333 
i
 = 0; i < 
n
; i++){

334 if((
buf
[
i
] & 0xffË!(
£q
++ & 0xff)){

335 
	`¥ötf
(1, "pipe1 oops 2\n");

339 
tŸÆ
 +
n
;

340 
cc
 = cc * 2;

341 if(
cc
 > (
buf
))

342 
cc
 = (
buf
);

344 if(
tŸÆ
 != 5 * 1033){

345 
	`¥ötf
(1, "pùe1 o›†3ÅŸÆ %d\n", 
tŸÆ
);

346 
	`exô
();

348 
	`˛o£
(
fds
[0]);

349 
	`waô
();

351 
	`¥ötf
(1, "fork() failed\n");

352 
	`exô
();

354 
	`¥ötf
(1, "pipe1 ok\n");

355 
	}
}

359 
	$¥ìm±
()

361 
pid1
, 
pid2
, 
pid3
;

362 
pfds
[2];

364 
	`¥ötf
(1, "preempt: ");

365 
pid1
 = 
	`f‹k
();

366 if(
pid1
 == 0)

370 
pid2
 = 
	`f‹k
();

371 if(
pid2
 == 0)

375 
	`pùe
(
pfds
);

376 
pid3
 = 
	`f‹k
();

377 if(
pid3
 == 0){

378 
	`˛o£
(
pfds
[0]);

379 if(
	`wrôe
(
pfds
[1], "x", 1) != 1)

380 
	`¥ötf
(1, "preempt writeÉrror");

381 
	`˛o£
(
pfds
[1]);

386 
	`˛o£
(
pfds
[1]);

387 if(
	`ªad
(
pfds
[0], 
buf
, (buf)) != 1){

388 
	`¥ötf
(1, "preemptÑeadÉrror");

391 
	`˛o£
(
pfds
[0]);

392 
	`¥ötf
(1, "kill... ");

393 
	`kûl
(
pid1
);

394 
	`kûl
(
pid2
);

395 
	`kûl
(
pid3
);

396 
	`¥ötf
(1, "wait... ");

397 
	`waô
();

398 
	`waô
();

399 
	`waô
();

400 
	`¥ötf
(1, "preempt ok\n");

401 
	}
}

405 
	$exôwaô
()

407 
i
, 
pid
;

409 
i
 = 0; i < 100; i++){

410 
pid
 = 
	`f‹k
();

411 if(
pid
 < 0){

412 
	`¥ötf
(1, "fork failed\n");

415 if(
pid
){

416 if(
	`waô
(Ë!
pid
){

417 
	`¥ötf
(1, "wait wrongÖid\n");

421 
	`exô
();

424 
	`¥ötf
(1, "exitwait ok\n");

425 
	}
}

428 
	$mem
()

430 *
m1
, *
m2
;

431 
pid
, 
µid
;

433 
	`¥ötf
(1, "memÅest\n");

434 
µid
 = 
	`gëpid
();

435 if((
pid
 = 
	`f‹k
()) == 0){

436 
m1
 = 0;

437 (
m2
 = 
	`mÆloc
(10001)) != 0){

438 *(**)
m2
 = 
m1
;

439 
m1
 = 
m2
;

441 
m1
){

442 
m2
 = *(**)
m1
;

443 
	`‰ì
(
m1
);

444 
m1
 = 
m2
;

446 
m1
 = 
	`mÆloc
(1024*20);

447 if(
m1
 == 0){

448 
	`¥ötf
(1, "couldn'tállocate mem?!!\n");

449 
	`kûl
(
µid
);

450 
	`exô
();

452 
	`‰ì
(
m1
);

453 
	`¥ötf
(1, "mem ok\n");

454 
	`exô
();

456 
	`waô
();

458 
	}
}

465 
	$sh¨edfd
()

467 
fd
, 
pid
, 
i
, 
n
, 
nc
, 
≈
;

468 
buf
[10];

470 
	`¥ötf
(1, "sharedfdÅest\n");

472 
	`u∆ök
("sharedfd");

473 
fd
 = 
	`›í
("sh¨edfd", 
O_CREATE
|
O_RDWR
);

474 if(
fd
 < 0){

475 
	`¥ötf
(1, "fstests: cannot open sharedfd for writing");

478 
pid
 = 
	`f‹k
();

479 
	`mem£t
(
buf
, 
pid
==0?'c':'p', (buf));

480 
i
 = 0; i < 1000; i++){

481 if(
	`wrôe
(
fd
, 
buf
, (buf)) != (buf)){

482 
	`¥ötf
(1, "fstests: write sharedfd failed\n");

486 if(
pid
 == 0)

487 
	`exô
();

489 
	`waô
();

490 
	`˛o£
(
fd
);

491 
fd
 = 
	`›í
("sharedfd", 0);

492 if(
fd
 < 0){

493 
	`¥ötf
(1, "fstests: cannot open sharedfd forÑeading\n");

496 
nc
 = 
≈
 = 0;

497 (
n
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0){

498 
i
 = 0; i < (
buf
); i++){

499 if(
buf
[
i
] == 'c')

500 
nc
++;

501 if(
buf
[
i
] == 'p')

502 
≈
++;

505 
	`˛o£
(
fd
);

506 
	`u∆ök
("sharedfd");

507 if(
nc
 =10000 && 
≈
 == 10000){

508 
	`¥ötf
(1, "sharedfd ok\n");

510 
	`¥ötf
(1, "sh¨edfd o›†%d %d\n", 
nc
, 
≈
);

511 
	`exô
();

513 
	}
}

518 
	$fourfûes
()

520 
fd
, 
pid
, 
i
, 
j
, 
n
, 
tŸÆ
, 
pi
;

521 *
«mes
[] = { "f0", "f1", "f2", "f3" };

522 *
‚ame
;

524 
	`¥ötf
(1, "fourfilesÅest\n");

526 
pi
 = 0;Öi < 4;Öi++){

527 
‚ame
 = 
«mes
[
pi
];

528 
	`u∆ök
(
‚ame
);

530 
pid
 = 
	`f‹k
();

531 if(
pid
 < 0){

532 
	`¥ötf
(1, "fork failed\n");

533 
	`exô
();

536 if(
pid
 == 0){

537 
fd
 = 
	`›í
(
‚ame
, 
O_CREATE
 | 
O_RDWR
);

538 if(
fd
 < 0){

539 
	`¥ötf
(1, "create failed\n");

540 
	`exô
();

543 
	`mem£t
(
buf
, '0'+
pi
, 512);

544 
i
 = 0; i < 12; i++){

545 if((
n
 = 
	`wrôe
(
fd
, 
buf
, 500)) != 500){

546 
	`¥ötf
(1, "wrôêÁûed %d\n", 
n
);

547 
	`exô
();

550 
	`exô
();

554 
pi
 = 0;Öi < 4;Öi++){

555 
	`waô
();

558 
i
 = 0; i < 2; i++){

559 
‚ame
 = 
«mes
[
i
];

560 
fd
 = 
	`›í
(
‚ame
, 0);

561 
tŸÆ
 = 0;

562 (
n
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0){

563 
j
 = 0; j < 
n
; j++){

564 if(
buf
[
j
] !'0'+
i
){

565 
	`¥ötf
(1, "wrong char\n");

566 
	`exô
();

569 
tŸÆ
 +
n
;

571 
	`˛o£
(
fd
);

572 if(
tŸÆ
 != 12*500){

573 
	`¥ötf
(1, "wr⁄gÜígth %d\n", 
tŸÆ
);

574 
	`exô
();

576 
	`u∆ök
(
‚ame
);

579 
	`¥ötf
(1, "fourfiles ok\n");

580 
	}
}

584 
	$¸óãdñëe
()

586 íum { 
N
 = 20 };

587 
pid
, 
i
, 
fd
, 
pi
;

588 
«me
[32];

590 
	`¥ötf
(1, "createdeleteÅest\n");

592 
pi
 = 0;Öi < 4;Öi++){

593 
pid
 = 
	`f‹k
();

594 if(
pid
 < 0){

595 
	`¥ötf
(1, "fork failed\n");

596 
	`exô
();

599 if(
pid
 == 0){

600 
«me
[0] = 'p' + 
pi
;

601 
«me
[2] = '\0';

602 
i
 = 0; i < 
N
; i++){

603 
«me
[1] = '0' + 
i
;

604 
fd
 = 
	`›í
(
«me
, 
O_CREATE
 | 
O_RDWR
);

605 if(
fd
 < 0){

606 
	`¥ötf
(1, "create failed\n");

607 
	`exô
();

609 
	`˛o£
(
fd
);

610 if(
i
 > 0 && (i % 2 ) == 0){

611 
«me
[1] = '0' + (
i
 / 2);

612 if(
	`u∆ök
(
«me
) < 0){

613 
	`¥ötf
(1, "unlink failed\n");

614 
	`exô
();

618 
	`exô
();

622 
pi
 = 0;Öi < 4;Öi++){

623 
	`waô
();

626 
«me
[0] =Çame[1] =Çame[2] = 0;

627 
i
 = 0; i < 
N
; i++){

628 
pi
 = 0;Öi < 4;Öi++){

629 
«me
[0] = 'p' + 
pi
;

630 
«me
[1] = '0' + 
i
;

631 
fd
 = 
	`›í
(
«me
, 0);

632 if((
i
 =0 || i >
N
/2Ë&& 
fd
 < 0){

633 
	`¥ötf
(1, "o›†¸óãdñëê%†didn'àexi°\n", 
«me
);

634 
	`exô
();

635 } if((
i
 >1 && i < 
N
/2Ë&& 
fd
 >= 0){

636 
	`¥ötf
(1, "o›†¸óãdñëê%†didÉxi°\n", 
«me
);

637 
	`exô
();

639 if(
fd
 >= 0)

640 
	`˛o£
(
fd
);

644 
i
 = 0; i < 
N
; i++){

645 
pi
 = 0;Öi < 4;Öi++){

646 
«me
[0] = 'p' + 
i
;

647 
«me
[1] = '0' + 
i
;

648 
	`u∆ök
(
«me
);

652 
	`¥ötf
(1, "createdelete ok\n");

653 
	}
}

657 
	$u∆ökªad
()

659 
fd
, 
fd1
;

661 
	`¥ötf
(1, "unlinkreadÅest\n");

662 
fd
 = 
	`›í
("u∆ökªad", 
O_CREATE
 | 
O_RDWR
);

663 if(
fd
 < 0){

664 
	`¥ötf
(1, "create unlinkread failed\n");

665 
	`exô
();

667 
	`wrôe
(
fd
, "hello", 5);

668 
	`˛o£
(
fd
);

670 
fd
 = 
	`›í
("u∆ökªad", 
O_RDWR
);

671 if(
fd
 < 0){

672 
	`¥ötf
(1, "open unlinkread failed\n");

673 
	`exô
();

675 if(
	`u∆ök
("unlinkread") != 0){

676 
	`¥ötf
(1, "unlink unlinkread failed\n");

677 
	`exô
();

680 
fd1
 = 
	`›í
("u∆ökªad", 
O_CREATE
 | 
O_RDWR
);

681 
	`wrôe
(
fd1
, "yyy", 3);

682 
	`˛o£
(
fd1
);

684 if(
	`ªad
(
fd
, 
buf
, (buf)) != 5){

685 
	`¥ötf
(1, "unlinkreadÑead failed");

686 
	`exô
();

688 if(
buf
[0] != 'h'){

689 
	`¥ötf
(1, "unlinkread wrong data\n");

690 
	`exô
();

692 if(
	`wrôe
(
fd
, 
buf
, 10) != 10){

693 
	`¥ötf
(1, "unlinkread write failed\n");

694 
	`exô
();

696 
	`˛o£
(
fd
);

697 
	`u∆ök
("unlinkread");

698 
	`¥ötf
(1, "unlinkread ok\n");

699 
	}
}

702 
	$lökã°
()

704 
fd
;

706 
	`¥ötf
(1, "linktest\n");

708 
	`u∆ök
("lf1");

709 
	`u∆ök
("lf2");

711 
fd
 = 
	`›í
("lf1", 
O_CREATE
|
O_RDWR
);

712 if(
fd
 < 0){

713 
	`¥ötf
(1, "createÜf1 failed\n");

714 
	`exô
();

716 if(
	`wrôe
(
fd
, "hello", 5) != 5){

717 
	`¥ötf
(1, "writeÜf1 failed\n");

718 
	`exô
();

720 
	`˛o£
(
fd
);

722 if(
	`lök
("lf1", "lf2") < 0){

723 
	`¥ötf
(1, "linkÜf1Üf2 failed\n");

724 
	`exô
();

726 
	`u∆ök
("lf1");

728 if(
	`›í
("lf1", 0) >= 0){

729 
	`¥ötf
(1, "unlinkedÜf1 but it is stillÅhere!\n");

730 
	`exô
();

733 
fd
 = 
	`›í
("lf2", 0);

734 if(
fd
 < 0){

735 
	`¥ötf
(1, "openÜf2 failed\n");

736 
	`exô
();

738 if(
	`ªad
(
fd
, 
buf
, (buf)) != 5){

739 
	`¥ötf
(1, "readÜf2 failed\n");

740 
	`exô
();

742 
	`˛o£
(
fd
);

744 if(
	`lök
("lf2", "lf2") >= 0){

745 
	`¥ötf
(1, "linkÜf2Üf2 succeeded! oops\n");

746 
	`exô
();

749 
	`u∆ök
("lf2");

750 if(
	`lök
("lf2", "lf1") >= 0){

751 
	`¥ötf
(1, "linkÇon-existant succeeded! oops\n");

752 
	`exô
();

755 if(
	`lök
(".", "lf1") >= 0){

756 
	`¥ötf
(1, "link .Üf1 succeeded! oops\n");

757 
	`exô
();

760 
	`¥ötf
(1, "linktest ok\n");

761 
	}
}

765 
	$c⁄¸óã
()

767 
fûe
[3];

768 
i
, 
pid
, 
n
, 
fd
;

769 
Á
[40];

771 
ush‹t
 
öum
;

772 
«me
[14];

773 } 
de
;

775 
	`¥ötf
(1, "concreateÅest\n");

776 
fûe
[0] = 'C';

777 
fûe
[2] = '\0';

778 
i
 = 0; i < 40; i++){

779 
fûe
[1] = '0' + 
i
;

780 
	`u∆ök
(
fûe
);

781 
pid
 = 
	`f‹k
();

782 if(
pid
 && (
i
 % 3) == 1){

783 
	`lök
("C0", 
fûe
);

784 } if(
pid
 =0 && (
i
 % 5) == 1){

785 
	`lök
("C0", 
fûe
);

787 
fd
 = 
	`›í
(
fûe
, 
O_CREATE
 | 
O_RDWR
);

788 if(
fd
 < 0){

789 
	`¥ötf
(1, "c⁄¸óã cª©ê%†Áûed\n", 
fûe
);

790 
	`exô
();

792 
	`˛o£
(
fd
);

794 if(
pid
 == 0)

795 
	`exô
();

797 
	`waô
();

800 
	`mem£t
(
Á
, 0, (fa));

801 
fd
 = 
	`›í
(".", 0);

802 
n
 = 0;

803 
	`ªad
(
fd
, &
de
, (de)) > 0){

804 if(
de
.
öum
 == 0)

806 if(
de
.
«me
[0] == 'C' && de.name[2] == '\0'){

807 
i
 = 
de
.
«me
[1] - '0';

808 if(
i
 < 0 || i >(
Á
)){

809 
	`¥ötf
(1, "c⁄¸óã weúd fûê%s\n", 
de
.
«me
);

810 
	`exô
();

812 if(
Á
[
i
]){

813 
	`¥ötf
(1, "c⁄¸óã du∂iˇã fûê%s\n", 
de
.
«me
);

814 
	`exô
();

816 
Á
[
i
] = 1;

817 
n
++;

820 
	`˛o£
(
fd
);

822 if(
n
 != 40){

823 
	`¥ötf
(1, "concreateÇotÉnough files in directoryÜisting\n");

824 
	`exô
();

827 
i
 = 0; i < 40; i++){

828 
fûe
[1] = '0' + 
i
;

829 
pid
 = 
	`f‹k
();

830 if(
pid
 < 0){

831 
	`¥ötf
(1, "fork failed\n");

832 
	`exô
();

834 if(((
i
 % 3Ë=0 && 
pid
 == 0) ||

835 ((
i
 % 3Ë=1 && 
pid
 != 0)){

836 
	`˛o£
(
	`›í
(
fûe
, 0));

837 
	`˛o£
(
	`›í
(
fûe
, 0));

838 
	`˛o£
(
	`›í
(
fûe
, 0));

839 
	`˛o£
(
	`›í
(
fûe
, 0));

841 
	`u∆ök
(
fûe
);

842 
	`u∆ök
(
fûe
);

843 
	`u∆ök
(
fûe
);

844 
	`u∆ök
(
fûe
);

846 if(
pid
 == 0)

847 
	`exô
();

849 
	`waô
();

852 
	`¥ötf
(1, "concreate ok\n");

853 
	}
}

858 
	$löku∆ök
()

860 
pid
, 
i
;

862 
	`¥ötf
(1, "linkunlinkÅest\n");

864 
	`u∆ök
("x");

865 
pid
 = 
	`f‹k
();

866 if(
pid
 < 0){

867 
	`¥ötf
(1, "fork failed\n");

868 
	`exô
();

871 
x
 = (
pid
 ? 1 : 97);

872 
i
 = 0; i < 100; i++){

873 
x
 = x * 1103515245 + 12345;

874 if((
x
 % 3) == 0){

875 
	`˛o£
(
	`›í
("x", 
O_RDWR
 | 
O_CREATE
));

876 } if((
x
 % 3) == 1){

877 
	`lök
("cat", "x");

879 
	`u∆ök
("x");

883 if(
pid
)

884 
	`waô
();

886 
	`exô
();

888 
	`¥ötf
(1, "linkunlink ok\n");

889 
	}
}

893 
	$bigdú
()

895 
i
, 
fd
;

896 
«me
[10];

898 
	`¥ötf
(1, "bigdirÅest\n");

899 
	`u∆ök
("bd");

901 
fd
 = 
	`›í
("bd", 
O_CREATE
);

902 if(
fd
 < 0){

903 
	`¥ötf
(1, "bigdir create failed\n");

904 
	`exô
();

906 
	`˛o£
(
fd
);

908 
i
 = 0; i < 500; i++){

909 
«me
[0] = 'x';

910 
«me
[1] = '0' + (
i
 / 64);

911 
«me
[2] = '0' + (
i
 % 64);

912 
«me
[3] = '\0';

913 if(
	`lök
("bd", 
«me
) != 0){

914 
	`¥ötf
(1, "bigdirÜink failed\n");

915 
	`exô
();

919 
	`u∆ök
("bd");

920 
i
 = 0; i < 500; i++){

921 
«me
[0] = 'x';

922 
«me
[1] = '0' + (
i
 / 64);

923 
«me
[2] = '0' + (
i
 % 64);

924 
«me
[3] = '\0';

925 if(
	`u∆ök
(
«me
) != 0){

926 
	`¥ötf
(1, "bigdir unlink failed");

927 
	`exô
();

931 
	`¥ötf
(1, "bigdir ok\n");

932 
	}
}

935 
	$subdú
()

937 
fd
, 
cc
;

939 
	`¥ötf
(1, "subdirÅest\n");

941 
	`u∆ök
("ff");

942 if(
	`mkdú
("dd") != 0){

943 
	`¥ötf
(1, "subdir mkdir dd failed\n");

944 
	`exô
();

947 
fd
 = 
	`›í
("dd/ff", 
O_CREATE
 | 
O_RDWR
);

948 if(
fd
 < 0){

949 
	`¥ötf
(1, "create dd/ff failed\n");

950 
	`exô
();

952 
	`wrôe
(
fd
, "ff", 2);

953 
	`˛o£
(
fd
);

955 if(
	`u∆ök
("dd") >= 0){

956 
	`¥ötf
(1, "unlink dd (non-empty dir) succeeded!\n");

957 
	`exô
();

960 if(
	`mkdú
("/dd/dd") != 0){

961 
	`¥ötf
(1, "subdir mkdir dd/dd failed\n");

962 
	`exô
();

965 
fd
 = 
	`›í
("dd/dd/ff", 
O_CREATE
 | 
O_RDWR
);

966 if(
fd
 < 0){

967 
	`¥ötf
(1, "create dd/dd/ff failed\n");

968 
	`exô
();

970 
	`wrôe
(
fd
, "FF", 2);

971 
	`˛o£
(
fd
);

973 
fd
 = 
	`›í
("dd/dd/../ff", 0);

974 if(
fd
 < 0){

975 
	`¥ötf
(1, "open dd/dd/../ff failed\n");

976 
	`exô
();

978 
cc
 = 
	`ªad
(
fd
, 
buf
, (buf));

979 if(
cc
 !2 || 
buf
[0] != 'f'){

980 
	`¥ötf
(1, "dd/dd/../ff wrong content\n");

981 
	`exô
();

983 
	`˛o£
(
fd
);

985 if(
	`lök
("dd/dd/ff", "dd/dd/ffff") != 0){

986 
	`¥ötf
(1, "link dd/dd/ff dd/dd/ffff failed\n");

987 
	`exô
();

990 if(
	`u∆ök
("dd/dd/ff") != 0){

991 
	`¥ötf
(1, "unlink dd/dd/ff failed\n");

992 
	`exô
();

994 if(
	`›í
("dd/dd/ff", 
O_RDONLY
) >= 0){

995 
	`¥ötf
(1, "open (unlinked) dd/dd/ff succeeded\n");

996 
	`exô
();

999 if(
	`chdú
("dd") != 0){

1000 
	`¥ötf
(1, "chdir dd failed\n");

1001 
	`exô
();

1003 if(
	`chdú
("dd/../../dd") != 0){

1004 
	`¥ötf
(1, "chdir dd/../../dd failed\n");

1005 
	`exô
();

1007 if(
	`chdú
("dd/../../../dd") != 0){

1008 
	`¥ötf
(1, "chdir dd/../../dd failed\n");

1009 
	`exô
();

1011 if(
	`chdú
("./..") != 0){

1012 
	`¥ötf
(1, "chdir ./.. failed\n");

1013 
	`exô
();

1016 
fd
 = 
	`›í
("dd/dd/ffff", 0);

1017 if(
fd
 < 0){

1018 
	`¥ötf
(1, "open dd/dd/ffff failed\n");

1019 
	`exô
();

1021 if(
	`ªad
(
fd
, 
buf
, (buf)) != 2){

1022 
	`¥ötf
(1, "read dd/dd/ffff wrongÜen\n");

1023 
	`exô
();

1025 
	`˛o£
(
fd
);

1027 if(
	`›í
("dd/dd/ff", 
O_RDONLY
) >= 0){

1028 
	`¥ötf
(1, "open (unlinked) dd/dd/ff succeeded!\n");

1029 
	`exô
();

1032 if(
	`›í
("dd/ff/ff", 
O_CREATE
|
O_RDWR
) >= 0){

1033 
	`¥ötf
(1, "create dd/ff/ff succeeded!\n");

1034 
	`exô
();

1036 if(
	`›í
("dd/xx/ff", 
O_CREATE
|
O_RDWR
) >= 0){

1037 
	`¥ötf
(1, "create dd/xx/ff succeeded!\n");

1038 
	`exô
();

1040 if(
	`›í
("dd", 
O_CREATE
) >= 0){

1041 
	`¥ötf
(1, "create dd succeeded!\n");

1042 
	`exô
();

1044 if(
	`›í
("dd", 
O_RDWR
) >= 0){

1045 
	`¥ötf
(1, "open ddÑdwr succeeded!\n");

1046 
	`exô
();

1048 if(
	`›í
("dd", 
O_WRONLY
) >= 0){

1049 
	`¥ötf
(1, "open dd wronly succeeded!\n");

1050 
	`exô
();

1052 if(
	`lök
("dd/ff/ff", "dd/dd/xx") == 0){

1053 
	`¥ötf
(1, "link dd/ff/ff dd/dd/xx succeeded!\n");

1054 
	`exô
();

1056 if(
	`lök
("dd/xx/ff", "dd/dd/xx") == 0){

1057 
	`¥ötf
(1, "link dd/xx/ff dd/dd/xx succeeded!\n");

1058 
	`exô
();

1060 if(
	`lök
("dd/ff", "dd/dd/ffff") == 0){

1061 
	`¥ötf
(1, "link dd/ff dd/dd/ffff succeeded!\n");

1062 
	`exô
();

1064 if(
	`mkdú
("dd/ff/ff") == 0){

1065 
	`¥ötf
(1, "mkdir dd/ff/ff succeeded!\n");

1066 
	`exô
();

1068 if(
	`mkdú
("dd/xx/ff") == 0){

1069 
	`¥ötf
(1, "mkdir dd/xx/ff succeeded!\n");

1070 
	`exô
();

1072 if(
	`mkdú
("dd/dd/ffff") == 0){

1073 
	`¥ötf
(1, "mkdir dd/dd/ffff succeeded!\n");

1074 
	`exô
();

1076 if(
	`u∆ök
("dd/xx/ff") == 0){

1077 
	`¥ötf
(1, "unlink dd/xx/ff succeeded!\n");

1078 
	`exô
();

1080 if(
	`u∆ök
("dd/ff/ff") == 0){

1081 
	`¥ötf
(1, "unlink dd/ff/ff succeeded!\n");

1082 
	`exô
();

1084 if(
	`chdú
("dd/ff") == 0){

1085 
	`¥ötf
(1, "chdir dd/ff succeeded!\n");

1086 
	`exô
();

1088 if(
	`chdú
("dd/xx") == 0){

1089 
	`¥ötf
(1, "chdir dd/xx succeeded!\n");

1090 
	`exô
();

1093 if(
	`u∆ök
("dd/dd/ffff") != 0){

1094 
	`¥ötf
(1, "unlink dd/dd/ff failed\n");

1095 
	`exô
();

1097 if(
	`u∆ök
("dd/ff") != 0){

1098 
	`¥ötf
(1, "unlink dd/ff failed\n");

1099 
	`exô
();

1101 if(
	`u∆ök
("dd") == 0){

1102 
	`¥ötf
(1, "unlinkÇon-empty dd succeeded!\n");

1103 
	`exô
();

1105 if(
	`u∆ök
("dd/dd") < 0){

1106 
	`¥ötf
(1, "unlink dd/dd failed\n");

1107 
	`exô
();

1109 if(
	`u∆ök
("dd") < 0){

1110 
	`¥ötf
(1, "unlink dd failed\n");

1111 
	`exô
();

1114 
	`¥ötf
(1, "subdir ok\n");

1115 
	}
}

1119 
	$bigwrôe
()

1121 
fd
, 
sz
;

1123 
	`¥ötf
(1, "bigwriteÅest\n");

1125 
	`u∆ök
("bigwrite");

1126 
sz
 = 499; sz < 12*512; sz += 471){

1127 
fd
 = 
	`›í
("bigwrôe", 
O_CREATE
 | 
O_RDWR
);

1128 if(
fd
 < 0){

1129 
	`¥ötf
(1, "cannot create bigwrite\n");

1130 
	`exô
();

1132 
i
;

1133 
i
 = 0; i < 2; i++){

1134 
cc
 = 
	`wrôe
(
fd
, 
buf
, 
sz
);

1135 if(
cc
 !
sz
){

1136 
	`¥ötf
(1, "wrôe(%dËªà%d\n", 
sz
, 
cc
);

1137 
	`exô
();

1140 
	`˛o£
(
fd
);

1141 
	`u∆ök
("bigwrite");

1144 
	`¥ötf
(1, "bigwrite ok\n");

1145 
	}
}

1148 
	$bigfûe
()

1150 
fd
, 
i
, 
tŸÆ
, 
cc
;

1152 
	`¥ötf
(1, "bigfileÅest\n");

1154 
	`u∆ök
("bigfile");

1155 
fd
 = 
	`›í
("bigfûe", 
O_CREATE
 | 
O_RDWR
);

1156 if(
fd
 < 0){

1157 
	`¥ötf
(1, "cannot create bigfile");

1158 
	`exô
();

1160 
i
 = 0; i < 20; i++){

1161 
	`mem£t
(
buf
, 
i
, 600);

1162 if(
	`wrôe
(
fd
, 
buf
, 600) != 600){

1163 
	`¥ötf
(1, "write bigfile failed\n");

1164 
	`exô
();

1167 
	`˛o£
(
fd
);

1169 
fd
 = 
	`›í
("bigfile", 0);

1170 if(
fd
 < 0){

1171 
	`¥ötf
(1, "cannot open bigfile\n");

1172 
	`exô
();

1174 
tŸÆ
 = 0;

1175 
i
 = 0; ; i++){

1176 
cc
 = 
	`ªad
(
fd
, 
buf
, 300);

1177 if(
cc
 < 0){

1178 
	`¥ötf
(1, "read bigfile failed\n");

1179 
	`exô
();

1181 if(
cc
 == 0)

1183 if(
cc
 != 300){

1184 
	`¥ötf
(1, "shortÑead bigfile\n");

1185 
	`exô
();

1187 if(
buf
[0] !
i
/2 || buf[299] != i/2){

1188 
	`¥ötf
(1, "read bigfile wrong data\n");

1189 
	`exô
();

1191 
tŸÆ
 +
cc
;

1193 
	`˛o£
(
fd
);

1194 if(
tŸÆ
 != 20*600){

1195 
	`¥ötf
(1, "read bigfile wrongÅotal\n");

1196 
	`exô
();

1198 
	`u∆ök
("bigfile");

1200 
	`¥ötf
(1, "bigfileÅest ok\n");

1201 
	}
}

1204 
	$fouπìn
()

1206 
fd
;

1209 
	`¥ötf
(1, "fourteenÅest\n");

1211 if(
	`mkdú
("12345678901234") != 0){

1212 
	`¥ötf
(1, "mkdir 12345678901234 failed\n");

1213 
	`exô
();

1215 if(
	`mkdú
("12345678901234/123456789012345") != 0){

1216 
	`¥ötf
(1, "mkdir 12345678901234/123456789012345 failed\n");

1217 
	`exô
();

1219 
fd
 = 
	`›í
("123456789012345/123456789012345/123456789012345", 
O_CREATE
);

1220 if(
fd
 < 0){

1221 
	`¥ötf
(1, "create 123456789012345/123456789012345/123456789012345 failed\n");

1222 
	`exô
();

1224 
	`˛o£
(
fd
);

1225 
fd
 = 
	`›í
("12345678901234/12345678901234/12345678901234", 0);

1226 if(
fd
 < 0){

1227 
	`¥ötf
(1, "open 12345678901234/12345678901234/12345678901234 failed\n");

1228 
	`exô
();

1230 
	`˛o£
(
fd
);

1232 if(
	`mkdú
("12345678901234/12345678901234") == 0){

1233 
	`¥ötf
(1, "mkdir 12345678901234/12345678901234 succeeded!\n");

1234 
	`exô
();

1236 if(
	`mkdú
("123456789012345/12345678901234") == 0){

1237 
	`¥ötf
(1, "mkdir 12345678901234/123456789012345 succeeded!\n");

1238 
	`exô
();

1241 
	`¥ötf
(1, "fourteen ok\n");

1242 
	}
}

1245 
	$rmdŸ
()

1247 
	`¥ötf
(1, "rmdotÅest\n");

1248 if(
	`mkdú
("dots") != 0){

1249 
	`¥ötf
(1, "mkdir dots failed\n");

1250 
	`exô
();

1252 if(
	`chdú
("dots") != 0){

1253 
	`¥ötf
(1, "chdir dots failed\n");

1254 
	`exô
();

1256 if(
	`u∆ök
(".") == 0){

1257 
	`¥ötf
(1, "rm . worked!\n");

1258 
	`exô
();

1260 if(
	`u∆ök
("..") == 0){

1261 
	`¥ötf
(1, "rm .. worked!\n");

1262 
	`exô
();

1264 if(
	`chdú
("/") != 0){

1265 
	`¥ötf
(1, "chdir / failed\n");

1266 
	`exô
();

1268 if(
	`u∆ök
("dots/.") == 0){

1269 
	`¥ötf
(1, "unlink dots/. worked!\n");

1270 
	`exô
();

1272 if(
	`u∆ök
("dots/..") == 0){

1273 
	`¥ötf
(1, "unlink dots/.. worked!\n");

1274 
	`exô
();

1276 if(
	`u∆ök
("dots") != 0){

1277 
	`¥ötf
(1, "unlink dots failed!\n");

1278 
	`exô
();

1280 
	`¥ötf
(1, "rmdot ok\n");

1281 
	}
}

1284 
	$dúfûe
()

1286 
fd
;

1288 
	`¥ötf
(1, "dir vs file\n");

1290 
fd
 = 
	`›í
("dúfûe", 
O_CREATE
);

1291 if(
fd
 < 0){

1292 
	`¥ötf
(1, "create dirfile failed\n");

1293 
	`exô
();

1295 
	`˛o£
(
fd
);

1296 if(
	`chdú
("dirfile") == 0){

1297 
	`¥ötf
(1, "chdir dirfile succeeded!\n");

1298 
	`exô
();

1300 
fd
 = 
	`›í
("dirfile/xx", 0);

1301 if(
fd
 >= 0){

1302 
	`¥ötf
(1, "create dirfile/xx succeeded!\n");

1303 
	`exô
();

1305 
fd
 = 
	`›í
("dúfûe/xx", 
O_CREATE
);

1306 if(
fd
 >= 0){

1307 
	`¥ötf
(1, "create dirfile/xx succeeded!\n");

1308 
	`exô
();

1310 if(
	`mkdú
("dirfile/xx") == 0){

1311 
	`¥ötf
(1, "mkdir dirfile/xx succeeded!\n");

1312 
	`exô
();

1314 if(
	`u∆ök
("dirfile/xx") == 0){

1315 
	`¥ötf
(1, "unlink dirfile/xx succeeded!\n");

1316 
	`exô
();

1318 if(
	`lök
("README", "dirfile/xx") == 0){

1319 
	`¥ötf
(1, "linkÅo dirfile/xx succeeded!\n");

1320 
	`exô
();

1322 if(
	`u∆ök
("dirfile") != 0){

1323 
	`¥ötf
(1, "unlink dirfile failed!\n");

1324 
	`exô
();

1327 
fd
 = 
	`›í
(".", 
O_RDWR
);

1328 if(
fd
 >= 0){

1329 
	`¥ötf
(1, "open . for writing succeeded!\n");

1330 
	`exô
();

1332 
fd
 = 
	`›í
(".", 0);

1333 if(
	`wrôe
(
fd
, "x", 1) > 0){

1334 
	`¥ötf
(1, "write . succeeded!\n");

1335 
	`exô
();

1337 
	`˛o£
(
fd
);

1339 
	`¥ötf
(1, "dir vs file OK\n");

1340 
	}
}

1344 
	$úef
()

1346 
i
, 
fd
;

1348 
	`¥ötf
(1, "empty fileÇame\n");

1351 
i
 = 0; i < 50 + 1; i++){

1352 if(
	`mkdú
("irefd") != 0){

1353 
	`¥ötf
(1, "mkdir irefd failed\n");

1354 
	`exô
();

1356 if(
	`chdú
("irefd") != 0){

1357 
	`¥ötf
(1, "chdir irefd failed\n");

1358 
	`exô
();

1361 
	`mkdú
("");

1362 
	`lök
("README", "");

1363 
fd
 = 
	`›í
("", 
O_CREATE
);

1364 if(
fd
 >= 0)

1365 
	`˛o£
(
fd
);

1366 
fd
 = 
	`›í
("xx", 
O_CREATE
);

1367 if(
fd
 >= 0)

1368 
	`˛o£
(
fd
);

1369 
	`u∆ök
("xx");

1372 
	`chdú
("/");

1373 
	`¥ötf
(1, "empty fileÇame OK\n");

1374 
	}
}

1380 
	$f‹kã°
()

1382 
n
, 
pid
;

1384 
	`¥ötf
(1, "forkÅest\n");

1386 
n
=0;Ç<1000;Ç++){

1387 
pid
 = 
	`f‹k
();

1388 if(
pid
 < 0)

1390 if(
pid
 == 0)

1391 
	`exô
();

1394 if(
n
 == 1000){

1395 
	`¥ötf
(1, "fork claimedÅo work 1000Åimes!\n");

1396 
	`exô
();

1399 ; 
n
 > 0;Ç--){

1400 if(
	`waô
() < 0){

1401 
	`¥ötf
(1, "wait stoppedÉarly\n");

1402 
	`exô
();

1406 if(
	`waô
() != -1){

1407 
	`¥ötf
(1, "wait gotÅoo many\n");

1408 
	`exô
();

1411 
	`¥ötf
(1, "forkÅest OK\n");

1412 
	}
}

1415 
	$sbrkã°
()

1417 
fds
[2], 
pid
, 
pids
[10], 
µid
;

1418 *
a
, *
b
, *
c
, *
œ°addr
, *
ﬁdbrk
, *
p
, 
s¸©ch
;

1419 
uöt
 
amt
;

1421 
	`¥ötf
(
°dout
, "sbrkÅest\n");

1422 
ﬁdbrk
 = 
	`sbrk
(0);

1425 
a
 = 
	`sbrk
(0);

1426 
i
;

1427 
i
 = 0; i < 5000; i++){

1428 
b
 = 
	`sbrk
(1);

1429 if(
b
 !
a
){

1430 
	`¥ötf
(
°dout
, "sbrkÅe° faûed %d %x %x\n", 
i
, 
a
, 
b
);

1431 
	`exô
();

1433 *
b
 = 1;

1434 
a
 = 
b
 + 1;

1436 
pid
 = 
	`f‹k
();

1437 if(
pid
 < 0){

1438 
	`¥ötf
(
°dout
, "sbrkÅest fork failed\n");

1439 
	`exô
();

1441 
c
 = 
	`sbrk
(1);

1442 
c
 = 
	`sbrk
(1);

1443 if(
c
 !
a
 + 1){

1444 
	`¥ötf
(
°dout
, "sbrkÅest failedÖost-fork\n");

1445 
	`exô
();

1447 if(
pid
 == 0)

1448 
	`exô
();

1449 
	`waô
();

1452 
	#BIG
 (100*1024*1024)

	)

1453 
a
 = 
	`sbrk
(0);

1454 
amt
 = (
BIG
Ë- (
uöt
)
a
;

1455 
p
 = 
	`sbrk
(
amt
);

1456 i‡(
p
 !
a
) {

1457 
	`¥ötf
(
°dout
, "sbrkÅest failedÅo grow bigáddress space;ÉnoughÖhys mem?\n");

1458 
	`exô
();

1460 
œ°addr
 = (*Ë(
BIG
-1);

1461 *
œ°addr
 = 99;

1464 
a
 = 
	`sbrk
(0);

1465 
c
 = 
	`sbrk
(-4096);

1466 if(
c
 == (*)0xffffffff){

1467 
	`¥ötf
(
°dout
, "sbrk couldÇot deallocate\n");

1468 
	`exô
();

1470 
c
 = 
	`sbrk
(0);

1471 if(
c
 !
a
 - 4096){

1472 
	`¥ötf
(
°dout
, "sbrk dóŒoˇti⁄Örodu˚d wr⁄gáddªss,á %x c %x\n", 
a
, 
c
);

1473 
	`exô
();

1477 
a
 = 
	`sbrk
(0);

1478 
c
 = 
	`sbrk
(4096);

1479 if(
c
 !
a
 || 
	`sbrk
(0) !=á + 4096){

1480 
	`¥ötf
(
°dout
, "sbrkÑe-Æloˇti⁄ faûed,á %x c %x\n", 
a
, 
c
);

1481 
	`exô
();

1483 if(*
œ°addr
 == 99){

1485 
	`¥ötf
(
°dout
, "sbrk de-allocation didn'tÑeally deallocate\n");

1486 
	`exô
();

1489 
a
 = 
	`sbrk
(0);

1490 
c
 = 
	`sbrk
(-(sbrk(0Ë- 
ﬁdbrk
));

1491 if(
c
 !
a
){

1492 
	`¥ötf
(
°dout
, "sbrk downsizêÁûed,á %x c %x\n", 
a
, 
c
);

1493 
	`exô
();

1497 
a
 = (*)(
KERNBASE
);á < (*) (KERNBASE+2000000);á += 50000){

1498 
µid
 = 
	`gëpid
();

1499 
pid
 = 
	`f‹k
();

1500 if(
pid
 < 0){

1501 
	`¥ötf
(
°dout
, "fork failed\n");

1502 
	`exô
();

1504 if(
pid
 == 0){

1505 
	`¥ötf
(
°dout
, "o›†couldÑód %x = %x\n", 
a
, *a);

1506 
	`kûl
(
µid
);

1507 
	`exô
();

1509 
	`waô
();

1514 if(
	`pùe
(
fds
) != 0){

1515 
	`¥ötf
(1, "pipe() failed\n");

1516 
	`exô
();

1518 
i
 = 0; i < (
pids
)/(pids[0]); i++){

1519 if((
pids
[
i
] = 
	`f‹k
()) == 0){

1521 
	`sbrk
(
BIG
 - (
uöt
)sbrk(0));

1522 
	`wrôe
(
fds
[1], "x", 1);

1524 ;;Ë
	`¶ìp
(1000);

1526 if(
pids
[
i
] != -1)

1527 
	`ªad
(
fds
[0], &
s¸©ch
, 1);

1531 
c
 = 
	`sbrk
(4096);

1532 
i
 = 0; i < (
pids
)/(pids[0]); i++){

1533 if(
pids
[
i
] == -1)

1535 
	`kûl
(
pids
[
i
]);

1536 
	`waô
();

1538 if(
c
 == (*)0xffffffff){

1539 
	`¥ötf
(
°dout
, "failed sbrkÜeaked memory\n");

1540 
	`exô
();

1543 if(
	`sbrk
(0Ë> 
ﬁdbrk
)

1544 
	`sbrk
(-(sbrk(0Ë- 
ﬁdbrk
));

1546 
	`¥ötf
(
°dout
, "sbrkÅest OK\n");

1547 
	}
}

1550 
	$vÆid©eöt
(*
p
)

1552 
ªs
;

1553 
	`asm
("mov %%esp, %%ebx\n\t"

1557 "˜" (
ªs
) :

1558 "a" (
SYS_¶ìp
), "n" (
T_SYSCALL
), "c" (
p
) :

1560 
	}
}

1563 
	$vÆid©ëe°
()

1565 
hi
, 
pid
;

1566 
uöt
 
p
;

1568 
	`¥ötf
(
°dout
, "validateÅest\n");

1569 
hi
 = 1100*1024;

1571 
p
 = 0;Ö <(
uöt
)
hi
;Ö += 4096){

1572 if((
pid
 = 
	`f‹k
()) == 0){

1574 
	`vÆid©eöt
((*)
p
);

1575 
	`exô
();

1577 
	`¶ìp
(0);

1578 
	`¶ìp
(0);

1579 
	`kûl
(
pid
);

1580 
	`waô
();

1583 if(
	`lök
("nosuchfûe", (*)
p
) != -1){

1584 
	`¥ötf
(
°dout
, "link shouldÇot succeed\n");

1585 
	`exô
();

1589 
	`¥ötf
(
°dout
, "validate ok\n");

1590 
	}
}

1593 
	gunöô
[10000];

1595 
	$bs°e°
()

1597 
i
;

1599 
	`¥ötf
(
°dout
, "bssÅest\n");

1600 
i
 = 0; i < (
unöô
); i++){

1601 if(
unöô
[
i
] != '\0'){

1602 
	`¥ötf
(
°dout
, "bssÅest failed\n");

1603 
	`exô
();

1606 
	`¥ötf
(
°dout
, "bssÅest ok\n");

1607 
	}
}

1613 
	$big¨gã°
()

1615 
pid
, 
fd
;

1617 
	`u∆ök
("bigarg-ok");

1618 
pid
 = 
	`f‹k
();

1619 if(
pid
 == 0){

1620 *
¨gs
[
MAXARG
];

1621 
i
;

1622 
i
 = 0; i < 
MAXARG
-1; i++)

1623 
¨gs
[
i
] = "bigargsÅest: failed\n ";

1624 
¨gs
[
MAXARG
-1] = 0;

1625 
	`¥ötf
(
°dout
, "bigargÅest\n");

1626 
	`exec
("echo", 
¨gs
);

1627 
	`¥ötf
(
°dout
, "bigargÅest ok\n");

1628 
fd
 = 
	`›í
("big¨g-ok", 
O_CREATE
);

1629 
	`˛o£
(
fd
);

1630 
	`exô
();

1631 } if(
pid
 < 0){

1632 
	`¥ötf
(
°dout
, "bigargtest: fork failed\n");

1633 
	`exô
();

1635 
	`waô
();

1636 
fd
 = 
	`›í
("bigarg-ok", 0);

1637 if(
fd
 < 0){

1638 
	`¥ötf
(
°dout
, "bigargÅest failed!\n");

1639 
	`exô
();

1641 
	`˛o£
(
fd
);

1642 
	`u∆ök
("bigarg-ok");

1643 
	}
}

1648 
	$fsfuŒ
()

1650 
nfûes
;

1651 
fsblocks
 = 0;

1653 
	`¥ötf
(1, "fsfullÅest\n");

1655 
nfûes
 = 0; ;Çfiles++){

1656 
«me
[64];

1657 
«me
[0] = 'f';

1658 
«me
[1] = '0' + 
nfûes
 / 1000;

1659 
«me
[2] = '0' + (
nfûes
 % 1000) / 100;

1660 
«me
[3] = '0' + (
nfûes
 % 100) / 10;

1661 
«me
[4] = '0' + (
nfûes
 % 10);

1662 
«me
[5] = '\0';

1663 
	`¥ötf
(1, "wrôög %s\n", 
«me
);

1664 
fd
 = 
	`›í
(
«me
, 
O_CREATE
|
O_RDWR
);

1665 if(
fd
 < 0){

1666 
	`¥ötf
(1, "›í %†Áûed\n", 
«me
);

1669 
tŸÆ
 = 0;

1671 
cc
 = 
	`wrôe
(
fd
, 
buf
, 512);

1672 if(
cc
 < 512)

1674 
tŸÆ
 +
cc
;

1675 
fsblocks
++;

1677 
	`¥ötf
(1, "wrŸê%d byãs\n", 
tŸÆ
);

1678 
	`˛o£
(
fd
);

1679 if(
tŸÆ
 == 0)

1683 
nfûes
 >= 0){

1684 
«me
[64];

1685 
«me
[0] = 'f';

1686 
«me
[1] = '0' + 
nfûes
 / 1000;

1687 
«me
[2] = '0' + (
nfûes
 % 1000) / 100;

1688 
«me
[3] = '0' + (
nfûes
 % 100) / 10;

1689 
«me
[4] = '0' + (
nfûes
 % 10);

1690 
«me
[5] = '\0';

1691 
	`u∆ök
(
«me
);

1692 
nfûes
--;

1695 
	`¥ötf
(1, "fsfullÅest finished\n");

1696 
	}
}

1699 
	$uio
()

1701 
	#RTC_ADDR
 0x70

	)

1702 
	#RTC_DATA
 0x71

	)

1704 
ush‹t
 
p‹t
 = 0;

1705 
uch¨
 
vÆ
 = 0;

1706 
pid
;

1708 
	`¥ötf
(1, "uioÅest\n");

1709 
pid
 = 
	`f‹k
();

1710 if(
pid
 == 0){

1711 
p‹t
 = 
RTC_ADDR
;

1712 
vÆ
 = 0x09;

1714 
asm
 vﬁ©ûe("outb %0,%1"::"a"(
vÆ
), "d" (
p‹t
));

1715 
p‹t
 = 
RTC_DATA
;

1716 
asm
 vﬁ©ûe("öb %1,%0" : "˜" (
vÆ
Ë: "d" (
p‹t
));

1717 
	`¥ötf
(1, "uio: uio succeeded;Åest FAILED\n");

1718 
	`exô
();

1719 } if(
pid
 < 0){

1720 
	`¥ötf
 (1, "fork failed\n");

1721 
	`exô
();

1723 
	`waô
();

1724 
	`¥ötf
(1, "uioÅest done\n");

1725 
	}
}

1727 
	$¨g±e°
()

1729 
fd
;

1730 
fd
 = 
	`›í
("öô", 
O_RDONLY
);

1731 i‡(
fd
 < 0) {

1732 
	`¥ötf
(2, "open failed\n");

1733 
	`exô
();

1735 
	`ªad
(
fd
, 
	`sbrk
(0) - 1, -1);

1736 
	`˛o£
(
fd
);

1737 
	`¥ötf
(1, "argÅestÖassed\n");

1738 
	}
}

1740 
	gønd°©e
 = 1;

1742 
	$ønd
()

1744 
ønd°©e
 =Ñandstate * 1664525 + 1013904223;

1745  
ønd°©e
;

1746 
	}
}

1749 
	$maö
(
¨gc
, *
¨gv
[])

1751 
	`¥ötf
(1, "usertests starting\n");

1753 if(
	`›í
("usertests.ran", 0) >= 0){

1754 
	`¥ötf
(1, "alreadyÑan userÅests --Ñebuild fs.img\n");

1755 
	`exô
();

1757 
	`˛o£
(
	`›í
("u£πe°s.øn", 
O_CREATE
));

1759 
	`¨g±e°
();

1760 
	`¸óãdñëe
();

1761 
	`löku∆ök
();

1762 
	`c⁄¸óã
();

1763 
	`fourfûes
();

1764 
	`sh¨edfd
();

1766 
	`big¨gã°
();

1767 
	`bigwrôe
();

1768 
	`big¨gã°
();

1769 
	`bs°e°
();

1770 
	`sbrkã°
();

1771 
	`vÆid©ëe°
();

1773 
	`›íã°
();

1774 
	`wrôëe°
();

1775 
	`wrôëe°1
();

1776 
	`¸óãã°
();

1778 
	`›íùuâe°
();

1779 
	`exôùuâe°
();

1780 
	`ùuâe°
();

1782 
	`mem
();

1783 
	`pùe1
();

1784 
	`¥ìm±
();

1785 
	`exôwaô
();

1787 
	`rmdŸ
();

1788 
	`fouπìn
();

1789 
	`bigfûe
();

1790 
	`subdú
();

1791 
	`lökã°
();

1792 
	`u∆ökªad
();

1793 
	`dúfûe
();

1794 
	`úef
();

1795 
	`f‹kã°
();

1796 
	`bigdú
();

1798 
	`uio
();

1800 
	`exe˘e°
();

1802 
	`exô
();

1803 
	}
}

	@usys.S

1 
	~"sysˇŒ.h
"

2 
	~"å≠s.h
"

4 
	#SYSCALL
(
«me
) \

5 .
globl
 
«me
; \

6 
«me
: \

7 
movl
 
$SYS_
 ## 
«me
, %
óx
; \

8 
$T_SYSCALL
; \

9 
ªt


	)

11 
	$SYSCALL
(
f‹k
)

12 
	$SYSCALL
(
exô
)

13 
	$SYSCALL
(
waô
)

14 
	$SYSCALL
(
pùe
)

15 
	$SYSCALL
(
ªad
)

16 
	$SYSCALL
(
wrôe
)

17 
	$SYSCALL
(
˛o£
)

18 
	$SYSCALL
(
kûl
)

19 
	$SYSCALL
(
exec
)

20 
	$SYSCALL
(
›í
)

21 
	$SYSCALL
(
mknod
)

22 
	$SYSCALL
(
u∆ök
)

23 
	$SYSCALL
(
f°©
)

24 
	$SYSCALL
(
lök
)

25 
	$SYSCALL
(
mkdú
)

26 
	$SYSCALL
(
chdú
)

27 
	$SYSCALL
(
dup
)

28 
	$SYSCALL
(
gëpid
)

29 
	$SYSCALL
(
sbrk
)

30 
	$SYSCALL
(
¶ìp
)

31 
	$SYSCALL
(
u±ime
)

33 
	$SYSCALL
(
yõld
)

34 
	$SYSCALL
(
£t_˝u_sh¨e
)

35 
	$SYSCALL
(
gëÀv
)

37 
	$SYSCALL
(
queue_èbÀ_lookup
)

39 
	$SYSCALL
(
thªad_¸óã
)

40 
	$SYSCALL
(
thªad_joö
)

41 
	`SYSCALL
(
thªad_exô
)

	@vectors.S

1 #gíî©ed 
by
 
ve˘‹s
.
∂
 - dÿ
nŸ
 
edô


3 .
globl
 
	gÆ…øps


4 .
globl
 
ve˘‹0


5 
	gve˘‹0
:

6 
pushl
 
$0


7 
pushl
 
$0


8 
jmp
 
Æ…øps


9 .
globl
 
ve˘‹1


10 
ve˘‹1
:

11 
pushl
 
$0


12 
pushl
 
$1


13 
jmp
 
Æ…øps


14 .
globl
 
ve˘‹2


15 
ve˘‹2
:

16 
pushl
 
$0


17 
pushl
 
$2


18 
jmp
 
Æ…øps


19 .
globl
 
ve˘‹3


20 
ve˘‹3
:

21 
pushl
 
$0


22 
pushl
 
$3


23 
jmp
 
Æ…øps


24 .
globl
 
ve˘‹4


25 
ve˘‹4
:

26 
pushl
 
$0


27 
pushl
 
$4


28 
jmp
 
Æ…øps


29 .
globl
 
ve˘‹5


30 
ve˘‹5
:

31 
pushl
 
$0


32 
pushl
 
$5


33 
jmp
 
Æ…øps


34 .
globl
 
ve˘‹6


35 
ve˘‹6
:

36 
pushl
 
$0


37 
pushl
 
$6


38 
jmp
 
Æ…øps


39 .
globl
 
ve˘‹7


40 
ve˘‹7
:

41 
pushl
 
$0


42 
pushl
 
$7


43 
jmp
 
Æ…øps


44 .
globl
 
ve˘‹8


45 
ve˘‹8
:

46 
pushl
 
$8


47 
jmp
 
Æ…øps


48 .
globl
 
ve˘‹9


49 
ve˘‹9
:

50 
pushl
 
$0


51 
pushl
 
$9


52 
jmp
 
Æ…øps


53 .
globl
 
ve˘‹10


54 
ve˘‹10
:

55 
pushl
 
$10


56 
jmp
 
Æ…øps


57 .
globl
 
ve˘‹11


58 
ve˘‹11
:

59 
pushl
 
$11


60 
jmp
 
Æ…øps


61 .
globl
 
ve˘‹12


62 
ve˘‹12
:

63 
pushl
 
$12


64 
jmp
 
Æ…øps


65 .
globl
 
ve˘‹13


66 
ve˘‹13
:

67 
pushl
 
$13


68 
jmp
 
Æ…øps


69 .
globl
 
ve˘‹14


70 
ve˘‹14
:

71 
pushl
 
$14


72 
jmp
 
Æ…øps


73 .
globl
 
ve˘‹15


74 
ve˘‹15
:

75 
pushl
 
$0


76 
pushl
 
$15


77 
jmp
 
Æ…øps


78 .
globl
 
ve˘‹16


79 
ve˘‹16
:

80 
pushl
 
$0


81 
pushl
 
$16


82 
jmp
 
Æ…øps


83 .
globl
 
ve˘‹17


84 
ve˘‹17
:

85 
pushl
 
$17


86 
jmp
 
Æ…øps


87 .
globl
 
ve˘‹18


88 
ve˘‹18
:

89 
pushl
 
$0


90 
pushl
 
$18


91 
jmp
 
Æ…øps


92 .
globl
 
ve˘‹19


93 
ve˘‹19
:

94 
pushl
 
$0


95 
pushl
 
$19


96 
jmp
 
Æ…øps


97 .
globl
 
ve˘‹20


98 
ve˘‹20
:

99 
pushl
 
$0


100 
pushl
 
$20


101 
jmp
 
Æ…øps


102 .
globl
 
ve˘‹21


103 
ve˘‹21
:

104 
pushl
 
$0


105 
pushl
 
$21


106 
jmp
 
Æ…øps


107 .
globl
 
ve˘‹22


108 
ve˘‹22
:

109 
pushl
 
$0


110 
pushl
 
$22


111 
jmp
 
Æ…øps


112 .
globl
 
ve˘‹23


113 
ve˘‹23
:

114 
pushl
 
$0


115 
pushl
 
$23


116 
jmp
 
Æ…øps


117 .
globl
 
ve˘‹24


118 
ve˘‹24
:

119 
pushl
 
$0


120 
pushl
 
$24


121 
jmp
 
Æ…øps


122 .
globl
 
ve˘‹25


123 
ve˘‹25
:

124 
pushl
 
$0


125 
pushl
 
$25


126 
jmp
 
Æ…øps


127 .
globl
 
ve˘‹26


128 
ve˘‹26
:

129 
pushl
 
$0


130 
pushl
 
$26


131 
jmp
 
Æ…øps


132 .
globl
 
ve˘‹27


133 
ve˘‹27
:

134 
pushl
 
$0


135 
pushl
 
$27


136 
jmp
 
Æ…øps


137 .
globl
 
ve˘‹28


138 
ve˘‹28
:

139 
pushl
 
$0


140 
pushl
 
$28


141 
jmp
 
Æ…øps


142 .
globl
 
ve˘‹29


143 
ve˘‹29
:

144 
pushl
 
$0


145 
pushl
 
$29


146 
jmp
 
Æ…øps


147 .
globl
 
ve˘‹30


148 
ve˘‹30
:

149 
pushl
 
$0


150 
pushl
 
$30


151 
jmp
 
Æ…øps


152 .
globl
 
ve˘‹31


153 
ve˘‹31
:

154 
pushl
 
$0


155 
pushl
 
$31


156 
jmp
 
Æ…øps


157 .
globl
 
ve˘‹32


158 
ve˘‹32
:

159 
pushl
 
$0


160 
pushl
 
$32


161 
jmp
 
Æ…øps


162 .
globl
 
ve˘‹33


163 
ve˘‹33
:

164 
pushl
 
$0


165 
pushl
 
$33


166 
jmp
 
Æ…øps


167 .
globl
 
ve˘‹34


168 
ve˘‹34
:

169 
pushl
 
$0


170 
pushl
 
$34


171 
jmp
 
Æ…øps


172 .
globl
 
ve˘‹35


173 
ve˘‹35
:

174 
pushl
 
$0


175 
pushl
 
$35


176 
jmp
 
Æ…øps


177 .
globl
 
ve˘‹36


178 
ve˘‹36
:

179 
pushl
 
$0


180 
pushl
 
$36


181 
jmp
 
Æ…øps


182 .
globl
 
ve˘‹37


183 
ve˘‹37
:

184 
pushl
 
$0


185 
pushl
 
$37


186 
jmp
 
Æ…øps


187 .
globl
 
ve˘‹38


188 
ve˘‹38
:

189 
pushl
 
$0


190 
pushl
 
$38


191 
jmp
 
Æ…øps


192 .
globl
 
ve˘‹39


193 
ve˘‹39
:

194 
pushl
 
$0


195 
pushl
 
$39


196 
jmp
 
Æ…øps


197 .
globl
 
ve˘‹40


198 
ve˘‹40
:

199 
pushl
 
$0


200 
pushl
 
$40


201 
jmp
 
Æ…øps


202 .
globl
 
ve˘‹41


203 
ve˘‹41
:

204 
pushl
 
$0


205 
pushl
 
$41


206 
jmp
 
Æ…øps


207 .
globl
 
ve˘‹42


208 
ve˘‹42
:

209 
pushl
 
$0


210 
pushl
 
$42


211 
jmp
 
Æ…øps


212 .
globl
 
ve˘‹43


213 
ve˘‹43
:

214 
pushl
 
$0


215 
pushl
 
$43


216 
jmp
 
Æ…øps


217 .
globl
 
ve˘‹44


218 
ve˘‹44
:

219 
pushl
 
$0


220 
pushl
 
$44


221 
jmp
 
Æ…øps


222 .
globl
 
ve˘‹45


223 
ve˘‹45
:

224 
pushl
 
$0


225 
pushl
 
$45


226 
jmp
 
Æ…øps


227 .
globl
 
ve˘‹46


228 
ve˘‹46
:

229 
pushl
 
$0


230 
pushl
 
$46


231 
jmp
 
Æ…øps


232 .
globl
 
ve˘‹47


233 
ve˘‹47
:

234 
pushl
 
$0


235 
pushl
 
$47


236 
jmp
 
Æ…øps


237 .
globl
 
ve˘‹48


238 
ve˘‹48
:

239 
pushl
 
$0


240 
pushl
 
$48


241 
jmp
 
Æ…øps


242 .
globl
 
ve˘‹49


243 
ve˘‹49
:

244 
pushl
 
$0


245 
pushl
 
$49


246 
jmp
 
Æ…øps


247 .
globl
 
ve˘‹50


248 
ve˘‹50
:

249 
pushl
 
$0


250 
pushl
 
$50


251 
jmp
 
Æ…øps


252 .
globl
 
ve˘‹51


253 
ve˘‹51
:

254 
pushl
 
$0


255 
pushl
 
$51


256 
jmp
 
Æ…øps


257 .
globl
 
ve˘‹52


258 
ve˘‹52
:

259 
pushl
 
$0


260 
pushl
 
$52


261 
jmp
 
Æ…øps


262 .
globl
 
ve˘‹53


263 
ve˘‹53
:

264 
pushl
 
$0


265 
pushl
 
$53


266 
jmp
 
Æ…øps


267 .
globl
 
ve˘‹54


268 
ve˘‹54
:

269 
pushl
 
$0


270 
pushl
 
$54


271 
jmp
 
Æ…øps


272 .
globl
 
ve˘‹55


273 
ve˘‹55
:

274 
pushl
 
$0


275 
pushl
 
$55


276 
jmp
 
Æ…øps


277 .
globl
 
ve˘‹56


278 
ve˘‹56
:

279 
pushl
 
$0


280 
pushl
 
$56


281 
jmp
 
Æ…øps


282 .
globl
 
ve˘‹57


283 
ve˘‹57
:

284 
pushl
 
$0


285 
pushl
 
$57


286 
jmp
 
Æ…øps


287 .
globl
 
ve˘‹58


288 
ve˘‹58
:

289 
pushl
 
$0


290 
pushl
 
$58


291 
jmp
 
Æ…øps


292 .
globl
 
ve˘‹59


293 
ve˘‹59
:

294 
pushl
 
$0


295 
pushl
 
$59


296 
jmp
 
Æ…øps


297 .
globl
 
ve˘‹60


298 
ve˘‹60
:

299 
pushl
 
$0


300 
pushl
 
$60


301 
jmp
 
Æ…øps


302 .
globl
 
ve˘‹61


303 
ve˘‹61
:

304 
pushl
 
$0


305 
pushl
 
$61


306 
jmp
 
Æ…øps


307 .
globl
 
ve˘‹62


308 
ve˘‹62
:

309 
pushl
 
$0


310 
pushl
 
$62


311 
jmp
 
Æ…øps


312 .
globl
 
ve˘‹63


313 
ve˘‹63
:

314 
pushl
 
$0


315 
pushl
 
$63


316 
jmp
 
Æ…øps


317 .
globl
 
ve˘‹64


318 
ve˘‹64
:

319 
pushl
 
$0


320 
pushl
 
$64


321 
jmp
 
Æ…øps


322 .
globl
 
ve˘‹65


323 
ve˘‹65
:

324 
pushl
 
$0


325 
pushl
 
$65


326 
jmp
 
Æ…øps


327 .
globl
 
ve˘‹66


328 
ve˘‹66
:

329 
pushl
 
$0


330 
pushl
 
$66


331 
jmp
 
Æ…øps


332 .
globl
 
ve˘‹67


333 
ve˘‹67
:

334 
pushl
 
$0


335 
pushl
 
$67


336 
jmp
 
Æ…øps


337 .
globl
 
ve˘‹68


338 
ve˘‹68
:

339 
pushl
 
$0


340 
pushl
 
$68


341 
jmp
 
Æ…øps


342 .
globl
 
ve˘‹69


343 
ve˘‹69
:

344 
pushl
 
$0


345 
pushl
 
$69


346 
jmp
 
Æ…øps


347 .
globl
 
ve˘‹70


348 
ve˘‹70
:

349 
pushl
 
$0


350 
pushl
 
$70


351 
jmp
 
Æ…øps


352 .
globl
 
ve˘‹71


353 
ve˘‹71
:

354 
pushl
 
$0


355 
pushl
 
$71


356 
jmp
 
Æ…øps


357 .
globl
 
ve˘‹72


358 
ve˘‹72
:

359 
pushl
 
$0


360 
pushl
 
$72


361 
jmp
 
Æ…øps


362 .
globl
 
ve˘‹73


363 
ve˘‹73
:

364 
pushl
 
$0


365 
pushl
 
$73


366 
jmp
 
Æ…øps


367 .
globl
 
ve˘‹74


368 
ve˘‹74
:

369 
pushl
 
$0


370 
pushl
 
$74


371 
jmp
 
Æ…øps


372 .
globl
 
ve˘‹75


373 
ve˘‹75
:

374 
pushl
 
$0


375 
pushl
 
$75


376 
jmp
 
Æ…øps


377 .
globl
 
ve˘‹76


378 
ve˘‹76
:

379 
pushl
 
$0


380 
pushl
 
$76


381 
jmp
 
Æ…øps


382 .
globl
 
ve˘‹77


383 
ve˘‹77
:

384 
pushl
 
$0


385 
pushl
 
$77


386 
jmp
 
Æ…øps


387 .
globl
 
ve˘‹78


388 
ve˘‹78
:

389 
pushl
 
$0


390 
pushl
 
$78


391 
jmp
 
Æ…øps


392 .
globl
 
ve˘‹79


393 
ve˘‹79
:

394 
pushl
 
$0


395 
pushl
 
$79


396 
jmp
 
Æ…øps


397 .
globl
 
ve˘‹80


398 
ve˘‹80
:

399 
pushl
 
$0


400 
pushl
 
$80


401 
jmp
 
Æ…øps


402 .
globl
 
ve˘‹81


403 
ve˘‹81
:

404 
pushl
 
$0


405 
pushl
 
$81


406 
jmp
 
Æ…øps


407 .
globl
 
ve˘‹82


408 
ve˘‹82
:

409 
pushl
 
$0


410 
pushl
 
$82


411 
jmp
 
Æ…øps


412 .
globl
 
ve˘‹83


413 
ve˘‹83
:

414 
pushl
 
$0


415 
pushl
 
$83


416 
jmp
 
Æ…øps


417 .
globl
 
ve˘‹84


418 
ve˘‹84
:

419 
pushl
 
$0


420 
pushl
 
$84


421 
jmp
 
Æ…øps


422 .
globl
 
ve˘‹85


423 
ve˘‹85
:

424 
pushl
 
$0


425 
pushl
 
$85


426 
jmp
 
Æ…øps


427 .
globl
 
ve˘‹86


428 
ve˘‹86
:

429 
pushl
 
$0


430 
pushl
 
$86


431 
jmp
 
Æ…øps


432 .
globl
 
ve˘‹87


433 
ve˘‹87
:

434 
pushl
 
$0


435 
pushl
 
$87


436 
jmp
 
Æ…øps


437 .
globl
 
ve˘‹88


438 
ve˘‹88
:

439 
pushl
 
$0


440 
pushl
 
$88


441 
jmp
 
Æ…øps


442 .
globl
 
ve˘‹89


443 
ve˘‹89
:

444 
pushl
 
$0


445 
pushl
 
$89


446 
jmp
 
Æ…øps


447 .
globl
 
ve˘‹90


448 
ve˘‹90
:

449 
pushl
 
$0


450 
pushl
 
$90


451 
jmp
 
Æ…øps


452 .
globl
 
ve˘‹91


453 
ve˘‹91
:

454 
pushl
 
$0


455 
pushl
 
$91


456 
jmp
 
Æ…øps


457 .
globl
 
ve˘‹92


458 
ve˘‹92
:

459 
pushl
 
$0


460 
pushl
 
$92


461 
jmp
 
Æ…øps


462 .
globl
 
ve˘‹93


463 
ve˘‹93
:

464 
pushl
 
$0


465 
pushl
 
$93


466 
jmp
 
Æ…øps


467 .
globl
 
ve˘‹94


468 
ve˘‹94
:

469 
pushl
 
$0


470 
pushl
 
$94


471 
jmp
 
Æ…øps


472 .
globl
 
ve˘‹95


473 
ve˘‹95
:

474 
pushl
 
$0


475 
pushl
 
$95


476 
jmp
 
Æ…øps


477 .
globl
 
ve˘‹96


478 
ve˘‹96
:

479 
pushl
 
$0


480 
pushl
 
$96


481 
jmp
 
Æ…øps


482 .
globl
 
ve˘‹97


483 
ve˘‹97
:

484 
pushl
 
$0


485 
pushl
 
$97


486 
jmp
 
Æ…øps


487 .
globl
 
ve˘‹98


488 
ve˘‹98
:

489 
pushl
 
$0


490 
pushl
 
$98


491 
jmp
 
Æ…øps


492 .
globl
 
ve˘‹99


493 
ve˘‹99
:

494 
pushl
 
$0


495 
pushl
 
$99


496 
jmp
 
Æ…øps


497 .
globl
 
ve˘‹100


498 
ve˘‹100
:

499 
pushl
 
$0


500 
pushl
 
$100


501 
jmp
 
Æ…øps


502 .
globl
 
ve˘‹101


503 
ve˘‹101
:

504 
pushl
 
$0


505 
pushl
 
$101


506 
jmp
 
Æ…øps


507 .
globl
 
ve˘‹102


508 
ve˘‹102
:

509 
pushl
 
$0


510 
pushl
 
$102


511 
jmp
 
Æ…øps


512 .
globl
 
ve˘‹103


513 
ve˘‹103
:

514 
pushl
 
$0


515 
pushl
 
$103


516 
jmp
 
Æ…øps


517 .
globl
 
ve˘‹104


518 
ve˘‹104
:

519 
pushl
 
$0


520 
pushl
 
$104


521 
jmp
 
Æ…øps


522 .
globl
 
ve˘‹105


523 
ve˘‹105
:

524 
pushl
 
$0


525 
pushl
 
$105


526 
jmp
 
Æ…øps


527 .
globl
 
ve˘‹106


528 
ve˘‹106
:

529 
pushl
 
$0


530 
pushl
 
$106


531 
jmp
 
Æ…øps


532 .
globl
 
ve˘‹107


533 
ve˘‹107
:

534 
pushl
 
$0


535 
pushl
 
$107


536 
jmp
 
Æ…øps


537 .
globl
 
ve˘‹108


538 
ve˘‹108
:

539 
pushl
 
$0


540 
pushl
 
$108


541 
jmp
 
Æ…øps


542 .
globl
 
ve˘‹109


543 
ve˘‹109
:

544 
pushl
 
$0


545 
pushl
 
$109


546 
jmp
 
Æ…øps


547 .
globl
 
ve˘‹110


548 
ve˘‹110
:

549 
pushl
 
$0


550 
pushl
 
$110


551 
jmp
 
Æ…øps


552 .
globl
 
ve˘‹111


553 
ve˘‹111
:

554 
pushl
 
$0


555 
pushl
 
$111


556 
jmp
 
Æ…øps


557 .
globl
 
ve˘‹112


558 
ve˘‹112
:

559 
pushl
 
$0


560 
pushl
 
$112


561 
jmp
 
Æ…øps


562 .
globl
 
ve˘‹113


563 
ve˘‹113
:

564 
pushl
 
$0


565 
pushl
 
$113


566 
jmp
 
Æ…øps


567 .
globl
 
ve˘‹114


568 
ve˘‹114
:

569 
pushl
 
$0


570 
pushl
 
$114


571 
jmp
 
Æ…øps


572 .
globl
 
ve˘‹115


573 
ve˘‹115
:

574 
pushl
 
$0


575 
pushl
 
$115


576 
jmp
 
Æ…øps


577 .
globl
 
ve˘‹116


578 
ve˘‹116
:

579 
pushl
 
$0


580 
pushl
 
$116


581 
jmp
 
Æ…øps


582 .
globl
 
ve˘‹117


583 
ve˘‹117
:

584 
pushl
 
$0


585 
pushl
 
$117


586 
jmp
 
Æ…øps


587 .
globl
 
ve˘‹118


588 
ve˘‹118
:

589 
pushl
 
$0


590 
pushl
 
$118


591 
jmp
 
Æ…øps


592 .
globl
 
ve˘‹119


593 
ve˘‹119
:

594 
pushl
 
$0


595 
pushl
 
$119


596 
jmp
 
Æ…øps


597 .
globl
 
ve˘‹120


598 
ve˘‹120
:

599 
pushl
 
$0


600 
pushl
 
$120


601 
jmp
 
Æ…øps


602 .
globl
 
ve˘‹121


603 
ve˘‹121
:

604 
pushl
 
$0


605 
pushl
 
$121


606 
jmp
 
Æ…øps


607 .
globl
 
ve˘‹122


608 
ve˘‹122
:

609 
pushl
 
$0


610 
pushl
 
$122


611 
jmp
 
Æ…øps


612 .
globl
 
ve˘‹123


613 
ve˘‹123
:

614 
pushl
 
$0


615 
pushl
 
$123


616 
jmp
 
Æ…øps


617 .
globl
 
ve˘‹124


618 
ve˘‹124
:

619 
pushl
 
$0


620 
pushl
 
$124


621 
jmp
 
Æ…øps


622 .
globl
 
ve˘‹125


623 
ve˘‹125
:

624 
pushl
 
$0


625 
pushl
 
$125


626 
jmp
 
Æ…øps


627 .
globl
 
ve˘‹126


628 
ve˘‹126
:

629 
pushl
 
$0


630 
pushl
 
$126


631 
jmp
 
Æ…øps


632 .
globl
 
ve˘‹127


633 
ve˘‹127
:

634 
pushl
 
$0


635 
pushl
 
$127


636 
jmp
 
Æ…øps


637 .
globl
 
ve˘‹128


638 
ve˘‹128
:

639 
pushl
 
$0


640 
pushl
 
$128


641 
jmp
 
Æ…øps


642 .
globl
 
ve˘‹129


643 
ve˘‹129
:

644 
pushl
 
$0


645 
pushl
 
$129


646 
jmp
 
Æ…øps


647 .
globl
 
ve˘‹130


648 
ve˘‹130
:

649 
pushl
 
$0


650 
pushl
 
$130


651 
jmp
 
Æ…øps


652 .
globl
 
ve˘‹131


653 
ve˘‹131
:

654 
pushl
 
$0


655 
pushl
 
$131


656 
jmp
 
Æ…øps


657 .
globl
 
ve˘‹132


658 
ve˘‹132
:

659 
pushl
 
$0


660 
pushl
 
$132


661 
jmp
 
Æ…øps


662 .
globl
 
ve˘‹133


663 
ve˘‹133
:

664 
pushl
 
$0


665 
pushl
 
$133


666 
jmp
 
Æ…øps


667 .
globl
 
ve˘‹134


668 
ve˘‹134
:

669 
pushl
 
$0


670 
pushl
 
$134


671 
jmp
 
Æ…øps


672 .
globl
 
ve˘‹135


673 
ve˘‹135
:

674 
pushl
 
$0


675 
pushl
 
$135


676 
jmp
 
Æ…øps


677 .
globl
 
ve˘‹136


678 
ve˘‹136
:

679 
pushl
 
$0


680 
pushl
 
$136


681 
jmp
 
Æ…øps


682 .
globl
 
ve˘‹137


683 
ve˘‹137
:

684 
pushl
 
$0


685 
pushl
 
$137


686 
jmp
 
Æ…øps


687 .
globl
 
ve˘‹138


688 
ve˘‹138
:

689 
pushl
 
$0


690 
pushl
 
$138


691 
jmp
 
Æ…øps


692 .
globl
 
ve˘‹139


693 
ve˘‹139
:

694 
pushl
 
$0


695 
pushl
 
$139


696 
jmp
 
Æ…øps


697 .
globl
 
ve˘‹140


698 
ve˘‹140
:

699 
pushl
 
$0


700 
pushl
 
$140


701 
jmp
 
Æ…øps


702 .
globl
 
ve˘‹141


703 
ve˘‹141
:

704 
pushl
 
$0


705 
pushl
 
$141


706 
jmp
 
Æ…øps


707 .
globl
 
ve˘‹142


708 
ve˘‹142
:

709 
pushl
 
$0


710 
pushl
 
$142


711 
jmp
 
Æ…øps


712 .
globl
 
ve˘‹143


713 
ve˘‹143
:

714 
pushl
 
$0


715 
pushl
 
$143


716 
jmp
 
Æ…øps


717 .
globl
 
ve˘‹144


718 
ve˘‹144
:

719 
pushl
 
$0


720 
pushl
 
$144


721 
jmp
 
Æ…øps


722 .
globl
 
ve˘‹145


723 
ve˘‹145
:

724 
pushl
 
$0


725 
pushl
 
$145


726 
jmp
 
Æ…øps


727 .
globl
 
ve˘‹146


728 
ve˘‹146
:

729 
pushl
 
$0


730 
pushl
 
$146


731 
jmp
 
Æ…øps


732 .
globl
 
ve˘‹147


733 
ve˘‹147
:

734 
pushl
 
$0


735 
pushl
 
$147


736 
jmp
 
Æ…øps


737 .
globl
 
ve˘‹148


738 
ve˘‹148
:

739 
pushl
 
$0


740 
pushl
 
$148


741 
jmp
 
Æ…øps


742 .
globl
 
ve˘‹149


743 
ve˘‹149
:

744 
pushl
 
$0


745 
pushl
 
$149


746 
jmp
 
Æ…øps


747 .
globl
 
ve˘‹150


748 
ve˘‹150
:

749 
pushl
 
$0


750 
pushl
 
$150


751 
jmp
 
Æ…øps


752 .
globl
 
ve˘‹151


753 
ve˘‹151
:

754 
pushl
 
$0


755 
pushl
 
$151


756 
jmp
 
Æ…øps


757 .
globl
 
ve˘‹152


758 
ve˘‹152
:

759 
pushl
 
$0


760 
pushl
 
$152


761 
jmp
 
Æ…øps


762 .
globl
 
ve˘‹153


763 
ve˘‹153
:

764 
pushl
 
$0


765 
pushl
 
$153


766 
jmp
 
Æ…øps


767 .
globl
 
ve˘‹154


768 
ve˘‹154
:

769 
pushl
 
$0


770 
pushl
 
$154


771 
jmp
 
Æ…øps


772 .
globl
 
ve˘‹155


773 
ve˘‹155
:

774 
pushl
 
$0


775 
pushl
 
$155


776 
jmp
 
Æ…øps


777 .
globl
 
ve˘‹156


778 
ve˘‹156
:

779 
pushl
 
$0


780 
pushl
 
$156


781 
jmp
 
Æ…øps


782 .
globl
 
ve˘‹157


783 
ve˘‹157
:

784 
pushl
 
$0


785 
pushl
 
$157


786 
jmp
 
Æ…øps


787 .
globl
 
ve˘‹158


788 
ve˘‹158
:

789 
pushl
 
$0


790 
pushl
 
$158


791 
jmp
 
Æ…øps


792 .
globl
 
ve˘‹159


793 
ve˘‹159
:

794 
pushl
 
$0


795 
pushl
 
$159


796 
jmp
 
Æ…øps


797 .
globl
 
ve˘‹160


798 
ve˘‹160
:

799 
pushl
 
$0


800 
pushl
 
$160


801 
jmp
 
Æ…øps


802 .
globl
 
ve˘‹161


803 
ve˘‹161
:

804 
pushl
 
$0


805 
pushl
 
$161


806 
jmp
 
Æ…øps


807 .
globl
 
ve˘‹162


808 
ve˘‹162
:

809 
pushl
 
$0


810 
pushl
 
$162


811 
jmp
 
Æ…øps


812 .
globl
 
ve˘‹163


813 
ve˘‹163
:

814 
pushl
 
$0


815 
pushl
 
$163


816 
jmp
 
Æ…øps


817 .
globl
 
ve˘‹164


818 
ve˘‹164
:

819 
pushl
 
$0


820 
pushl
 
$164


821 
jmp
 
Æ…øps


822 .
globl
 
ve˘‹165


823 
ve˘‹165
:

824 
pushl
 
$0


825 
pushl
 
$165


826 
jmp
 
Æ…øps


827 .
globl
 
ve˘‹166


828 
ve˘‹166
:

829 
pushl
 
$0


830 
pushl
 
$166


831 
jmp
 
Æ…øps


832 .
globl
 
ve˘‹167


833 
ve˘‹167
:

834 
pushl
 
$0


835 
pushl
 
$167


836 
jmp
 
Æ…øps


837 .
globl
 
ve˘‹168


838 
ve˘‹168
:

839 
pushl
 
$0


840 
pushl
 
$168


841 
jmp
 
Æ…øps


842 .
globl
 
ve˘‹169


843 
ve˘‹169
:

844 
pushl
 
$0


845 
pushl
 
$169


846 
jmp
 
Æ…øps


847 .
globl
 
ve˘‹170


848 
ve˘‹170
:

849 
pushl
 
$0


850 
pushl
 
$170


851 
jmp
 
Æ…øps


852 .
globl
 
ve˘‹171


853 
ve˘‹171
:

854 
pushl
 
$0


855 
pushl
 
$171


856 
jmp
 
Æ…øps


857 .
globl
 
ve˘‹172


858 
ve˘‹172
:

859 
pushl
 
$0


860 
pushl
 
$172


861 
jmp
 
Æ…øps


862 .
globl
 
ve˘‹173


863 
ve˘‹173
:

864 
pushl
 
$0


865 
pushl
 
$173


866 
jmp
 
Æ…øps


867 .
globl
 
ve˘‹174


868 
ve˘‹174
:

869 
pushl
 
$0


870 
pushl
 
$174


871 
jmp
 
Æ…øps


872 .
globl
 
ve˘‹175


873 
ve˘‹175
:

874 
pushl
 
$0


875 
pushl
 
$175


876 
jmp
 
Æ…øps


877 .
globl
 
ve˘‹176


878 
ve˘‹176
:

879 
pushl
 
$0


880 
pushl
 
$176


881 
jmp
 
Æ…øps


882 .
globl
 
ve˘‹177


883 
ve˘‹177
:

884 
pushl
 
$0


885 
pushl
 
$177


886 
jmp
 
Æ…øps


887 .
globl
 
ve˘‹178


888 
ve˘‹178
:

889 
pushl
 
$0


890 
pushl
 
$178


891 
jmp
 
Æ…øps


892 .
globl
 
ve˘‹179


893 
ve˘‹179
:

894 
pushl
 
$0


895 
pushl
 
$179


896 
jmp
 
Æ…øps


897 .
globl
 
ve˘‹180


898 
ve˘‹180
:

899 
pushl
 
$0


900 
pushl
 
$180


901 
jmp
 
Æ…øps


902 .
globl
 
ve˘‹181


903 
ve˘‹181
:

904 
pushl
 
$0


905 
pushl
 
$181


906 
jmp
 
Æ…øps


907 .
globl
 
ve˘‹182


908 
ve˘‹182
:

909 
pushl
 
$0


910 
pushl
 
$182


911 
jmp
 
Æ…øps


912 .
globl
 
ve˘‹183


913 
ve˘‹183
:

914 
pushl
 
$0


915 
pushl
 
$183


916 
jmp
 
Æ…øps


917 .
globl
 
ve˘‹184


918 
ve˘‹184
:

919 
pushl
 
$0


920 
pushl
 
$184


921 
jmp
 
Æ…øps


922 .
globl
 
ve˘‹185


923 
ve˘‹185
:

924 
pushl
 
$0


925 
pushl
 
$185


926 
jmp
 
Æ…øps


927 .
globl
 
ve˘‹186


928 
ve˘‹186
:

929 
pushl
 
$0


930 
pushl
 
$186


931 
jmp
 
Æ…øps


932 .
globl
 
ve˘‹187


933 
ve˘‹187
:

934 
pushl
 
$0


935 
pushl
 
$187


936 
jmp
 
Æ…øps


937 .
globl
 
ve˘‹188


938 
ve˘‹188
:

939 
pushl
 
$0


940 
pushl
 
$188


941 
jmp
 
Æ…øps


942 .
globl
 
ve˘‹189


943 
ve˘‹189
:

944 
pushl
 
$0


945 
pushl
 
$189


946 
jmp
 
Æ…øps


947 .
globl
 
ve˘‹190


948 
ve˘‹190
:

949 
pushl
 
$0


950 
pushl
 
$190


951 
jmp
 
Æ…øps


952 .
globl
 
ve˘‹191


953 
ve˘‹191
:

954 
pushl
 
$0


955 
pushl
 
$191


956 
jmp
 
Æ…øps


957 .
globl
 
ve˘‹192


958 
ve˘‹192
:

959 
pushl
 
$0


960 
pushl
 
$192


961 
jmp
 
Æ…øps


962 .
globl
 
ve˘‹193


963 
ve˘‹193
:

964 
pushl
 
$0


965 
pushl
 
$193


966 
jmp
 
Æ…øps


967 .
globl
 
ve˘‹194


968 
ve˘‹194
:

969 
pushl
 
$0


970 
pushl
 
$194


971 
jmp
 
Æ…øps


972 .
globl
 
ve˘‹195


973 
ve˘‹195
:

974 
pushl
 
$0


975 
pushl
 
$195


976 
jmp
 
Æ…øps


977 .
globl
 
ve˘‹196


978 
ve˘‹196
:

979 
pushl
 
$0


980 
pushl
 
$196


981 
jmp
 
Æ…øps


982 .
globl
 
ve˘‹197


983 
ve˘‹197
:

984 
pushl
 
$0


985 
pushl
 
$197


986 
jmp
 
Æ…øps


987 .
globl
 
ve˘‹198


988 
ve˘‹198
:

989 
pushl
 
$0


990 
pushl
 
$198


991 
jmp
 
Æ…øps


992 .
globl
 
ve˘‹199


993 
ve˘‹199
:

994 
pushl
 
$0


995 
pushl
 
$199


996 
jmp
 
Æ…øps


997 .
globl
 
ve˘‹200


998 
ve˘‹200
:

999 
pushl
 
$0


1000 
pushl
 
$200


1001 
jmp
 
Æ…øps


1002 .
globl
 
ve˘‹201


1003 
ve˘‹201
:

1004 
pushl
 
$0


1005 
pushl
 
$201


1006 
jmp
 
Æ…øps


1007 .
globl
 
ve˘‹202


1008 
ve˘‹202
:

1009 
pushl
 
$0


1010 
pushl
 
$202


1011 
jmp
 
Æ…øps


1012 .
globl
 
ve˘‹203


1013 
ve˘‹203
:

1014 
pushl
 
$0


1015 
pushl
 
$203


1016 
jmp
 
Æ…øps


1017 .
globl
 
ve˘‹204


1018 
ve˘‹204
:

1019 
pushl
 
$0


1020 
pushl
 
$204


1021 
jmp
 
Æ…øps


1022 .
globl
 
ve˘‹205


1023 
ve˘‹205
:

1024 
pushl
 
$0


1025 
pushl
 
$205


1026 
jmp
 
Æ…øps


1027 .
globl
 
ve˘‹206


1028 
ve˘‹206
:

1029 
pushl
 
$0


1030 
pushl
 
$206


1031 
jmp
 
Æ…øps


1032 .
globl
 
ve˘‹207


1033 
ve˘‹207
:

1034 
pushl
 
$0


1035 
pushl
 
$207


1036 
jmp
 
Æ…øps


1037 .
globl
 
ve˘‹208


1038 
ve˘‹208
:

1039 
pushl
 
$0


1040 
pushl
 
$208


1041 
jmp
 
Æ…øps


1042 .
globl
 
ve˘‹209


1043 
ve˘‹209
:

1044 
pushl
 
$0


1045 
pushl
 
$209


1046 
jmp
 
Æ…øps


1047 .
globl
 
ve˘‹210


1048 
ve˘‹210
:

1049 
pushl
 
$0


1050 
pushl
 
$210


1051 
jmp
 
Æ…øps


1052 .
globl
 
ve˘‹211


1053 
ve˘‹211
:

1054 
pushl
 
$0


1055 
pushl
 
$211


1056 
jmp
 
Æ…øps


1057 .
globl
 
ve˘‹212


1058 
ve˘‹212
:

1059 
pushl
 
$0


1060 
pushl
 
$212


1061 
jmp
 
Æ…øps


1062 .
globl
 
ve˘‹213


1063 
ve˘‹213
:

1064 
pushl
 
$0


1065 
pushl
 
$213


1066 
jmp
 
Æ…øps


1067 .
globl
 
ve˘‹214


1068 
ve˘‹214
:

1069 
pushl
 
$0


1070 
pushl
 
$214


1071 
jmp
 
Æ…øps


1072 .
globl
 
ve˘‹215


1073 
ve˘‹215
:

1074 
pushl
 
$0


1075 
pushl
 
$215


1076 
jmp
 
Æ…øps


1077 .
globl
 
ve˘‹216


1078 
ve˘‹216
:

1079 
pushl
 
$0


1080 
pushl
 
$216


1081 
jmp
 
Æ…øps


1082 .
globl
 
ve˘‹217


1083 
ve˘‹217
:

1084 
pushl
 
$0


1085 
pushl
 
$217


1086 
jmp
 
Æ…øps


1087 .
globl
 
ve˘‹218


1088 
ve˘‹218
:

1089 
pushl
 
$0


1090 
pushl
 
$218


1091 
jmp
 
Æ…øps


1092 .
globl
 
ve˘‹219


1093 
ve˘‹219
:

1094 
pushl
 
$0


1095 
pushl
 
$219


1096 
jmp
 
Æ…øps


1097 .
globl
 
ve˘‹220


1098 
ve˘‹220
:

1099 
pushl
 
$0


1100 
pushl
 
$220


1101 
jmp
 
Æ…øps


1102 .
globl
 
ve˘‹221


1103 
ve˘‹221
:

1104 
pushl
 
$0


1105 
pushl
 
$221


1106 
jmp
 
Æ…øps


1107 .
globl
 
ve˘‹222


1108 
ve˘‹222
:

1109 
pushl
 
$0


1110 
pushl
 
$222


1111 
jmp
 
Æ…øps


1112 .
globl
 
ve˘‹223


1113 
ve˘‹223
:

1114 
pushl
 
$0


1115 
pushl
 
$223


1116 
jmp
 
Æ…øps


1117 .
globl
 
ve˘‹224


1118 
ve˘‹224
:

1119 
pushl
 
$0


1120 
pushl
 
$224


1121 
jmp
 
Æ…øps


1122 .
globl
 
ve˘‹225


1123 
ve˘‹225
:

1124 
pushl
 
$0


1125 
pushl
 
$225


1126 
jmp
 
Æ…øps


1127 .
globl
 
ve˘‹226


1128 
ve˘‹226
:

1129 
pushl
 
$0


1130 
pushl
 
$226


1131 
jmp
 
Æ…øps


1132 .
globl
 
ve˘‹227


1133 
ve˘‹227
:

1134 
pushl
 
$0


1135 
pushl
 
$227


1136 
jmp
 
Æ…øps


1137 .
globl
 
ve˘‹228


1138 
ve˘‹228
:

1139 
pushl
 
$0


1140 
pushl
 
$228


1141 
jmp
 
Æ…øps


1142 .
globl
 
ve˘‹229


1143 
ve˘‹229
:

1144 
pushl
 
$0


1145 
pushl
 
$229


1146 
jmp
 
Æ…øps


1147 .
globl
 
ve˘‹230


1148 
ve˘‹230
:

1149 
pushl
 
$0


1150 
pushl
 
$230


1151 
jmp
 
Æ…øps


1152 .
globl
 
ve˘‹231


1153 
ve˘‹231
:

1154 
pushl
 
$0


1155 
pushl
 
$231


1156 
jmp
 
Æ…øps


1157 .
globl
 
ve˘‹232


1158 
ve˘‹232
:

1159 
pushl
 
$0


1160 
pushl
 
$232


1161 
jmp
 
Æ…øps


1162 .
globl
 
ve˘‹233


1163 
ve˘‹233
:

1164 
pushl
 
$0


1165 
pushl
 
$233


1166 
jmp
 
Æ…øps


1167 .
globl
 
ve˘‹234


1168 
ve˘‹234
:

1169 
pushl
 
$0


1170 
pushl
 
$234


1171 
jmp
 
Æ…øps


1172 .
globl
 
ve˘‹235


1173 
ve˘‹235
:

1174 
pushl
 
$0


1175 
pushl
 
$235


1176 
jmp
 
Æ…øps


1177 .
globl
 
ve˘‹236


1178 
ve˘‹236
:

1179 
pushl
 
$0


1180 
pushl
 
$236


1181 
jmp
 
Æ…øps


1182 .
globl
 
ve˘‹237


1183 
ve˘‹237
:

1184 
pushl
 
$0


1185 
pushl
 
$237


1186 
jmp
 
Æ…øps


1187 .
globl
 
ve˘‹238


1188 
ve˘‹238
:

1189 
pushl
 
$0


1190 
pushl
 
$238


1191 
jmp
 
Æ…øps


1192 .
globl
 
ve˘‹239


1193 
ve˘‹239
:

1194 
pushl
 
$0


1195 
pushl
 
$239


1196 
jmp
 
Æ…øps


1197 .
globl
 
ve˘‹240


1198 
ve˘‹240
:

1199 
pushl
 
$0


1200 
pushl
 
$240


1201 
jmp
 
Æ…øps


1202 .
globl
 
ve˘‹241


1203 
ve˘‹241
:

1204 
pushl
 
$0


1205 
pushl
 
$241


1206 
jmp
 
Æ…øps


1207 .
globl
 
ve˘‹242


1208 
ve˘‹242
:

1209 
pushl
 
$0


1210 
pushl
 
$242


1211 
jmp
 
Æ…øps


1212 .
globl
 
ve˘‹243


1213 
ve˘‹243
:

1214 
pushl
 
$0


1215 
pushl
 
$243


1216 
jmp
 
Æ…øps


1217 .
globl
 
ve˘‹244


1218 
ve˘‹244
:

1219 
pushl
 
$0


1220 
pushl
 
$244


1221 
jmp
 
Æ…øps


1222 .
globl
 
ve˘‹245


1223 
ve˘‹245
:

1224 
pushl
 
$0


1225 
pushl
 
$245


1226 
jmp
 
Æ…øps


1227 .
globl
 
ve˘‹246


1228 
ve˘‹246
:

1229 
pushl
 
$0


1230 
pushl
 
$246


1231 
jmp
 
Æ…øps


1232 .
globl
 
ve˘‹247


1233 
ve˘‹247
:

1234 
pushl
 
$0


1235 
pushl
 
$247


1236 
jmp
 
Æ…øps


1237 .
globl
 
ve˘‹248


1238 
ve˘‹248
:

1239 
pushl
 
$0


1240 
pushl
 
$248


1241 
jmp
 
Æ…øps


1242 .
globl
 
ve˘‹249


1243 
ve˘‹249
:

1244 
pushl
 
$0


1245 
pushl
 
$249


1246 
jmp
 
Æ…øps


1247 .
globl
 
ve˘‹250


1248 
ve˘‹250
:

1249 
pushl
 
$0


1250 
pushl
 
$250


1251 
jmp
 
Æ…øps


1252 .
globl
 
ve˘‹251


1253 
ve˘‹251
:

1254 
pushl
 
$0


1255 
pushl
 
$251


1256 
jmp
 
Æ…øps


1257 .
globl
 
ve˘‹252


1258 
ve˘‹252
:

1259 
pushl
 
$0


1260 
pushl
 
$252


1261 
jmp
 
Æ…øps


1262 .
globl
 
ve˘‹253


1263 
ve˘‹253
:

1264 
pushl
 
$0


1265 
pushl
 
$253


1266 
jmp
 
Æ…øps


1267 .
globl
 
ve˘‹254


1268 
ve˘‹254
:

1269 
pushl
 
$0


1270 
pushl
 
$254


1271 
jmp
 
Æ…øps


1272 .
globl
 
ve˘‹255


1273 
ve˘‹255
:

1274 
pushl
 
$0


1275 
pushl
 
$255


1276 
jmp
 
Æ…øps


1278 #ve˘‹ 
èbÀ


1279 .
d©a


1280 .
globl
 
ve˘‹s


1281 
ve˘‹s
:

1282 .
ve˘‹0


1283 .
ve˘‹1


1284 .
ve˘‹2


1285 .
ve˘‹3


1286 .
ve˘‹4


1287 .
ve˘‹5


1288 .
ve˘‹6


1289 .
ve˘‹7


1290 .
ve˘‹8


1291 .
ve˘‹9


1292 .
ve˘‹10


1293 .
ve˘‹11


1294 .
ve˘‹12


1295 .
ve˘‹13


1296 .
ve˘‹14


1297 .
ve˘‹15


1298 .
ve˘‹16


1299 .
ve˘‹17


1300 .
ve˘‹18


1301 .
ve˘‹19


1302 .
ve˘‹20


1303 .
ve˘‹21


1304 .
ve˘‹22


1305 .
ve˘‹23


1306 .
ve˘‹24


1307 .
ve˘‹25


1308 .
ve˘‹26


1309 .
ve˘‹27


1310 .
ve˘‹28


1311 .
ve˘‹29


1312 .
ve˘‹30


1313 .
ve˘‹31


1314 .
ve˘‹32


1315 .
ve˘‹33


1316 .
ve˘‹34


1317 .
ve˘‹35


1318 .
ve˘‹36


1319 .
ve˘‹37


1320 .
ve˘‹38


1321 .
ve˘‹39


1322 .
ve˘‹40


1323 .
ve˘‹41


1324 .
ve˘‹42


1325 .
ve˘‹43


1326 .
ve˘‹44


1327 .
ve˘‹45


1328 .
ve˘‹46


1329 .
ve˘‹47


1330 .
ve˘‹48


1331 .
ve˘‹49


1332 .
ve˘‹50


1333 .
ve˘‹51


1334 .
ve˘‹52


1335 .
ve˘‹53


1336 .
ve˘‹54


1337 .
ve˘‹55


1338 .
ve˘‹56


1339 .
ve˘‹57


1340 .
ve˘‹58


1341 .
ve˘‹59


1342 .
ve˘‹60


1343 .
ve˘‹61


1344 .
ve˘‹62


1345 .
ve˘‹63


1346 .
ve˘‹64


1347 .
ve˘‹65


1348 .
ve˘‹66


1349 .
ve˘‹67


1350 .
ve˘‹68


1351 .
ve˘‹69


1352 .
ve˘‹70


1353 .
ve˘‹71


1354 .
ve˘‹72


1355 .
ve˘‹73


1356 .
ve˘‹74


1357 .
ve˘‹75


1358 .
ve˘‹76


1359 .
ve˘‹77


1360 .
ve˘‹78


1361 .
ve˘‹79


1362 .
ve˘‹80


1363 .
ve˘‹81


1364 .
ve˘‹82


1365 .
ve˘‹83


1366 .
ve˘‹84


1367 .
ve˘‹85


1368 .
ve˘‹86


1369 .
ve˘‹87


1370 .
ve˘‹88


1371 .
ve˘‹89


1372 .
ve˘‹90


1373 .
ve˘‹91


1374 .
ve˘‹92


1375 .
ve˘‹93


1376 .
ve˘‹94


1377 .
ve˘‹95


1378 .
ve˘‹96


1379 .
ve˘‹97


1380 .
ve˘‹98


1381 .
ve˘‹99


1382 .
ve˘‹100


1383 .
ve˘‹101


1384 .
ve˘‹102


1385 .
ve˘‹103


1386 .
ve˘‹104


1387 .
ve˘‹105


1388 .
ve˘‹106


1389 .
ve˘‹107


1390 .
ve˘‹108


1391 .
ve˘‹109


1392 .
ve˘‹110


1393 .
ve˘‹111


1394 .
ve˘‹112


1395 .
ve˘‹113


1396 .
ve˘‹114


1397 .
ve˘‹115


1398 .
ve˘‹116


1399 .
ve˘‹117


1400 .
ve˘‹118


1401 .
ve˘‹119


1402 .
ve˘‹120


1403 .
ve˘‹121


1404 .
ve˘‹122


1405 .
ve˘‹123


1406 .
ve˘‹124


1407 .
ve˘‹125


1408 .
ve˘‹126


1409 .
ve˘‹127


1410 .
ve˘‹128


1411 .
ve˘‹129


1412 .
ve˘‹130


1413 .
ve˘‹131


1414 .
ve˘‹132


1415 .
ve˘‹133


1416 .
ve˘‹134


1417 .
ve˘‹135


1418 .
ve˘‹136


1419 .
ve˘‹137


1420 .
ve˘‹138


1421 .
ve˘‹139


1422 .
ve˘‹140


1423 .
ve˘‹141


1424 .
ve˘‹142


1425 .
ve˘‹143


1426 .
ve˘‹144


1427 .
ve˘‹145


1428 .
ve˘‹146


1429 .
ve˘‹147


1430 .
ve˘‹148


1431 .
ve˘‹149


1432 .
ve˘‹150


1433 .
ve˘‹151


1434 .
ve˘‹152


1435 .
ve˘‹153


1436 .
ve˘‹154


1437 .
ve˘‹155


1438 .
ve˘‹156


1439 .
ve˘‹157


1440 .
ve˘‹158


1441 .
ve˘‹159


1442 .
ve˘‹160


1443 .
ve˘‹161


1444 .
ve˘‹162


1445 .
ve˘‹163


1446 .
ve˘‹164


1447 .
ve˘‹165


1448 .
ve˘‹166


1449 .
ve˘‹167


1450 .
ve˘‹168


1451 .
ve˘‹169


1452 .
ve˘‹170


1453 .
ve˘‹171


1454 .
ve˘‹172


1455 .
ve˘‹173


1456 .
ve˘‹174


1457 .
ve˘‹175


1458 .
ve˘‹176


1459 .
ve˘‹177


1460 .
ve˘‹178


1461 .
ve˘‹179


1462 .
ve˘‹180


1463 .
ve˘‹181


1464 .
ve˘‹182


1465 .
ve˘‹183


1466 .
ve˘‹184


1467 .
ve˘‹185


1468 .
ve˘‹186


1469 .
ve˘‹187


1470 .
ve˘‹188


1471 .
ve˘‹189


1472 .
ve˘‹190


1473 .
ve˘‹191


1474 .
ve˘‹192


1475 .
ve˘‹193


1476 .
ve˘‹194


1477 .
ve˘‹195


1478 .
ve˘‹196


1479 .
ve˘‹197


1480 .
ve˘‹198


1481 .
ve˘‹199


1482 .
ve˘‹200


1483 .
ve˘‹201


1484 .
ve˘‹202


1485 .
ve˘‹203


1486 .
ve˘‹204


1487 .
ve˘‹205


1488 .
ve˘‹206


1489 .
ve˘‹207


1490 .
ve˘‹208


1491 .
ve˘‹209


1492 .
ve˘‹210


1493 .
ve˘‹211


1494 .
ve˘‹212


1495 .
ve˘‹213


1496 .
ve˘‹214


1497 .
ve˘‹215


1498 .
ve˘‹216


1499 .
ve˘‹217


1500 .
ve˘‹218


1501 .
ve˘‹219


1502 .
ve˘‹220


1503 .
ve˘‹221


1504 .
ve˘‹222


1505 .
ve˘‹223


1506 .
ve˘‹224


1507 .
ve˘‹225


1508 .
ve˘‹226


1509 .
ve˘‹227


1510 .
ve˘‹228


1511 .
ve˘‹229


1512 .
ve˘‹230


1513 .
ve˘‹231


1514 .
ve˘‹232


1515 .
ve˘‹233


1516 .
ve˘‹234


1517 .
ve˘‹235


1518 .
ve˘‹236


1519 .
ve˘‹237


1520 .
ve˘‹238


1521 .
ve˘‹239


1522 .
ve˘‹240


1523 .
ve˘‹241


1524 .
ve˘‹242


1525 .
ve˘‹243


1526 .
ve˘‹244


1527 .
ve˘‹245


1528 .
ve˘‹246


1529 .
ve˘‹247


1530 .
ve˘‹248


1531 .
ve˘‹249


1532 .
ve˘‹250


1533 .
ve˘‹251


1534 .
ve˘‹252


1535 .
ve˘‹253


1536 .
ve˘‹254


1537 .
ve˘‹255


	@vm.c

1 
	~"∑øm.h
"

2 
	~"ty≥s.h
"

3 
	~"defs.h
"

4 
	~"x86.h
"

5 
	~"memœyout.h
"

6 
	~"mmu.h
"

7 
	~"¥oc.h
"

8 
	~"ñf.h
"

10 
d©a
[];

11 
pde_t
 *
	gkpgdú
;

16 
	$£göô
()

18 
˝u
 *
c
;

24 
c
 = &
˝us
[
	`˝uid
()];

25 
c
->
gdt
[
SEG_KCODE
] = 
	`SEG
(
STA_X
|
STA_R
, 0, 0xffffffff, 0);

26 
c
->
gdt
[
SEG_KDATA
] = 
	`SEG
(
STA_W
, 0, 0xffffffff, 0);

27 
c
->
gdt
[
SEG_UCODE
] = 
	`SEG
(
STA_X
|
STA_R
, 0, 0xffffffff, 
DPL_USER
);

28 
c
->
gdt
[
SEG_UDATA
] = 
	`SEG
(
STA_W
, 0, 0xffffffff, 
DPL_USER
);

29 
	`lgdt
(
c
->
gdt
, (c->gdt));

30 
	}
}

35 
±e_t
 *

36 
	$wÆkpgdú
(
pde_t
 *
pgdú
, c⁄° *
va
, 
Æloc
)

38 
pde_t
 *
pde
;

39 
±e_t
 *
pgèb
;

42 
pde
 = &
pgdú
[
	`PDX
(
va
)];

48 if(*
pde
 & 
PTE_P
){

53 
pgèb
 = (
±e_t
*)
	`P2V
(
	`PTE_ADDR
(*
pde
));

57 if(!
Æloc
 || (
pgèb
 = (
±e_t
*)
	`kÆloc
()) == 0)

60 
	`mem£t
(
pgèb
, 0, 
PGSIZE
);

64 *
pde
 = 
	`V2P
(
pgèb
Ë| 
PTE_P
 | 
PTE_W
 | 
PTE_U
;

66  &
pgèb
[
	`PTX
(
va
)];

67 
	}
}

73 
	$m≠∑ges
(
pde_t
 *
pgdú
, *
va
, 
uöt
 
size
, uöà
∑
, 
≥rm
)

75 *
a
, *
œ°
;

76 
±e_t
 *
±e
;

78 
a
 = (*)
	`PGROUNDDOWN
((
uöt
)
va
);

79 
œ°
 = (*)
	`PGROUNDDOWN
(((
uöt
)
va
Ë+ 
size
 - 1);

117 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, 
a
, 1)) == 0)

128 if(*
±e
 & 
PTE_P
)

129 
	`∑nic
("remap");

132 *
±e
 = 
∑
 | 
≥rm
 | 
PTE_P
;

134 if(
a
 =
œ°
)

138 
a
 +
PGSIZE
;

139 
∑
 +
PGSIZE
;

144 
	}
}

169 
	skm≠
 {

170 *
	mvút
;

171 
uöt
 
	mphys_°¨t
;

172 
uöt
 
	mphys_íd
;

173 
	m≥rm
;

174 } 
	gkm≠
[] = {

175 { (*)
KERNBASE
, 0, 
EXTMEM
, 
PTE_W
},

176 { (*)
KERNLINK
, 
V2P
(KERNLINK), V2P(
d©a
), 0},

177 { (*)
d©a
, 
V2P
(d©a), 
PHYSTOP
, 
PTE_W
},

178 { (*)
DEVSPACE
, DEVSPACE, 0, 
PTE_W
},

182 
pde_t
*

183 
	$£tupkvm
()

185 
pde_t
 *
pgdú
;

186 
km≠
 *
k
;

189 if((
pgdú
 = (
pde_t
*)
	`kÆloc
()) == 0)

191 
	`mem£t
(
pgdú
, 0, 
PGSIZE
);

193 i‡(
	`P2V
(
PHYSTOP
Ë> (*)
DEVSPACE
)

194 
	`∑nic
("PHYSTOPÅoo high");

202 
k
 = 
km≠
; k < &km≠[
	`NELEM
(kmap)]; k++)

206 if(
	`m≠∑ges
(
pgdú
, 
k
->
vút
, k->
phys_íd
 - k->
phys_°¨t
,

207 (
uöt
)
k
->
phys_°¨t
, k->
≥rm
) < 0) {

208 
	`˝rötf
("[error] mappage, setupkvm().Öage \'Directory\' cannot be set\n");

209 
	`‰ìvm
(
pgdú
);

212  
pgdú
;

213 
	}
}

218 
	$kvmÆloc
()

220 
kpgdú
 = 
	`£tupkvm
();

221 
	`swôchkvm
();

222 
	}
}

227 
	$swôchkvm
()

229 
	`l¸3
(
	`V2P
(
kpgdú
));

230 
	}
}

234 
	$swôchuvm
(
¥oc
 *
p
)

236 if(
p
 == 0)

237 
	`∑nic
("switchuvm:ÇoÖrocess");

238 if(
p
->
k°ack
 == 0)

239 
	`∑nic
("switchuvm:Ço kstack");

240 if(
p
->
pgdú
 == 0)

241 
	`∑nic
("switchuvm:ÇoÖgdir");

243 
	`push˛i
();

244 
	`my˝u
()->
gdt
[
SEG_TSS
] = 
	`SEG16
(
STS_T32A
, &my˝u()->
ts
,

245 (
	`my˝u
()->
ts
)-1, 0);

246 
	`my˝u
()->
gdt
[
SEG_TSS
].
s
 = 0;

247 
	`my˝u
()->
ts
.
ss0
 = 
SEG_KDATA
 << 3;

248 
	`my˝u
()->
ts
.
e•0
 = (
uöt
)
p
->
k°ack
 + 
KSTACKSIZE
;

251 
	`my˝u
()->
ts
.
iomb
 = (
ush‹t
) 0xFFFF;

252 
	`…r
(
SEG_TSS
 << 3);

253 
	`l¸3
(
	`V2P
(
p
->
pgdú
));

254 
	`p›˛i
();

255 
	}
}

260 
	$öôuvm
(
pde_t
 *
pgdú
, *
öô
, 
uöt
 
sz
)

262 *
mem
;

264 if(
sz
 >
PGSIZE
)

265 
	`∑nic
("inituvm: moreÅhanáÖage");

266 
mem
 = 
	`kÆloc
();

267 
	`mem£t
(
mem
, 0, 
PGSIZE
);

268 
	`m≠∑ges
(
pgdú
, 0, 
PGSIZE
, 
	`V2P
(
mem
), 
PTE_W
|
PTE_U
);

269 
	`memmove
(
mem
, 
öô
, 
sz
);

270 
	}
}

275 
	$lﬂduvm
(
pde_t
 *
pgdú
, *
addr
, 
öode
 *
ù
, 
uöt
 
off£t
, uöà
sz
)

277 
uöt
 
i
, 
∑
, 
n
;

278 
±e_t
 *
±e
;

280 if((
uöt
Ë
addr
 % 
PGSIZE
 != 0)

281 
	`∑nic
("loaduvm:áddr must beÖageáligned");

282 
i
 = 0; i < 
sz
; i +
PGSIZE
){

283 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, 
addr
+
i
, 0)) == 0)

284 
	`∑nic
("loaduvm:áddress shouldÉxist");

285 
∑
 = 
	`PTE_ADDR
(*
±e
);

286 if(
sz
 - 
i
 < 
PGSIZE
)

287 
n
 = 
sz
 - 
i
;

289 
n
 = 
PGSIZE
;

290 if(
	`ªadi
(
ù
, 
	`P2V
(
∑
), 
off£t
+
i
, 
n
) !=Ç)

294 
	}
}

299 
	$Ælocuvm
(
pde_t
 *
pgdú
, 
uöt
 
ﬁdsz
, uöà
√wsz
)

301 *
mem
;

302 
uöt
 
a
;

304 if(
√wsz
 >
KERNBASE
)

306 if(
√wsz
 < 
ﬁdsz
)

307  
ﬁdsz
;

314 
a
 = 
	`PGROUNDUP
(
ﬁdsz
);

315 ; 
a
 < 
√wsz
;á +
PGSIZE
){

316 
	`˝rötf
("®ö uvm[%x]\n",
a
);

317 
mem
 = 
	`kÆloc
();

318 if(
mem
 == 0){

319 
	`˝rötf
("allocuvm out of memory\n");

320 
	`dóŒocuvm
(
pgdú
, 
√wsz
, 
ﬁdsz
);

323 
	`mem£t
(
mem
, 0, 
PGSIZE
);

324 if(
	`m≠∑ges
(
pgdú
, (*)
a
, 
PGSIZE
, 
	`V2P
(
mem
), 
PTE_W
|
PTE_U
) < 0){

325 
	`˝rötf
("allocuvm out of memory (2)\n");

326 
	`dóŒocuvm
(
pgdú
, 
√wsz
, 
ﬁdsz
);

327 
	`k‰ì
(
mem
);

331  
√wsz
;

332 
	}
}

339 
	$dóŒocuvm
(
pde_t
 *
pgdú
, 
uöt
 
ﬁdsz
, uöà
√wsz
)

341 
±e_t
 *
±e
;

342 
uöt
 
a
, 
∑
;

344 if(
√wsz
 >
ﬁdsz
)

345  
ﬁdsz
;

347 
a
 = 
	`PGROUNDUP
(
√wsz
);

348 ; 
a
 < 
ﬁdsz
;á +
PGSIZE
){

349 
±e
 = 
	`wÆkpgdú
(
pgdú
, (*)
a
, 0);

350 if(!
±e
)

351 
a
 = 
	`PGADDR
(
	`PDX
◊Ë+ 1, 0, 0Ë- 
PGSIZE
;

352 if((*
±e
 & 
PTE_P
) != 0){

353 
∑
 = 
	`PTE_ADDR
(*
±e
);

354 if(
∑
 == 0)

355 
	`∑nic
("kfree");

356 *
v
 = 
	`P2V
(
∑
);

357 
	`k‰ì
(
v
);

358 *
±e
 = 0;

361  
√wsz
;

362 
	}
}

367 
	$‰ìvm
(
pde_t
 *
pgdú
)

369 
uöt
 
i
;

371 if(
pgdú
 == 0)

372 
	`∑nic
("freevm:ÇoÖgdir");

373 
	`dóŒocuvm
(
pgdú
, 
KERNBASE
, 0);

374 
i
 = 0; i < 
NPDENTRIES
; i++){

375 if(
pgdú
[
i
] & 
PTE_P
){

376 * 
v
 = 
	`P2V
(
	`PTE_ADDR
(
pgdú
[
i
]));

377 
	`k‰ì
(
v
);

380 
	`k‰ì
((*)
pgdú
);

381 
	}
}

386 
	$˛óΩãu
(
pde_t
 *
pgdú
, *
uva
)

388 
±e_t
 *
±e
;

390 
±e
 = 
	`wÆkpgdú
(
pgdú
, 
uva
, 0);

391 if(
±e
 == 0)

392 
	`∑nic
("clearpteu");

393 *
±e
 &~
PTE_U
;

394 
	}
}

398 
pde_t
*

399 
	$c›yuvm
(
pde_t
 *
pgdú
, 
uöt
 
sz
)

401 
pde_t
 *
d
;

402 
±e_t
 *
±e
;

403 
uöt
 
∑
, 
i
, 
Êags
;

404 *
mem
;

406 if((
d
 = 
	`£tupkvm
()) == 0)

408 
i
 = 0; i < 
sz
; i +
PGSIZE
){

409 if((
±e
 = 
	`wÆkpgdú
(
pgdú
, (*Ë
i
, 0)) == 0)

410 
	`∑nic
("copyuvm:Öte shouldÉxist");

411 if(!(*
±e
 & 
PTE_P
))

412 
	`∑nic
("copyuvm:ÖageÇotÖresent");

413 
∑
 = 
	`PTE_ADDR
(*
±e
);

414 
Êags
 = 
	`PTE_FLAGS
(*
±e
);

417 if((
mem
 = 
	`kÆloc
()) == 0)

418 
bad
;

421 
	`memmove
(
mem
, (*)
	`P2V
(
∑
), 
PGSIZE
);

425 if(
	`m≠∑ges
(
d
, (*)
i
, 
PGSIZE
, 
	`V2P
(
mem
), 
Êags
) < 0) {

426 
	`k‰ì
(
mem
);

427 
bad
;

430  
d
;

432 
bad
:

433 
	`‰ìvm
(
d
);

435 
	}
}

440 
	$uva2ka
(
pde_t
 *
pgdú
, *
uva
)

442 
±e_t
 *
±e
;

444 
±e
 = 
	`wÆkpgdú
(
pgdú
, 
uva
, 0);

445 if((*
±e
 & 
PTE_P
) == 0)

447 if((*
±e
 & 
PTE_U
) == 0)

449  (*)
	`P2V
(
	`PTE_ADDR
(*
±e
));

450 
	}
}

456 
	$c›yout
(
pde_t
 *
pgdú
, 
uöt
 
va
, *
p
, uöà
Àn
)

458 *
buf
, *
∑0
;

459 
uöt
 
n
, 
va0
;

461 
buf
 = (*)
p
;

462 
Àn
 > 0){

463 
va0
 = (
uöt
)
	`PGROUNDDOWN
(
va
);

464 
∑0
 = 
	`uva2ka
(
pgdú
, (*)
va0
);

465 if(
∑0
 == 0)

467 
n
 = 
PGSIZE
 - (
va
 - 
va0
);

468 if(
n
 > 
Àn
)

469 
n
 = 
Àn
;

470 
	`memmove
(
∑0
 + (
va
 - 
va0
), 
buf
, 
n
);

471 
Àn
 -
n
;

472 
buf
 +
n
;

473 
va
 = 
va0
 + 
PGSIZE
;

476 
	}
}

	@wc.c

1 
	~"ty≥s.h
"

2 
	~"°©.h
"

3 
	~"u£r.h
"

5 
	gbuf
[512];

8 
	$wc
(
fd
, *
«me
)

10 
i
, 
n
;

11 
l
, 
w
, 
c
, 
öw‹d
;

13 
l
 = 
w
 = 
c
 = 0;

14 
öw‹d
 = 0;

15 (
n
 = 
	`ªad
(
fd
, 
buf
, (buf))) > 0){

16 
i
=0; i<
n
; i++){

17 
c
++;

18 if(
buf
[
i
] == '\n')

19 
l
++;

20 if(
	`°rchr
(" \r\t\n\v", 
buf
[
i
]))

21 
öw‹d
 = 0;

22 if(!
öw‹d
){

23 
w
++;

24 
öw‹d
 = 1;

28 if(
n
 < 0){

29 
	`¥ötf
(1, "wc:ÑeadÉrror\n");

30 
	`exô
();

32 
	`¥ötf
(1, "%d %d %d %s\n", 
l
, 
w
, 
c
, 
«me
);

33 
	}
}

36 
	$maö
(
¨gc
, *
¨gv
[])

38 
fd
, 
i
;

40 if(
¨gc
 <= 1){

41 
	`wc
(0, "");

42 
	`exô
();

45 
i
 = 1; i < 
¨gc
; i++){

46 if((
fd
 = 
	`›í
(
¨gv
[
i
], 0)) < 0){

47 
	`¥ötf
(1, "wc: c™nŸ o≥¿%s\n", 
¨gv
[
i
]);

48 
	`exô
();

50 
	`wc
(
fd
, 
¨gv
[
i
]);

51 
	`˛o£
(
fd
);

53 
	`exô
();

54 
	}
}

	@x86.h

3 
ölöe
 
uch¨


4 
	$öb
(
ush‹t
 
p‹t
)

6 
uch¨
 
d©a
;

8 
asm
 vﬁ©ûe("ö %1,%0" : "˜" (
d©a
Ë: "d" (
p‹t
));

9  
d©a
;

10 
	}
}

12 
ölöe
 

13 
	$ö¶
(
p‹t
, *
addr
, 
˙t
)

15 
asm
 volatile("cld;Ñep insl" :

16 "=D" (
addr
), "=c" (
˙t
) :

17 "d" (
p‹t
), "0" (
addr
), "1" (
˙t
) :

19 
	}
}

21 
ölöe
 

22 
	$outb
(
ush‹t
 
p‹t
, 
uch¨
 
d©a
)

24 
asm
 vﬁ©ûe("ouà%0,%1" : : "a" (
d©a
), "d" (
p‹t
));

25 
	}
}

27 
ölöe
 

28 
	$outw
(
ush‹t
 
p‹t
, ush‹à
d©a
)

30 
asm
 vﬁ©ûe("ouà%0,%1" : : "a" (
d©a
), "d" (
p‹t
));

31 
	}
}

33 
ölöe
 

34 
	$out¶
(
p‹t
, c⁄° *
addr
, 
˙t
)

36 
asm
 volatile("cld;Ñep outsl" :

37 "=S" (
addr
), "=c" (
˙t
) :

38 "d" (
p‹t
), "0" (
addr
), "1" (
˙t
) :

40 
	}
}

42 
ölöe
 

43 
	$°osb
(*
addr
, 
d©a
, 
˙t
)

45 
asm
 volatile("cld;Ñep stosb" :

46 "=D" (
addr
), "=c" (
˙t
) :

47 "0" (
addr
), "1" (
˙t
), "a" (
d©a
) :

49 
	}
}

51 
ölöe
 

52 
	$°o¶
(*
addr
, 
d©a
, 
˙t
)

54 
asm
 volatile("cld;Ñep stosl" :

55 "=D" (
addr
), "=c" (
˙t
) :

56 "0" (
addr
), "1" (
˙t
), "a" (
d©a
) :

58 
	}
}

60 
	g£gdesc
;

62 
ölöe
 

63 
	$lgdt
(
£gdesc
 *
p
, 
size
)

65 vﬁ©ûê
ush‹t
 
pd
[3];

67 
pd
[0] = 
size
-1;

68 
pd
[1] = (
uöt
)
p
;

69 
pd
[2] = (
uöt
)
p
 >> 16;

71 
asm
 vﬁ©ûe("lgdà(%0)" : : "r" (
pd
));

72 
	}
}

74 
	gg©edesc
;

76 
ölöe
 

77 
	$lidt
(
g©edesc
 *
p
, 
size
)

79 vﬁ©ûê
ush‹t
 
pd
[3];

81 
pd
[0] = 
size
-1;

82 
pd
[1] = (
uöt
)
p
;

83 
pd
[2] = (
uöt
)
p
 >> 16;

85 
asm
 vﬁ©ûe("lidà(%0)" : : "r" (
pd
));

86 
	}
}

88 
ölöe
 

89 
	$…r
(
ush‹t
 
£l
)

91 
asm
 vﬁ©ûe("…∏%0" : : "r" (
£l
));

92 
	}
}

94 
ölöe
 
uöt


95 
	$ªadeÊags
()

97 
uöt
 
eÊags
;

98 
asm
 vﬁ©ûe("pushÊ;Ö›»%0" : "Ù" (
eÊags
));

99  
eÊags
;

100 
	}
}

102 
ölöe
 

103 
	$lﬂdgs
(
ush‹t
 
v
)

105 
asm
 vﬁ©ûe("movw %0, %%gs" : : "r" (
v
));

106 
	}
}

108 
ölöe
 

109 
	$˛i
()

111 
asm
 volatile("cli");

112 
	}
}

114 
ölöe
 

115 
	$°i
()

117 
asm
 volatile("sti");

118 
	}
}

120 
ölöe
 
uöt


121 
	$xchg
(vﬁ©ûê
uöt
 *
addr
, uöà
√wvÆ
)

123 
uöt
 
ªsu…
;

126 
asm
 volatile("lock; xchgl %0, %1" :

127 "+m" (*
addr
), "˜" (
ªsu…
) :

128 "1" (
√wvÆ
) :

130  
ªsu…
;

131 
	}
}

133 
ölöe
 
uöt


134 
	$r¸2
()

136 
uöt
 
vÆ
;

137 
asm
 vﬁ©ûe("mov»%%¸2,%0" : "Ù" (
vÆ
));

138  
vÆ
;

139 
	}
}

141 
ölöe
 

142 
	$l¸3
(
uöt
 
vÆ
)

144 
asm
 vﬁ©ûe("mov»%0,%%¸3" : : "r" (
vÆ
));

145 
	}
}

150 
	så≠‰ame
 {

152 
uöt
 
	medi
;

153 
uöt
 
	mesi
;

154 
uöt
 
	mebp
;

155 
uöt
 
	m€•
;

156 
uöt
 
	mebx
;

157 
uöt
 
	medx
;

158 
uöt
 
	mecx
;

159 
uöt
 
	móx
;

162 
ush‹t
 
	mgs
;

163 
ush‹t
 
	m∑ddög1
;

164 
ush‹t
 
	mfs
;

165 
ush‹t
 
	m∑ddög2
;

166 
ush‹t
 
	mes
;

167 
ush‹t
 
	m∑ddög3
;

168 
ush‹t
 
	mds
;

169 
ush‹t
 
	m∑ddög4
;

170 
uöt
 
	må≠no
;

173 
uöt
 
	mîr
;

174 
uöt
 
	meù
;

175 
ush‹t
 
	mcs
;

176 
ush‹t
 
	m∑ddög5
;

177 
uöt
 
	meÊags
;

180 
uöt
 
	me•
;

181 
ush‹t
 
	mss
;

182 
ush‹t
 
	m∑ddög6
;

	@zombie.c

4 
	~"ty≥s.h
"

5 
	~"°©.h
"

6 
	~"u£r.h
"

9 
	$maö
()

11 if(
	`f‹k
() > 0)

12 
	`¶ìp
(5);

13 
	`exô
();

14 
	}
}

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #i‚de‡
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

70 
__löe
, c⁄° *
__fun˘i⁄
)

71 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

74 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

75 
__löe
, c⁄° *
__fun˘i⁄
)

76 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

81 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

82 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

85 
__END_DECLS


91 #i‡
deföed
 
__˝lu•lus


92 
	#as£π
(
ex¥
) \

93 (
°©ic_ˇ°
 <
boﬁ
> (
ex¥
) \

95 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ñi‡!
deföed
 
__GNUC__
 || deföed 
__STRICT_ANSI__


97 
	#as£π
(
ex¥
) \

98 ((
ex¥
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£π
(
ex¥
) \

108 ((Ë ((
ex¥
Ë? 1 : 0), 
	`__exãnsi⁄__
 ({ \

109 i‡(
ex¥
) \

112 
	`__as£π_Áû
 (#ex¥, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£π_≥º‹
(
î∫um
) \

118 (!(
î∫um
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #i‡
deföed
 
__˝lu•lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__exãnsi⁄__
 
__PRETTY_FUNCTION__


	)

131 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

141 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


142 #unde‡
°©ic_as£π


143 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<bôs/libc-hódî-°¨t.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	~<bôs/ty≥s/__FILE.h
>

37 
	~<bôs/ty≥s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<bôs/libio.h
>

43 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


44 #ifde‡
__GNUC__


45 #i‚de‡
_VA_LIST_DEFINED


46 
_G_va_li°
 
	tva_li°
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<°d¨g.h
>

54 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


55 #i‚de‡
__off_t_deföed


56 #i‚de‡
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_deföed


	)

63 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_deföed


	)

69 #ifde‡
__USE_XOPEN2K8


70 #i‚de‡
__ssize_t_deföed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_deföed


	)

77 #i‚de‡
__USE_FILE_OFFSET64


78 
_G_Âos_t
 
	tÂos_t
;

80 
_G_Âos64_t
 
	tÂos_t
;

82 #ifde‡
__USE_LARGEFILE64


83 
_G_Âos64_t
 
	tÂos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #i‚de‡
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #i‚de‡
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifde‡
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


118 
	#P_tmpdú
 "/tmp"

	)

131 
	~<bôs/°dio_lim.h
>

135 
_IO_FILE
 *
°dö
;

136 
_IO_FILE
 *
°dout
;

137 
_IO_FILE
 *
°dîr
;

139 
	#°dö
 
°dö


	)

140 
	#°dout
 
°dout


	)

141 
	#°dîr
 
°dîr


	)

144 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

146 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

148 #ifde‡
__USE_ATFILE


150 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

151 c⁄° *
__√w
Ë
__THROW
;

158 #i‚de‡
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

161 #ifde‡
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

164 
	#tmpfûe
 
tmpfûe64


	)

168 #ifde‡
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

173 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

175 #ifde‡
__USE_MISC


178 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

182 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


190 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

191 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

199 
	`f˛o£
 (
FILE
 *
__°ªam
);

204 
	`fÊush
 (
FILE
 *
__°ªam
);

206 #ifde‡
__USE_MISC


213 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

216 #ifde‡
__USE_GNU


223 
	`f˛o£Æl
 ();

227 #i‚de‡
__USE_FILE_OFFSET64


232 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

233 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

238 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

239 c⁄° *
__ª°ri˘
 
__modes
,

240 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

242 #ifde‡
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

244 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

247 c⁄° *
__ª°ri˘
 
__modes
,

248 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

249 
__wur
;

251 
	#f›í
 
f›í64


	)

252 
	#‰e›í
 
‰e›í64


	)

255 #ifde‡
__USE_LARGEFILE64


256 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

257 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

258 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

259 c⁄° *
__ª°ri˘
 
__modes
,

260 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

272 c⁄° *
__ª°ri˘
 
__modes
,

273 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

276 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

295 
__modes
, 
size_t
 
__n
Ë
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

301 
size_t
 
__size
Ë
__THROW
;

304 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

312 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

313 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

318 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

320 
	$•rötf
 (*
__ª°ri˘
 
__s
,

321 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

327 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

328 
_G_va_li°
 
__¨g
);

333 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

335 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

336 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

338 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_UNIX98


340 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

341 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

342 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

344 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

345 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

346 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

349 #i‡
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

353 
_G_va_li°
 
__¨g
)

354 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

355 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

356 c⁄° *
__ª°ri˘
 
__fmt
, ...)

357 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

358 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

359 c⁄° *
__ª°ri˘
 
__fmt
, ...)

360 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

363 #ifde‡
__USE_XOPEN2K8


365 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

366 
_G_va_li°
 
__¨g
)

367 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

368 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

369 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

377 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

378 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

383 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

385 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

386 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

388 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

389 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

390 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

391 #ifde‡
__REDIRECT


395 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

396 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

397 
__isoc99_fsˇnf
Ë
__wur
;

398 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

399 
__isoc99_sˇnf
Ë
__wur
;

400 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

401 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

402 
__isoc99_ssˇnf
);

404 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

405 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

406 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

407 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

408 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

409 
	#fsˇnf
 
__isoc99_fsˇnf


	)

410 
	#sˇnf
 
__isoc99_sˇnf


	)

411 
	#ssˇnf
 
__isoc99_ssˇnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

421 
_G_va_li°
 
__¨g
)

422 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

428 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

429 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

432 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

433 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

434 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

436 #i‡!
deföed
 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
vfsˇnf
,

444 (
FILE
 *
__ª°ri˘
 
__s
,

445 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

446 
__isoc99_vfsˇnf
)

447 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

448 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

449 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

450 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

451 
	`__REDIRECT_NTH
 (
vssˇnf
,

452 (c⁄° *
__ª°ri˘
 
__s
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
,

454 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

455 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

457 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

458 c⁄° *
__ª°ri˘
 
__f‹m©
,

459 
_G_va_li°
 
__¨g
Ë
__wur
;

460 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

461 
_G_va_li°
 
__¨g
Ë
__wur
;

462 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

463 c⁄° *
__ª°ri˘
 
__f‹m©
,

464 
_G_va_li°
 
__¨g
Ë
__THROW
;

465 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

466 
	#vsˇnf
 
__isoc99_vsˇnf


	)

467 
	#vssˇnf
 
__isoc99_vssˇnf


	)

477 
	`fgëc
 (
FILE
 *
__°ªam
);

478 
	`gëc
 (
FILE
 *
__°ªam
);

484 
	`gëch¨
 ();

488 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

490 #ifde‡
__USE_POSIX199506


495 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

496 
	`gëch¨_u∆ocked
 ();

499 #ifde‡
__USE_MISC


506 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

517 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

518 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

524 
	`putch¨
 (
__c
);

528 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

530 #ifde‡
__USE_MISC


537 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

540 #ifde‡
__USE_POSIX199506


545 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

546 
	`putch¨_u∆ocked
 (
__c
);

550 #i‡
deföed
 
__USE_MISC
 \

551 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

553 
	`gëw
 (
FILE
 *
__°ªam
);

556 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

564 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

565 
__wur
;

567 #i‡
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

580 #ifde‡
__USE_GNU


587 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

588 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

592 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

604 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

605 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

606 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

607 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

608 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

616 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

617 
size_t
 *
__ª°ri˘
 
__n
,

618 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

626 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

632 
	`puts
 (c⁄° *
__s
);

639 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

646 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

652 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

653 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

655 #ifde‡
__USE_GNU


662 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

663 
FILE
 *
__ª°ri˘
 
__°ªam
);

666 #ifde‡
__USE_MISC


673 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

675 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

676 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

684 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

689 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

694 
	`ªwöd
 (
FILE
 *
__°ªam
);

701 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


702 #i‚de‡
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

712 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

714 #ifde‡
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#·ñlo
 
·ñlo64


	)

726 #i‚de‡
__USE_FILE_OFFSET64


731 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

736 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

738 #ifde‡
__REDIRECT


739 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

740 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

741 
	`__REDIRECT
 (
f£ços
,

742 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

744 
	#fgëpos
 
fgëpos64


	)

745 
	#f£ços
 
f£ços64


	)

749 #ifde‡
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

751 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

752 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

753 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

757 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

759 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

761 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

763 #ifde‡
__USE_MISC


765 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

766 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

767 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

775 
	`≥º‹
 (c⁄° *
__s
);

781 
	~<bôs/sys_îæi°.h
>

784 #ifdef 
__USE_POSIX


786 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

789 #ifde‡
__USE_MISC


791 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

795 #ifde‡
__USE_POSIX2


800 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

806 
	`p˛o£
 (
FILE
 *
__°ªam
);

810 #ifdef 
__USE_POSIX


812 *
	$˘îmid
 (*
__s
Ë
__THROW
;

816 #i‡(
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
Ë|| deföed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob°ack
;

826 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

827 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

828 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

829 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

830 c⁄° *
__ª°ri˘
 
__f‹m©
,

831 
_G_va_li°
 
__¨gs
)

832 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

836 #ifde‡
__USE_POSIX199506


840 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

844 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

847 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

850 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


853 
	~<bôs/gë›t_posix.h
>

858 #ifde‡
__USE_EXTERN_INLINES


859 
	~<bôs/°dio.h
>

861 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


862 
	~<bôs/°dio2.h
>

864 #ifde‡
__LDBL_COMPAT


865 
	~<bôs/°dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<bôs/libc-hódî-°¨t.h
>

28 
	#__√ed_size_t


	)

29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

31 
	~<°ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


39 
	~<bôs/waôÊags.h
>

40 
	~<bôs/waô°©us.h
>

43 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (°©us)

	)

44 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (°©us)

	)

45 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (°©us)

	)

46 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (°©us)

	)

47 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (°©us)

	)

48 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (°©us)

	)

49 #ifde‡
__WIFCONTINUED


50 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (°©us)

	)

55 
	~<bôs/Êﬂä.h
>

60 
	mquŸ
;

61 
	mªm
;

62 } 
	tdiv_t
;

65 #i‚de‡
__ldiv_t_deföed


68 
	mquŸ
;

69 
	mªm
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_deföed
 1

	)

74 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


76 
__exãnsi⁄__
 struct

78 
	mquŸ
;

79 
	mªm
;

80 } 
	tŒdiv_t
;

81 
	#__Œdiv_t_deföed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

97 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

101 
	$©of
 (c⁄° *
__≈å
)

102 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

104 
	$©oi
 (c⁄° *
__≈å
)

105 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

107 
	$©ﬁ
 (c⁄° *
__≈å
)

108 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

110 #ifde‡
__USE_ISOC99


112 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

113 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

117 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

118 **
__ª°ri˘
 
__íd±r
)

119 
__THROW
 
	`__n⁄nuŒ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

124 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

126 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

127 **
__ª°ri˘
 
__íd±r
)

128 
__THROW
 
	`__n⁄nuŒ
 ((1));

133 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flﬂt16
 
	$°πof16
 (c⁄° *
__ª°ri˘
 
__≈å
,

135 **
__ª°ri˘
 
__íd±r
)

136 
__THROW
 
	`__n⁄nuŒ
 ((1));

139 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flﬂt32
 
	$°πof32
 (c⁄° *
__ª°ri˘
 
__≈å
,

141 **
__ª°ri˘
 
__íd±r
)

142 
__THROW
 
	`__n⁄nuŒ
 ((1));

145 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flﬂt64
 
	$°πof64
 (c⁄° *
__ª°ri˘
 
__≈å
,

147 **
__ª°ri˘
 
__íd±r
)

148 
__THROW
 
	`__n⁄nuŒ
 ((1));

151 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flﬂt128
 
	$°πof128
 (c⁄° *
__ª°ri˘
 
__≈å
,

153 **
__ª°ri˘
 
__íd±r
)

154 
__THROW
 
	`__n⁄nuŒ
 ((1));

157 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flﬂt32x
 
	$°πof32x
 (c⁄° *
__ª°ri˘
 
__≈å
,

159 **
__ª°ri˘
 
__íd±r
)

160 
__THROW
 
	`__n⁄nuŒ
 ((1));

163 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flﬂt64x
 
	$°πof64x
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

169 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flﬂt128x
 
	$°πof128x
 (c⁄° *
__ª°ri˘
 
__≈å
,

171 **
__ª°ri˘
 
__íd±r
)

172 
__THROW
 
	`__n⁄nuŒ
 ((1));

176 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

178 
__THROW
 
	`__n⁄nuŒ
 ((1));

180 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

181 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

182 
__THROW
 
	`__n⁄nuŒ
 ((1));

184 #ifde‡
__USE_MISC


186 
__exãnsi⁄__


187 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

191 
__exãnsi⁄__


192 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

193 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

194 
__THROW
 
	`__n⁄nuŒ
 ((1));

197 #ifde‡
__USE_ISOC99


199 
__exãnsi⁄__


200 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

204 
__exãnsi⁄__


205 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

206 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

207 
__THROW
 
	`__n⁄nuŒ
 ((1));

211 #i‡
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$°r‰omd
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

213 
__f
)

214 
__THROW
 
	`__n⁄nuŒ
 ((3));

216 
	$°r‰omf
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

217 
__f
)

218 
__THROW
 
	`__n⁄nuŒ
 ((3));

220 
	$°r‰oml
 (*
__de°
, 
size_t
 
__size
, c⁄° *
__f‹m©
,

221 
__f
)

222 
__THROW
 
	`__n⁄nuŒ
 ((3));

225 #i‡
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$°r‰omf16
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

227 
_Flﬂt16
 
__f
)

228 
__THROW
 
	`__n⁄nuŒ
 ((3));

231 #i‡
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$°r‰omf32
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

233 
_Flﬂt32
 
__f
)

234 
__THROW
 
	`__n⁄nuŒ
 ((3));

237 #i‡
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$°r‰omf64
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

239 
_Flﬂt64
 
__f
)

240 
__THROW
 
	`__n⁄nuŒ
 ((3));

243 #i‡
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$°r‰omf128
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

245 
_Flﬂt128
 
__f
)

246 
__THROW
 
	`__n⁄nuŒ
 ((3));

249 #i‡
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$°r‰omf32x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

251 
_Flﬂt32x
 
__f
)

252 
__THROW
 
	`__n⁄nuŒ
 ((3));

255 #i‡
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$°r‰omf64x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

257 
_Flﬂt64x
 
__f
)

258 
__THROW
 
	`__n⁄nuŒ
 ((3));

261 #i‡
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$°r‰omf128x
 (*
__de°
, 
size_t
 
__size
, c⁄° * 
__f‹m©
,

263 
_Flﬂt128x
 
__f
)

264 
__THROW
 
	`__n⁄nuŒ
 ((3));

268 #ifde‡
__USE_GNU


272 
	~<bôs/ty≥s/loˇÀ_t.h
>

274 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

275 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

276 
loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

278 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

279 **
__ª°ri˘
 
__íd±r
,

280 
__ba£
, 
loˇÀ_t
 
__loc
)

281 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

283 
__exãnsi⁄__


284 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

285 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

286 
loˇÀ_t
 
__loc
)

287 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

289 
__exãnsi⁄__


290 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

291 **
__ª°ri˘
 
__íd±r
,

292 
__ba£
, 
loˇÀ_t
 
__loc
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

295 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

296 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

299 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

300 **
__ª°ri˘
 
__íd±r
, 
loˇÀ_t
 
__loc
)

301 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

303 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

304 **
__ª°ri˘
 
__íd±r
,

305 
loˇÀ_t
 
__loc
)

306 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

308 #i‡
__HAVE_FLOAT16


309 
_Flﬂt16
 
	$°πof16_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

310 **
__ª°ri˘
 
__íd±r
,

311 
loˇÀ_t
 
__loc
)

312 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

315 #i‡
__HAVE_FLOAT32


316 
_Flﬂt32
 
	$°πof32_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

317 **
__ª°ri˘
 
__íd±r
,

318 
loˇÀ_t
 
__loc
)

319 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

322 #i‡
__HAVE_FLOAT64


323 
_Flﬂt64
 
	$°πof64_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

324 **
__ª°ri˘
 
__íd±r
,

325 
loˇÀ_t
 
__loc
)

326 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

329 #i‡
__HAVE_FLOAT128


330 
_Flﬂt128
 
	$°πof128_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 **
__ª°ri˘
 
__íd±r
,

332 
loˇÀ_t
 
__loc
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

336 #i‡
__HAVE_FLOAT32X


337 
_Flﬂt32x
 
	$°πof32x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

338 **
__ª°ri˘
 
__íd±r
,

339 
loˇÀ_t
 
__loc
)

340 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

343 #i‡
__HAVE_FLOAT64X


344 
_Flﬂt64x
 
	$°πof64x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

345 **
__ª°ri˘
 
__íd±r
,

346 
loˇÀ_t
 
__loc
)

347 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

350 #i‡
__HAVE_FLOAT128X


351 
_Flﬂt128x
 
	$°πof128x_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

352 **
__ª°ri˘
 
__íd±r
,

353 
loˇÀ_t
 
__loc
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

359 #ifde‡
__USE_EXTERN_INLINES


360 
__exã∫_ölöe
 

361 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

363  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

364 
	}
}

365 
__exã∫_ölöe
 

366 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

368  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

369 
	}
}

371 #ifde‡
__USE_ISOC99


372 
__exãnsi⁄__
 
__exã∫_ölöe
 

373 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

375  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

376 
	}
}

381 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

388 
	$a64l
 (c⁄° *
__s
)

389 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

393 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty≥s.h
>

401 
	$øndom
 (Ë
__THROW
;

404 
	$§™dom
 (
__£ed
Ë
__THROW
;

410 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

411 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

415 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

418 #ifde‡
__USE_MISC


423 
	søndom_d©a


425 
öt32_t
 *
Âå
;

426 
öt32_t
 *
Ωå
;

427 
öt32_t
 *
°©e
;

428 
ønd_ty≥
;

429 
ønd_deg
;

430 
ønd_£p
;

431 
öt32_t
 *
íd_±r
;

434 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

435 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

437 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

438 
__THROW
 
	`__n⁄nuŒ
 ((2));

440 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

441 
size_t
 
__°©ñí
,

442 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

443 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

445 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

446 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

447 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$ønd
 (Ë
__THROW
;

455 
	$§™d
 (
__£ed
Ë
__THROW
;

457 #ifde‡
__USE_POSIX199506


459 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

463 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


467 
	$dønd48
 (Ë
__THROW
;

468 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

471 
	$Ã™d48
 (Ë
__THROW
;

472 
	$ƒ™d48
 (
__xsubi
[3])

473 
__THROW
 
	`__n⁄nuŒ
 ((1));

476 
	$mønd48
 (Ë
__THROW
;

477 
	$jønd48
 (
__xsubi
[3])

478 
__THROW
 
	`__n⁄nuŒ
 ((1));

481 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__n⁄nuŒ
 ((1));

484 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

486 #ifde‡
__USE_MISC


490 
	sdønd48_d©a


492 
__x
[3];

493 
__ﬁd_x
[3];

494 
__c
;

495 
__öô
;

496 
__exãnsi⁄__
 
__a
;

501 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

502 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

503 
	$î™d48_r
 (
__xsubi
[3],

504 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

505 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

508 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

509 *
__ª°ri˘
 
__ªsu…
)

510 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

511 
	$ƒ™d48_r
 (
__xsubi
[3],

512 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

513 *
__ª°ri˘
 
__ªsu…
)

514 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

517 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

518 *
__ª°ri˘
 
__ªsu…
)

519 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

520 
	$jønd48_r
 (
__xsubi
[3],

521 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

522 *
__ª°ri˘
 
__ªsu…
)

523 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

526 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

527 
__THROW
 
	`__n⁄nuŒ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

532 
	$lc⁄g48_r
 (
__∑øm
[7],

533 
dønd48_d©a
 *
__buf„r
)

534 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

539 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

541 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

542 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

549 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

552 #ifde‡
__USE_GNU


558 *
	$ªÆloˇºay
 (*
__±r
, 
size_t
 
__nmemb
, size_à
__size
)

559 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

563 
	$‰ì
 (*
__±r
Ë
__THROW
;

565 #ifde‡
__USE_MISC


566 
	~<Æloˇ.h
>

569 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

570 || 
deföed
 
__USE_MISC


572 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

575 #ifde‡
__USE_XOPEN2K


577 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

578 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

581 #ifde‡
__USE_ISOC11


583 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

584 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

588 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

592 
	$©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

594 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


596 #ifde‡
__˝lu•lus


597 "C++" 
	$©_quick_exô
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

600 
	$©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

608 
__THROW
 
	`__n⁄nuŒ
 ((1));

614 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

616 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


620 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

623 #ifde‡
__USE_ISOC99


626 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

631 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_GNU


636 *
	$£cuª_gëív
 (c⁄° *
__«me
)

637 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

640 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


644 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

647 #ifde‡
__USE_XOPEN2K


650 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

651 
__THROW
 
	`__n⁄nuŒ
 ((2));

654 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$˛óªnv
 (Ë
__THROW
;

665 #i‡
deföed
 
__USE_MISC
 \

666 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

672 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

675 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


684 #i‚de‡
__USE_FILE_OFFSET64


685 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

687 #ifde‡
__REDIRECT


688 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

689 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

691 
	#mk°emp
 
mk°emp64


	)

694 #ifde‡
__USE_LARGEFILE64


695 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

699 #ifde‡
__USE_MISC


706 #i‚de‡
__USE_FILE_OFFSET64


707 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

711 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

713 
	#mk°emps
 
mk°emps64


	)

716 #ifde‡
__USE_LARGEFILE64


717 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

718 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

722 #ifde‡
__USE_XOPEN2K8


728 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

731 #ifde‡
__USE_GNU


738 #i‚de‡
__USE_FILE_OFFSET64


739 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

741 #ifde‡
__REDIRECT


742 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

743 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

745 
	#mko°emp
 
mko°emp64


	)

748 #ifde‡
__USE_LARGEFILE64


749 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

758 #i‚de‡
__USE_FILE_OFFSET64


759 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

760 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

762 #ifde‡
__REDIRECT


763 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

764 
__Êags
), 
mko°emps64
)

765 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

767 
	#mko°emps
 
mko°emps64


	)

770 #ifde‡
__USE_LARGEFILE64


771 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

772 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

781 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

791 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


797 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

798 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

803 #i‚de‡
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com∑r_‚_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

811 #ifde‡
__USE_GNU


812 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

817 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

818 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

819 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

821 #ifde‡
__USE_EXTERN_INLINES


822 
	~<bôs/°dlib-b£¨ch.h
>

827 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

828 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

829 #ifde‡
__USE_GNU


830 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

831 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

832 
	`__n⁄nuŒ
 ((1, 4));

837 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

838 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

840 #ifde‡
__USE_ISOC99


841 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

842 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

849 
div_t
 
	$div
 (
__numî
, 
__díom
)

850 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

852 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

854 #ifde‡
__USE_ISOC99


855 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

856 
__díom
)

857 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

861 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

862 || 
deföed
 
__USE_MISC


869 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

870 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

875 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

876 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

881 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

882 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

885 #ifde‡
__USE_MISC


887 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

888 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

889 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

890 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

891 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

892 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

893 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

894 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

899 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

900 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

901 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

903 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

904 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

907 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

908 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

909 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

911 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

912 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

913 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

919 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

922 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

923 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

926 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

930 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

931 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

933 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

934 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifde‡
__USE_MISC


943 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

947 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


954 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

955 *c⁄° *
__ª°ri˘
 
__tokís
,

956 **
__ª°ri˘
 
__vÆuï
)

957 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

961 #ifde‡
__USE_XOPEN


963 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

969 #ifde‡
__USE_XOPEN2KXSI


971 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

974 #ifde‡
__USE_XOPEN_EXTENDED


979 
	$gø¡±
 (
__fd
Ë
__THROW
;

983 
	$u∆ock±
 (
__fd
Ë
__THROW
;

988 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

991 #ifde‡
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

996 
__THROW
 
	`__n⁄nuŒ
 ((2));

999 
	`gë±
 ();

1002 #ifde‡
__USE_MISC


1006 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1));

1010 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K


1013 
	$ây¶Ÿ
 (Ë
__THROW
;

1016 
	~<bôs/°dlib-Êﬂt.h
>

1019 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1020 
	~<bôs/°dlib.h
>

1022 #ifde‡
__LDBL_COMPAT


1023 
	~<bôs/°dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<bôs/libc-hódî-°¨t.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


53 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

63 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

67 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

72 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

75 #ifde‡
__OPTIMIZE__


76 
__exã∫_Æways_ölöe
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


79  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

82 
__exã∫_Æways_ölöe
 const *

83 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

94 #ifde‡
__USE_GNU


97 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

100 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

108 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

122 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

124 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

125 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

129 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

133 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

137 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

139 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

146 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

147 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

148 
__THROW
 
	`__n⁄nuŒ
 ((2));

150 #ifde‡
__USE_XOPEN2K8


152 
	~<bôs/ty≥s/loˇÀ_t.h
>

155 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__l
)

156 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

159 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

160 
loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

163 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$°rdup
 (c⁄° *
__s
)

167 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

173 #i‡
deföed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

175 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

178 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


180 
	#°rdu∑
(
s
) \

181 (
__exãnsi⁄__
 \

183 c⁄° *
__ﬁd
 = (
s
); \

184 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

185 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

186 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

187 
	}
}))

	)

190 
	#°∫du∑
(
s
, 
n
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

196 
__√w
[
__Àn
] = '\0'; \

197 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

198 }))

	)

202 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
°rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

207 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

210 #ifde‡
__OPTIMIZE__


211 
__exã∫_Æways_ölöe
 *

212 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


214  
__buûtö_°rchr
 (
__s
, 
__c
);

217 
__exã∫_Æways_ölöe
 const *

218 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


220  
__buûtö_°rchr
 (
__s
, 
__c
);

225 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

226 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

229 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`°ºchr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

234 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

237 #ifde‡
__OPTIMIZE__


238 
__exã∫_Æways_ölöe
 *

239 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


241  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

244 
__exã∫_Æways_ölöe
 const *

245 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


247  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

253 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

256 #ifde‡
__USE_GNU


259 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

265 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

266 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

272 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

273 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

276 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

277 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

279 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

283 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

284 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

285 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

287 #ifde‡
__OPTIMIZE__


288 
__exã∫_Æways_ölöe
 *

289 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


291  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

294 
__exã∫_Æways_ölöe
 const *

295 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


297  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

300 
	}
}

302 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

303 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

306 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

310 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

311 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

312 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

314 #ifde‡
__OPTIMIZE__


315 
__exã∫_Æways_ölöe
 *

316 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


318  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

321 
__exã∫_Æways_ölöe
 const *

322 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


324  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

327 
	}
}

329 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

330 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

335 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

336 
__THROW
 
	`__n⁄nuŒ
 ((2));

340 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

341 c⁄° *
__ª°ri˘
 
__dñim
,

342 **
__ª°ri˘
 
__ßve_±r
)

343 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

344 #ifde‡
__USE_POSIX


345 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

346 **
__ª°ri˘
 
__ßve_±r
)

347 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

350 #ifde‡
__USE_GNU


352 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

354 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

355 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

356 c⁄° *
__√edÀ
)

357 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

359 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

360 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

364 #ifde‡
__USE_GNU


368 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

369 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

374 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

375 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

377 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

378 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

379 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

384 
size_t
 
	$°æí
 (c⁄° *
__s
)

385 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

391 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

396 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

397 #ifde‡
__USE_XOPEN2K


405 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


408 #ifde‡
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

410 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

411 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

413 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

414 
__THROW
 
	`__n⁄nuŒ
 ((2));

415 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

420 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

421 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

425 #ifde‡
__USE_XOPEN2K8


427 *
	$°ªº‹_l
 (
__î∫um
, 
loˇÀ_t
 
__l
Ë
__THROW
;

430 #ifde‡
__USE_MISC


431 
	~<°rögs.h
>

435 
	$ex∂icô_bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

439 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

440 c⁄° *
__ª°ri˘
 
__dñim
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

449 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

450 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

451 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

456 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

457 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

458 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

460 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

461 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

467 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

470 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

473 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

475 #i‚de‡
ba£«me


480 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£«me
 (*
__fûíame
)

482 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

483 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

484 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

486 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

491 #i‡
	`__GNUC_PREREQ
 (3,4)

492 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


494 
	~<bôs/°rög_f‹tifõd.h
>

498 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifde‡
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #ñi‡
deföed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #ñi‡
deföed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<bôs/posix_›t.h
>

208 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


209 
	~<bôs/ívú⁄míts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<bôs/ty≥s.h
>

222 #i‚def 
__ssize_t_deföed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_deföed


	)

227 
	#__√ed_size_t


	)

228 
	#__√ed_NULL


	)

229 
	~<°ddef.h
>

231 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


234 #i‚de‡
__gid_t_deföed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_deföed


	)

239 #i‚de‡
__uid_t_deföed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_deföed


	)

244 #i‚de‡
__off_t_deföed


245 #i‚de‡
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_deföed


	)

252 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_deföed


	)

257 #i‚de‡
__u£c⁄ds_t_deföed


258 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

259 
	#__u£c⁄ds_t_deföed


	)

262 #i‚de‡
__pid_t_deföed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_deföed


	)

268 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


269 #i‚de‡
__öçå_t_deföed


270 
__öçå_t
 
	töçå_t
;

271 
	#__öçå_t_deföed


	)

275 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


276 #i‚de‡
__sockÀn_t_deföed


277 
__sockÀn_t
 
	tsockÀn_t
;

278 
	#__sockÀn_t_deföed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

292 #ifde‡
__USE_GNU


295 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

296 
__THROW
 
	`__n⁄nuŒ
 ((1));

299 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

300 
__THROW
 
	`__n⁄nuŒ
 ((1));

303 #ifde‡
__USE_ATFILE


307 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

308 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

313 #i‚def 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifde‡
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #i‡
deföed
 
__USE_MISC
 && !deföed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #i‚de‡
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

339 #ifde‡
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifde‡
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

349 
__THROW
;

356 
	`˛o£
 (
__fd
);

363 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

369 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

371 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


372 #i‚de‡
__USE_FILE_OFFSET64


379 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

380 
__off_t
 
__off£t
Ë
__wur
;

387 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
Ë
__wur
;

390 #ifde‡
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

392 
__off64_t
 
__off£t
),

393 
¥ód64
Ë
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

395 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

396 
pwrôe64
Ë
__wur
;

398 
	#¥ód
 
¥ód64


	)

399 
	#pwrôe
 
pwrôe64


	)

403 #ifde‡
__USE_LARGEFILE64


407 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

408 
__off64_t
 
__off£t
Ë
__wur
;

411 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
Ë
__wur
;

420 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

422 #ifde‡
__USE_GNU


425 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

435 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

447 
	`¶ìp
 (
__£c⁄ds
);

449 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

450 || 
deföed
 
__USE_MISC


455 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

456 
__THROW
;

463 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

472 
	`∑u£
 ();

476 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

479 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

486 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

491 #ifde‡
__USE_ATFILE


494 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

495 
__gid_t
 
__group
, 
__Êag
)

496 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

500 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

502 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


504 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

514 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

523 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

524 || 
deföed
 
__USE_MISC


528 *
	$gëwd
 (*
__buf
)

529 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

534 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

539 #ifde‡
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

546 **
__ívú⁄
;

547 #ifde‡
__USE_GNU


548 **
ívú⁄
;

554 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

555 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

557 #ifde‡
__USE_XOPEN2K8


560 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

561 
__THROW
 
	`__n⁄nuŒ
 ((2));

566 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

567 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

571 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

572 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

576 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

581 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

582 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

588 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

590 #ifde‡
__USE_GNU


593 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

594 *c⁄° 
__ívp
[])

595 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

599 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


601 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

606 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

612 
	~<bôs/c⁄‚ame.h
>

615 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

616 
__THROW
 
	`__n⁄nuŒ
 ((1));

619 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

622 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

631 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

637 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

640 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

641 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


642 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

649 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

651 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


663 
	$£çgΩ
 (Ë
__THROW
;

670 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

672 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


674 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

678 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

681 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

687 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

692 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

705 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


708 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

711 #ifde‡
__USE_XOPEN2K


713 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

722 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


725 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

728 #ifde‡
__USE_XOPEN2K


730 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

733 #ifde‡
__USE_GNU


736 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

737 
__THROW
;

741 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

742 
__THROW
;

746 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

747 
__THROW
 
__wur
;

751 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

761 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

762 || 
deföed
 
__USE_MISC


767 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

773 *
	$ây«me
 (
__fd
Ë
__THROW
;

777 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

778 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

782 
	$ißây
 (
__fd
Ë
__THROW
;

784 #ifde‡
__USE_MISC


787 
	$ây¶Ÿ
 (Ë
__THROW
;

792 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

793 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

795 #ifde‡
__USE_ATFILE


798 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

799 c⁄° *
__to
, 
__Êags
)

800 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

803 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


805 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

806 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

811 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

812 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

813 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

816 #ifde‡
__USE_ATFILE


818 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

819 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

822 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

823 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

824 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

828 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

830 #ifde‡
__USE_ATFILE


832 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

833 
__THROW
 
	`__n⁄nuŒ
 ((2));

837 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

841 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

844 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

851 *
	`gëlogö
 ();

852 #ifde‡
__USE_POSIX199506


859 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<bôs/gë›t_posix.h
>

876 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


880 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

884 #i‡
deföed
 
__USE_MISC


887 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

888 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

898 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

899 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

900 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

901 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

907 
	$vh™gup
 (Ë
__THROW
;

910 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

918 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sˇÀ
)

920 
__THROW
 
	`__n⁄nuŒ
 ((1));

926 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

930 *
	$gëu£rshñl
 (Ë
__THROW
;

931 
	$ídu£rshñl
 (Ë
__THROW
;

932 
	$£tu£rshñl
 (Ë
__THROW
;

938 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

942 #i‡
deföed
 
__USE_MISC
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

945 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

949 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifde‡
__USE_GNU


963 
	$syncfs
 (
__fd
Ë
__THROW
;

967 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


970 
	`gëho°id
 ();

973 
	$sync
 (Ë
__THROW
;

976 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K


979 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

984 
	$gëdèbÀsize
 (Ë
__THROW
;

990 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


993 #i‚de‡
__USE_FILE_OFFSET64


994 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

995 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

997 #ifde‡
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
åunˇã
,

999 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

1000 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1002 
	#åunˇã
 
åunˇã64


	)

1005 #ifde‡
__USE_LARGEFILE64


1006 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1012 #i‡
deföed
 
__USE_POSIX199309
 \

1013 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1016 #i‚de‡
__USE_FILE_OFFSET64


1017 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1019 #ifde‡
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1021 
·runˇã64
Ë
__wur
;

1023 
	#·runˇã
 
·runˇã64


	)

1026 #ifde‡
__USE_LARGEFILE64


1027 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1033 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1034 || 
deföed
 
__USE_MISC


1038 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1044 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1048 #ifde‡
__USE_MISC


1059 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1064 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #i‚de‡
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1084 #ifde‡
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1086 
lockf64
Ë
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifde‡
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1097 #ifde‡
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1103 (
__exãnsi⁄__
 \

1104 ({ 
__ªsu…
; \

1105 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1106 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1107 
__ªsu…
; 
	}
}))

	)

1110 
ssize_t
 
c›y_fûe_ønge
 (
__öfd
, 
__off64_t
 *
__pöoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Àngth
, 
__Êags
);

1115 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1118 
fd©async
 (
__fûdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1127 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1131 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

1132 
__THROW
 
	`__n⁄nuŒ
 ((1));

1139 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1140 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1147 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1149 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_XOPEN2K


1159 
	$±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1160 (*
__∑ª¡
) (),

1161 (*
__chûd
Ë()Ë
__THROW
;

1164 #ifde‡
__USE_MISC


1167 
	$gëíå›y
 (*
__buf„r
, 
size_t
 
__Àngth
Ë
__wur
;

1171 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1172 
	~<bôs/uni°d.h
>

1175 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #unde‡
__USE_ISOC11


120 #unde‡
__USE_ISOC99


121 #unde‡
__USE_ISOC95


122 #unde‡
__USE_ISOCXX11


123 #unde‡
__USE_POSIX


124 #unde‡
__USE_POSIX2


125 #unde‡
__USE_POSIX199309


126 #unde‡
__USE_POSIX199506


127 #unde‡
__USE_XOPEN


128 #unde‡
__USE_XOPEN_EXTENDED


129 #unde‡
__USE_UNIX98


130 #unde‡
__USE_XOPEN2K


131 #unde‡
__USE_XOPEN2KXSI


132 #unde‡
__USE_XOPEN2K8


133 #unde‡
__USE_XOPEN2K8XSI


134 #unde‡
__USE_LARGEFILE


135 #unde‡
__USE_LARGEFILE64


136 #unde‡
__USE_FILE_OFFSET64


137 #unde‡
__USE_MISC


138 #unde‡
__USE_ATFILE


139 #unde‡
__USE_GNU


140 #unde‡
__USE_FORTIFY_LEVEL


141 #unde‡
__KERNEL_STRICT_NAMES


142 #unde‡
__GLIBC_USE_DEPRECATED_GETS


146 #i‚de‡
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

159 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

168 #i‡
deföed
 
__˛™g_maj‹__
 && deföed 
__˛™g_mö‹__


169 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
) \

170 ((
__˛™g_maj‹__
 << 16Ë+ 
__˛™g_mö‹__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

172 
	#__glibc_˛™g_¥îeq
(
maj
, 
mö
Ë0

	)

176 
	#__GLIBC_USE
(
F
Ë
__GLIBC_USE_
 ## 
	)
F

182 #i‡(
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE
) \

183 && !
deföed
 
	g_DEFAULT_SOURCE


185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifde‡
_GNU_SOURCE


191 #unde‡
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #unde‡
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #unde‡
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #unde‡
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #unde‡
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #unde‡
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #unde‡
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #unde‡
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #unde‡
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #unde‡
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

216 || (!
deföed
 
	g__STRICT_ANSI__
 \

217 && !
deföed
 
	g_ISOC99_SOURCE
 \

218 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

219 && !
deföed
 
	g_XOPEN_SOURCE
))

220 #unde‡
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #i‡(
deföed
 
_ISOC11_SOURCE
 \

226 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

232 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

238 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifde‡
__˝lu•lus


244 #i‡
__˝lu•lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #i‡
__˝lu•lus
 >201103L || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifde‡
_DEFAULT_SOURCE


259 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #unde‡
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #unde‡
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #i‡((!
deföed
 
__STRICT_ANSI__
 \

269 || (
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #i‡((!
deföed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #unde‡
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #i‡(
deföed
 
_POSIX_SOURCE
 \

298 || (
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
deföed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #unde‡
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #unde‡
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #i‡
deföed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #unde‡
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #unde‡
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

337 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #unde‡
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #unde‡
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifde‡
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifde‡
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifde‡
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #i‡
deföed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #i‡
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #i‡
deföed
 
__˝lu•lus
 ? __˝lu•lu†>201402L : deföed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<°dc-¥edef.h
>

410 #unde‡
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

419 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

422 #i‚de‡
__ASSEMBLER__


423 #i‚de‡
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

438 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

439 && 
deföed
 
	g__exã∫_ölöe


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/°ubs.h
>

	@/usr/include/strings.h

18 #i‚def 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<„©uªs.h
>

22 
	#__√ed_size_t


	)

23 
	~<°ddef.h
>

26 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


34 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

38 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

42 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

45 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`ödex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

50 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

53 #i‡
deföed
 
__OPTIMIZE__


54 
__exã∫_Æways_ölöe
 *

55 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


57  
	`__buûtö_ödex
 (
__s
, 
__c
);

60 
__exã∫_Æways_ölöe
 const *

61 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


63  
	`__buûtö_ödex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$ödex
 (c⁄° *
__s
, 
__c
)

69 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

73 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`rödex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #i‡
deföed
 
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


85  
	`__buûtö_rödex
 (
__s
, 
__c
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


91  
	`__buûtö_rödex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$rödex
 (c⁄° *
__s
, 
__c
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

101 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
Ë
__THROW
 
__©åibuã_c⁄°__
;

109 #ifdef 
__USE_MISC


110 
	$ff¶
 (
__l
Ë
__THROW
 
__©åibuã_c⁄°__
;

111 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

112 
__THROW
 
__©åibuã_c⁄°__
;

116 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

117 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

120 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<bôs/ty≥s/loˇÀ_t.h
>

128 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
loˇÀ_t
 
__loc
)

129 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

133 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

134 
size_t
 
__n
, 
loˇÀ_t
 
__loc
)

135 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

138 
__END_DECLS


140 #i‡
	`__GNUC_PREREQ
 (3,4Ë&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
deföed
 
__f‹tify_fun˘i⁄


143 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


144 
	~<bôs/°rögs_f‹tifõd.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
85
805
asm.h
bio.c
bootasm.S
bootmain.c
buf.h
cat.c
console.c
date.h
defs.h
echo.c
elf.h
entry.S
entryother.S
exec.c
fcntl.h
file.c
file.h
forktest.c
fs.c
fs.h
grep.c
ide.c
init.c
initcode.S
ioapic.c
kalloc.c
kbd.c
kbd.h
kill.c
lapic.c
ln.c
log.c
ls.c
main.c
memide.c
memlayout.h
mkdir.c
mkfs.c
mmu.h
mp.c
mp.h
param.h
picirq.c
pipe.c
printf.c
proc.c
proc.h
rm.c
sh.c
sleeplock.c
sleeplock.h
spinlock.c
spinlock.h
stat.h
stressfs.c
string.c
swtch.S
syscall.c
syscall.h
sysfile.c
sysproc.c
trap.c
trapasm.S
traps.h
types.h
uart.c
ulib.c
umalloc.c
user.h
usertests.c
usys.S
vectors.S
vm.c
wc.c
x86.h
zombie.c
/usr/include/assert.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/features.h
/usr/include/strings.h
/usr/include/stdc-predef.h
